var background=(function(){"use strict";var np=Object.defineProperty;var ip=(Zn,bn,Cr)=>bn in Zn?np(Zn,bn,{enumerable:!0,configurable:!0,writable:!0,value:Cr}):Zn[bn]=Cr;var Oi=(Zn,bn,Cr)=>ip(Zn,typeof bn!="symbol"?bn+"":bn,Cr);function Zn(f){return f==null||typeof f=="function"?{main:f}:f}class bn{constructor(){Oi(this,"connections",new Map)}register(u,w,m){this.connections.set(u,{tabId:u,platform:w,url:m,status:"connected",lastSeen:new Date().toISOString()})}unregister(u){this.connections.delete(u)}getByPlatform(u){for(const w of this.connections.values())if(w.platform===u&&w.status!=="disconnected")return w}getByTabId(u){return this.connections.get(u)}updateStatus(u,w){const m=this.connections.get(u);m&&(m.status=w,m.lastSeen=new Date().toISOString())}listConnected(){return Array.from(this.connections.values()).filter(u=>u.status!=="disconnected")}getPlatformForTab(u){var w;return(w=this.connections.get(u))==null?void 0:w.platform}}const Cr=new bn;var Pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ca(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}function kf(f){if(Object.prototype.hasOwnProperty.call(f,"__esModule"))return f;var u=f.default;if(typeof u=="function"){var w=function m(){return this instanceof m?Reflect.construct(u,arguments,this.constructor):u.apply(this,arguments)};w.prototype=u.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(f).forEach(function(m){var k=Object.getOwnPropertyDescriptor(f,m);Object.defineProperty(w,m,k.get?k:{enumerable:!0,get:function(){return f[m]}})}),w}var aa={exports:{}},Sf=aa.exports,zs;function Rf(){return zs||(zs=1,(function(f,u){((w,m)=>{f.exports=m()})(Sf,function(){var w=function(r,o){return(w=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(l,g){l.__proto__=g}:function(l,g){for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&(l[x]=g[x])}))(r,o)},m=function(){return(m=Object.assign||function(r){for(var o,l=1,g=arguments.length;l<g;l++)for(var x in o=arguments[l])Object.prototype.hasOwnProperty.call(o,x)&&(r[x]=o[x]);return r}).apply(this,arguments)};function k(r,o,l){for(var g,x=0,R=o.length;x<R;x++)!g&&x in o||((g=g||Array.prototype.slice.call(o,0,x))[x]=o[x]);return r.concat(g||Array.prototype.slice.call(o))}var _=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Pi,A=Object.keys,d=Array.isArray;function y(r,o){return typeof o=="object"&&A(o).forEach(function(l){r[l]=o[l]}),r}typeof Promise>"u"||_.Promise||(_.Promise=Promise);var F=Object.getPrototypeOf,D={}.hasOwnProperty;function B(r,o){return D.call(r,o)}function z(r,o){typeof o=="function"&&(o=o(F(r))),(typeof Reflect>"u"?A:Reflect.ownKeys)(o).forEach(function(l){V(r,l,o[l])})}var j=Object.defineProperty;function V(r,o,l,g){j(r,o,y(l&&B(l,"get")&&typeof l.get=="function"?{get:l.get,set:l.set,configurable:!0}:{value:l,configurable:!0,writable:!0},g))}function we(r){return{from:function(o){return r.prototype=Object.create(o.prototype),V(r.prototype,"constructor",r),{extend:z.bind(null,r.prototype)}}}}var ie=Object.getOwnPropertyDescriptor,K=[].slice;function te(r,o,l){return K.call(r,o,l)}function Q(r,o){return o(r)}function ge(r){if(!r)throw new Error("Assertion Failed")}function Te(r){_.setImmediate?setImmediate(r):setTimeout(r,0)}function le(r,o){if(typeof o=="string"&&B(r,o))return r[o];if(!o)return r;if(typeof o!="string"){for(var l=[],g=0,x=o.length;g<x;++g){var R=le(r,o[g]);l.push(R)}return l}var $,q=o.indexOf(".");return q===-1||($=r[o.substr(0,q)])==null?void 0:le($,o.substr(q+1))}function H(r,o,l){if(r&&o!==void 0&&!("isFrozen"in Object&&Object.isFrozen(r)))if(typeof o!="string"&&"length"in o){ge(typeof l!="string"&&"length"in l);for(var g=0,x=o.length;g<x;++g)H(r,o[g],l[g])}else{var R,$,q=o.indexOf(".");q!==-1?(R=o.substr(0,q),(q=o.substr(q+1))===""?l===void 0?d(r)&&!isNaN(parseInt(R))?r.splice(R,1):delete r[R]:r[R]=l:H($=($=r[R])&&B(r,R)?$:r[R]={},q,l)):l===void 0?d(r)&&!isNaN(parseInt(o))?r.splice(o,1):delete r[o]:r[o]=l}}function fe(r){var o,l={};for(o in r)B(r,o)&&(l[o]=r[o]);return l}var Ae=[].concat;function pe(r){return Ae.apply([],r)}var gt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(pe([8,16,32,64].map(function(r){return["Int","Uint","Float"].map(function(o){return o+r+"Array"})}))).filter(function(r){return _[r]}),Be=new Set(gt.map(function(r){return _[r]})),Ce=null;function Se(r){return Ce=new WeakMap,r=(function o(l){if(!l||typeof l!="object")return l;var g=Ce.get(l);if(g)return g;if(d(l)){g=[],Ce.set(l,g);for(var x=0,R=l.length;x<R;++x)g.push(o(l[x]))}else if(Be.has(l.constructor))g=l;else{var $,q=F(l);for($ in g=q===Object.prototype?{}:Object.create(q),Ce.set(l,g),l)B(l,$)&&(g[$]=o(l[$]))}return g})(r),Ce=null,r}var Le={}.toString;function ft(r){return Le.call(r).slice(8,-1)}var Ne=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Re=typeof Ne=="symbol"?function(r){var o;return r!=null&&(o=r[Ne])&&o.apply(r)}:function(){return null};function Fe(r,o){o=r.indexOf(o),0<=o&&r.splice(o,1)}var Ue={};function mt(r){var o,l,g,x;if(arguments.length===1){if(d(r))return r.slice();if(this===Ue&&typeof r=="string")return[r];if(x=Re(r))for(l=[];!(g=x.next()).done;)l.push(g.value);else{if(r==null)return[r];if(typeof(o=r.length)!="number")return[r];for(l=new Array(o);o--;)l[o]=r[o]}}else for(o=arguments.length,l=new Array(o);o--;)l[o]=arguments[o];return l}var pt=typeof Symbol<"u"?function(r){return r[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},gt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],tr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(gt),Pt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Lt(r,o){this.name=r,this.message=o}function Mt(r,o){return r+". Errors: "+Object.keys(o).map(function(l){return o[l].toString()}).filter(function(l,g,x){return x.indexOf(l)===g}).join(`
`)}function Et(r,o,l,g){this.failures=o,this.failedKeys=g,this.successCount=l,this.message=Mt(r,o)}function ct(r,o){this.name="BulkError",this.failures=Object.keys(o).map(function(l){return o[l]}),this.failuresByPos=o,this.message=Mt(r,this.failures)}we(Lt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),we(Et).from(Lt),we(ct).from(Lt);var ht=tr.reduce(function(r,o){return r[o]=o+"Error",r},{}),kt=Lt,qe=tr.reduce(function(r,o){var l=o+"Error";function g(x,R){this.name=l,x?typeof x=="string"?(this.message="".concat(x).concat(R?`
 `+R:""),this.inner=R||null):typeof x=="object"&&(this.message="".concat(x.name," ").concat(x.message),this.inner=x):(this.message=Pt[o]||l,this.inner=null)}return we(g).from(kt),r[o]=g,r},{}),It=(qe.Syntax=SyntaxError,qe.Type=TypeError,qe.Range=RangeError,gt.reduce(function(r,o){return r[o+"Error"]=qe[o],r},{}));gt=tr.reduce(function(r,o){return["Syntax","Type","Range"].indexOf(o)===-1&&(r[o+"Error"]=qe[o]),r},{});function We(){}function vt(r){return r}function Ht(r,o){return r==null||r===vt?o:function(l){return o(r(l))}}function qt(r,o){return function(){r.apply(this,arguments),o.apply(this,arguments)}}function Bt(r,o){return r===We?o:function(){var l=r.apply(this,arguments),g=(l!==void 0&&(arguments[0]=l),this.onsuccess),x=this.onerror,R=(this.onsuccess=null,this.onerror=null,o.apply(this,arguments));return g&&(this.onsuccess=this.onsuccess?qt(g,this.onsuccess):g),x&&(this.onerror=this.onerror?qt(x,this.onerror):x),R!==void 0?R:l}}function _e(r,o){return r===We?o:function(){r.apply(this,arguments);var l=this.onsuccess,g=this.onerror;this.onsuccess=this.onerror=null,o.apply(this,arguments),l&&(this.onsuccess=this.onsuccess?qt(l,this.onsuccess):l),g&&(this.onerror=this.onerror?qt(g,this.onerror):g)}}function bt(r,o){return r===We?o:function(x){var g=r.apply(this,arguments),x=(y(x,g),this.onsuccess),R=this.onerror,$=(this.onsuccess=null,this.onerror=null,o.apply(this,arguments));return x&&(this.onsuccess=this.onsuccess?qt(x,this.onsuccess):x),R&&(this.onerror=this.onerror?qt(R,this.onerror):R),g===void 0?$===void 0?void 0:$:y(g,$)}}function Wt(r,o){return r===We?o:function(){return o.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function lr(r,o){return r===We?o:function(){var l=r.apply(this,arguments);if(l&&typeof l.then=="function"){for(var g=this,x=arguments.length,R=new Array(x);x--;)R[x]=arguments[x];return l.then(function(){return o.apply(g,R)})}return o.apply(this,arguments)}}gt.ModifyError=Et,gt.DexieError=Lt,gt.BulkError=ct;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ft(r){Ot=r}var or={},pr=100,Gt=typeof Promise>"u"?[]:(tr=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Gt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),F(Gt),tr]:[tr,F(tr),tr]),tr=Gt[0],Fr=Gt[1],Fr=Fr&&Fr.then,O=tr&&tr.constructor,h=!!Gt[2],v=function(r,o){S.push([r,o]),b&&(queueMicrotask(Qe),b=!1)},U=!0,b=!0,L=[],J=[],De=vt,Z={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:We,pgp:!1,env:{},finalize:We},W=Z,S=[],ke=0,dt=[];function c(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var o=this._PSD=W;if(typeof r!="function"){if(r!==or)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&P(this,this._value)}else this._state=null,this._value=null,++o.ref,(function l(g,x){try{x(function(R){if(g._state===null){if(R===g)throw new TypeError("A promise cannot be resolved with itself.");var $=g._lib&&Ge();R&&typeof R.then=="function"?l(g,function(q,ae){R instanceof c?R._then(q,ae):R.then(q,ae)}):(g._state=!0,g._value=R,X(g)),$&&yt()}},P.bind(null,g))}catch(R){P(g,R)}})(this,r)}var G={get:function(){var r=W,o=Ur;function l(g,x){var R=this,$=!r.global&&(r!==W||o!==Ur),q=$&&!dr(),ae=new c(function(de,re){be(R,new Ee(mi(g,r,$,q),mi(x,r,$,q),de,re,r))});return this._consoleTask&&(ae._consoleTask=this._consoleTask),ae}return l.prototype=or,l},set:function(r){V(this,"then",r&&r.prototype===or?G:{get:function(){return r},set:G.set})}};function Ee(r,o,l,g,x){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof o=="function"?o:null,this.resolve=l,this.reject=g,this.psd=x}function P(r,o){var l,g;J.push(o),r._state===null&&(l=r._lib&&Ge(),o=De(o),r._state=!1,r._value=o,g=r,L.some(function(x){return x._value===g._value})||L.push(g),X(r),l)&&yt()}function X(r){var o=r._listeners;r._listeners=[];for(var l=0,g=o.length;l<g;++l)be(r,o[l]);var x=r._PSD;--x.ref||x.finalize(),ke===0&&(++ke,v(function(){--ke==0&&Sr()},[]))}function be(r,o){if(r._state===null)r._listeners.push(o);else{var l=r._state?o.onFulfilled:o.onRejected;if(l===null)return(r._state?o.resolve:o.reject)(r._value);++o.psd.ref,++ke,v(ut,[l,r,o])}}function ut(r,o,l){try{var g,x=o._value;!o._state&&J.length&&(J=[]),g=Ot&&o._consoleTask?o._consoleTask.run(function(){return r(x)}):r(x),o._state||J.indexOf(x)!==-1||(R=>{for(var $=L.length;$;)if(L[--$]._value===R._value)return L.splice($,1)})(o),l.resolve(g)}catch(R){l.reject(R)}finally{--ke==0&&Sr(),--l.psd.ref||l.psd.finalize()}}function Qe(){xn(Z,function(){Ge()&&yt()})}function Ge(){var r=U;return b=U=!1,r}function yt(){var r,o,l;do for(;0<S.length;)for(r=S,S=[],l=r.length,o=0;o<l;++o){var g=r[o];g[0].apply(null,g[1])}while(0<S.length);b=U=!0}function Sr(){for(var r=L,o=(L=[],r.forEach(function(g){g._PSD.onunhandled.call(null,g._value,g)}),dt.slice(0)),l=o.length;l;)o[--l]()}function zt(r){return new c(or,!1,r)}function lt(r,o){var l=W;return function(){var g=Ge(),x=W;try{return Tr(l,!0),r.apply(this,arguments)}catch(R){o&&o(R)}finally{Tr(x,!1),g&&yt()}}}z(c.prototype,{then:G,_then:function(r,o){be(this,new Ee(null,null,r,o,W))},catch:function(r){var o,l;return arguments.length===1?this.then(null,r):(o=r,l=arguments[1],typeof o=="function"?this.then(null,function(g){return(g instanceof o?l:zt)(g)}):this.then(null,function(g){return(g&&g.name===o?l:zt)(g)}))},finally:function(r){return this.then(function(o){return c.resolve(r()).then(function(){return o})},function(o){return c.resolve(r()).then(function(){return zt(o)})})},timeout:function(r,o){var l=this;return r<1/0?new c(function(g,x){var R=setTimeout(function(){return x(new qe.Timeout(o))},r);l.then(g,x).finally(clearTimeout.bind(null,R))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&V(c.prototype,Symbol.toStringTag,"Dexie.Promise"),Z.env=Jn(),z(c,{all:function(){var r=mt.apply(null,arguments).map(xr);return new c(function(o,l){r.length===0&&o([]);var g=r.length;r.forEach(function(x,R){return c.resolve(x).then(function($){r[R]=$,--g||o(r)},l)})})},resolve:function(r){return r instanceof c?r:r&&typeof r.then=="function"?new c(function(o,l){r.then(o,l)}):new c(or,!0,r)},reject:zt,race:function(){var r=mt.apply(null,arguments).map(xr);return new c(function(o,l){r.map(function(g){return c.resolve(g).then(o,l)})})},PSD:{get:function(){return W},set:function(r){return W=r}},totalEchoes:{get:function(){return Ur}},newPSD:sr,usePSD:xn,scheduler:{get:function(){return v},set:function(r){v=r}},rejectionMapper:{get:function(){return De},set:function(r){De=r}},follow:function(r,o){return new c(function(l,g){return sr(function(x,R){var $=W;$.unhandleds=[],$.onunhandled=R,$.finalize=qt(function(){var q,ae=this;q=function(){ae.unhandleds.length===0?x():R(ae.unhandleds[0])},dt.push(function de(){q(),dt.splice(dt.indexOf(de),1)}),++ke,v(function(){--ke==0&&Sr()},[])},$.finalize),r()},o,l,g)})}}),O&&(O.allSettled&&V(c,"allSettled",function(){var r=mt.apply(null,arguments).map(xr);return new c(function(o){r.length===0&&o([]);var l=r.length,g=new Array(l);r.forEach(function(x,R){return c.resolve(x).then(function($){return g[R]={status:"fulfilled",value:$}},function($){return g[R]={status:"rejected",reason:$}}).then(function(){return--l||o(g)})})})}),O.any&&typeof AggregateError<"u"&&V(c,"any",function(){var r=mt.apply(null,arguments).map(xr);return new c(function(o,l){r.length===0&&l(new AggregateError([]));var g=r.length,x=new Array(g);r.forEach(function(R,$){return c.resolve(R).then(function(q){return o(q)},function(q){x[$]=q,--g||l(new AggregateError(x))})})})}),O.withResolvers)&&(c.withResolvers=O.withResolvers);var Rt={awaits:0,echoes:0,id:0},fr=0,hr=[],qr=0,Ur=0,rr=0;function sr(r,$,l,g){var x=W,R=Object.create(x),$=(R.parent=x,R.ref=0,R.global=!1,R.id=++rr,Z.env,R.env=h?{Promise:c,PromiseProp:{value:c,configurable:!0,writable:!0},all:c.all,race:c.race,allSettled:c.allSettled,any:c.any,resolve:c.resolve,reject:c.reject}:{},$&&y(R,$),++x.ref,R.finalize=function(){--this.parent.ref||this.parent.finalize()},xn(R,r,l,g));return R.ref===0&&R.finalize(),$}function Xt(){return Rt.id||(Rt.id=++fr),++Rt.awaits,Rt.echoes+=pr,Rt.id}function dr(){return!!Rt.awaits&&(--Rt.awaits==0&&(Rt.id=0),Rt.echoes=Rt.awaits*pr,!0)}function xr(r){return Rt.echoes&&r&&r.constructor===O?(Xt(),r.then(function(o){return dr(),o},function(o){return dr(),_t(o)})):r}function pi(){var r=hr[hr.length-1];hr.pop(),Tr(r,!1)}function Tr(r,o){var l,g,x=W;(o?!Rt.echoes||qr++&&r===W:!qr||--qr&&r===W)||queueMicrotask(o?(function(R){++Ur,Rt.echoes&&--Rt.echoes!=0||(Rt.echoes=Rt.awaits=Rt.id=0),hr.push(W),Tr(R,!0)}).bind(null,r):pi),r!==W&&(W=r,x===Z&&(Z.env=Jn()),h)&&(l=Z.env.Promise,g=r.env,x.global||r.global)&&(Object.defineProperty(_,"Promise",g.PromiseProp),l.all=g.all,l.race=g.race,l.resolve=g.resolve,l.reject=g.reject,g.allSettled&&(l.allSettled=g.allSettled),g.any)&&(l.any=g.any)}function Jn(){var r=_.Promise;return h?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(_,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject}:{}}function xn(r,o,l,g,x){var R=W;try{return Tr(r,!0),o(l,g,x)}finally{Tr(R,!1)}}function mi(r,o,l,g){return typeof r!="function"?r:function(){var x=W;l&&Xt(),Tr(o,!0);try{return r.apply(this,arguments)}finally{Tr(x,!1),g&&queueMicrotask(dr)}}}function Mi(r){Promise===O&&Rt.echoes===0?qr===0?r():enqueueNativeMicroTask(r):setTimeout(r,0)}(""+Fr).indexOf("[native code]")===-1&&(Xt=dr=We);var _t=c.reject,wr="ï¿¿",Or="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Fn="String expected.",Lr=[],ln="__dbnames",En="readonly",An="readwrite";function Dr(r,o){return r?o?function(){return r.apply(this,arguments)&&o.apply(this,arguments)}:r:o}var Dn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function en(r){return typeof r!="string"||/\./.test(r)?function(o){return o}:function(o){return o[r]===void 0&&r in o&&delete(o=Se(o))[r],o}}function tn(){throw qe.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function xt(r,o){try{var l=Nn(r),g=Nn(o);if(l!==g)return l==="Array"?1:g==="Array"?-1:l==="binary"?1:g==="binary"?-1:l==="string"?1:g==="string"?-1:l==="Date"?1:g!=="Date"?NaN:-1;switch(l){case"number":case"Date":case"string":return o<r?1:r<o?-1:0;case"binary":for(var x=kn(r),R=kn(o),$=x.length,q=R.length,ae=$<q?$:q,de=0;de<ae;++de)if(x[de]!==R[de])return x[de]<R[de]?-1:1;return $===q?0:$<q?-1:1;case"Array":for(var re=r,ee=o,ce=re.length,ue=ee.length,oe=ce<ue?ce:ue,ne=0;ne<oe;++ne){var ye=xt(re[ne],ee[ne]);if(ye!==0)return ye}return ce===ue?0:ce<ue?-1:1}}catch{}return NaN}function Nn(r){var o=typeof r;return o=="object"&&(ArrayBuffer.isView(r)||(o=ft(r))==="ArrayBuffer")?"binary":o}function kn(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}function zr(r,o,l){var g=r.schema.yProps;return g?(o&&0<l.numFailures&&(o=o.filter(function(x,R){return!l.failures[R]})),Promise.all(g.map(function(x){return x=x.updatesTable,o?r.db.table(x).where("k").anyOf(o).delete():r.db.table(x).clear()})).then(function(){return l})):l}Er.prototype.execute=function(r){var o=this["@@propmod"];if(o.add!==void 0){var l=o.add;if(d(l))return k(k([],d(r)?r:[],!0),l).sort();if(typeof l=="number")return(Number(r)||0)+l;if(typeof l=="bigint")try{return BigInt(r)+l}catch{return BigInt(0)+l}throw new TypeError("Invalid term ".concat(l))}if(o.remove!==void 0){var g=o.remove;if(d(g))return d(r)?r.filter(function(x){return!g.includes(x)}).sort():[];if(typeof g=="number")return Number(r)-g;if(typeof g=="bigint")try{return BigInt(r)-g}catch{return BigInt(0)-g}throw new TypeError("Invalid subtrahend ".concat(g))}return l=(l=o.replacePrefix)==null?void 0:l[0],l&&typeof r=="string"&&r.startsWith(l)?o.replacePrefix[1]+r.substring(l.length):r};var cr=Er;function Er(r){this["@@propmod"]=r}function jn(r,o){for(var l=A(o),g=l.length,x=!1,R=0;R<g;++R){var $=l[R],q=o[$],ae=le(r,$);q instanceof cr?(H(r,$,q.execute(ae)),x=!0):ae!==q&&(H(r,$,q),x=!0)}return x}Dt.prototype._trans=function(r,o,l){var g=this._tx||W.trans,x=this.name,R=Ot&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function $(de,re,ee){if(ee.schema[x])return o(ee.idbtrans,ee);throw new qe.NotFound("Table "+x+" not part of transaction")}var q=Ge();try{var ae=g&&g.db._novip===this.db._novip?g===W.trans?g._promise(r,$,l):sr(function(){return g._promise(r,$,l)},{trans:g,transless:W.transless||W}):(function de(re,ee,ce,ue){if(re.idbdb&&(re._state.openComplete||W.letThrough||re._vip)){var oe=re._createTransaction(ee,ce,re._dbSchema);try{oe.create(),re._state.PR1398_maxLoop=3}catch(ne){return ne.name===ht.InvalidState&&re.isOpen()&&0<--re._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),re.close({disableAutoOpen:!1}),re.open().then(function(){return de(re,ee,ce,ue)})):_t(ne)}return oe._promise(ee,function(ne,ye){return sr(function(){return W.trans=oe,ue(ne,ye,oe)})}).then(function(ne){if(ee==="readwrite")try{oe.idbtrans.commit()}catch{}return ee==="readonly"?ne:oe._completion.then(function(){return ne})})}if(re._state.openComplete)return _t(new qe.DatabaseClosed(re._state.dbOpenError));if(!re._state.isBeingOpened){if(!re._state.autoOpen)return _t(new qe.DatabaseClosed);re.open().catch(We)}return re._state.dbReadyPromise.then(function(){return de(re,ee,ce,ue)})})(this.db,r,[this.name],$);return R&&(ae._consoleTask=R,ae=ae.catch(function(de){return console.trace(de),_t(de)})),ae}finally{q&&yt()}},Dt.prototype.get=function(r,o){var l=this;return r&&r.constructor===Object?this.where(r).first(o):r==null?_t(new qe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(g){return l.core.get({trans:g,key:r}).then(function(x){return l.hook.reading.fire(x)})}).then(o)},Dt.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(d(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var o=A(r);if(o.length===1)return this.where(o[0]).equals(r[o[0]]);var l=this.schema.indexes.concat(this.schema.primKey).filter(function(q){if(q.compound&&o.every(function(de){return 0<=q.keyPath.indexOf(de)})){for(var ae=0;ae<o.length;++ae)if(o.indexOf(q.keyPath[ae])===-1)return!1;return!0}return!1}).sort(function(q,ae){return q.keyPath.length-ae.keyPath.length})[0];if(l&&this.db._maxKey!==wr)return $=l.keyPath.slice(0,o.length),this.where($).equals($.map(function(q){return r[q]}));!l&&Ot&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(o.join("+"),"]"));var g=this.schema.idxByName;function x(q,ae){return xt(q,ae)===0}var $=o.reduce(function(re,ae){var de=re[0],re=re[1],ee=g[ae],ce=r[ae];return[de||ee,de||!ee?Dr(re,ee&&ee.multi?function(ue){return ue=le(ue,ae),d(ue)&&ue.some(function(oe){return x(ce,oe)})}:function(ue){return x(ce,le(ue,ae))}):re]},[null,null]),R=$[0],$=$[1];return R?this.where(R.name).equals(r[R.keyPath]).filter($):l?this.filter($):this.where(o).equals("")},Dt.prototype.filter=function(r){return this.toCollection().and(r)},Dt.prototype.count=function(r){return this.toCollection().count(r)},Dt.prototype.offset=function(r){return this.toCollection().offset(r)},Dt.prototype.limit=function(r){return this.toCollection().limit(r)},Dt.prototype.each=function(r){return this.toCollection().each(r)},Dt.prototype.toArray=function(r){return this.toCollection().toArray(r)},Dt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Dt.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,d(r)?"[".concat(r.join("+"),"]"):r))},Dt.prototype.reverse=function(){return this.toCollection().reverse()},Dt.prototype.mapToClass=function(r){for(var o=this.db,l=this.name,g=((this.schema.mappedClass=r).prototype instanceof tn&&(r=($=>{var q=re,ae=$;if(typeof ae!="function"&&ae!==null)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");function de(){this.constructor=q}function re(){return $!==null&&$.apply(this,arguments)||this}return w(q,ae),q.prototype=ae===null?Object.create(ae):(de.prototype=ae.prototype,new de),Object.defineProperty(re.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),re.prototype.table=function(){return l},re})(r)),new Set),x=r.prototype;x;x=F(x))Object.getOwnPropertyNames(x).forEach(function($){return g.add($)});function R($){if(!$)return $;var q,ae=Object.create(r.prototype);for(q in $)if(!g.has(q))try{ae[q]=$[q]}catch{}return ae}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=R,this.hook("reading",R),r},Dt.prototype.defineClass=function(){return this.mapToClass(function(r){y(this,r)})},Dt.prototype.add=function(r,o){var l=this,g=this.schema.primKey,x=g.auto,R=g.keyPath,$=r;return R&&x&&($=en(R)(r)),this._trans("readwrite",function(q){return l.core.mutate({trans:q,type:"add",keys:o!=null?[o]:null,values:[$]})}).then(function(q){return q.numFailures?c.reject(q.failures[0]):q.lastResult}).then(function(q){if(R)try{H(r,R,q)}catch{}return q})},Dt.prototype.upsert=function(r,o){var l=this,g=this.schema.primKey.keyPath;return this._trans("readwrite",function(x){return l.core.get({trans:x,key:r}).then(function(R){var $=R??{};return jn($,o),g&&H($,g,r),l.core.mutate({trans:x,type:"put",values:[$],keys:[r],upsert:!0,updates:{keys:[r],changeSpecs:[o]}}).then(function(q){return q.numFailures?c.reject(q.failures[0]):!!R})})})},Dt.prototype.update=function(r,o){return typeof r!="object"||d(r)?this.where(":id").equals(r).modify(o):(r=le(r,this.schema.primKey.keyPath))===void 0?_t(new qe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(o)},Dt.prototype.put=function(r,o){var l=this,g=this.schema.primKey,x=g.auto,R=g.keyPath,$=r;return R&&x&&($=en(R)(r)),this._trans("readwrite",function(q){return l.core.mutate({trans:q,type:"put",values:[$],keys:o!=null?[o]:null})}).then(function(q){return q.numFailures?c.reject(q.failures[0]):q.lastResult}).then(function(q){if(R)try{H(r,R,q)}catch{}return q})},Dt.prototype.delete=function(r){var o=this;return this._trans("readwrite",function(l){return o.core.mutate({trans:l,type:"delete",keys:[r]}).then(function(g){return zr(o,[r],g)}).then(function(g){return g.numFailures?c.reject(g.failures[0]):void 0})})},Dt.prototype.clear=function(){var r=this;return this._trans("readwrite",function(o){return r.core.mutate({trans:o,type:"deleteRange",range:Dn}).then(function(l){return zr(r,null,l)})}).then(function(o){return o.numFailures?c.reject(o.failures[0]):void 0})},Dt.prototype.bulkGet=function(r){var o=this;return this._trans("readonly",function(l){return o.core.getMany({keys:r,trans:l}).then(function(g){return g.map(function(x){return o.hook.reading.fire(x)})})})},Dt.prototype.bulkAdd=function(r,o,l){var g=this,x=Array.isArray(o)?o:void 0,R=(l=l||(x?void 0:o))?l.allKeys:void 0;return this._trans("readwrite",function($){var q=g.schema.primKey,de=q.auto,q=q.keyPath;if(q&&x)throw new qe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(x&&x.length!==r.length)throw new qe.InvalidArgument("Arguments objects and keys must have the same length");var ae=r.length,de=q&&de?r.map(en(q)):r;return g.core.mutate({trans:$,type:"add",keys:x,values:de,wantResults:R}).then(function(re){var ee=re.numFailures,ce=re.failures;if(ee===0)return R?re.results:re.lastResult;throw new ct("".concat(g.name,".bulkAdd(): ").concat(ee," of ").concat(ae," operations failed"),ce)})})},Dt.prototype.bulkPut=function(r,o,l){var g=this,x=Array.isArray(o)?o:void 0,R=(l=l||(x?void 0:o))?l.allKeys:void 0;return this._trans("readwrite",function($){var q=g.schema.primKey,de=q.auto,q=q.keyPath;if(q&&x)throw new qe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(x&&x.length!==r.length)throw new qe.InvalidArgument("Arguments objects and keys must have the same length");var ae=r.length,de=q&&de?r.map(en(q)):r;return g.core.mutate({trans:$,type:"put",keys:x,values:de,wantResults:R}).then(function(re){var ee=re.numFailures,ce=re.failures;if(ee===0)return R?re.results:re.lastResult;throw new ct("".concat(g.name,".bulkPut(): ").concat(ee," of ").concat(ae," operations failed"),ce)})})},Dt.prototype.bulkUpdate=function(r){var o=this,l=this.core,g=r.map(function($){return $.key}),x=r.map(function($){return $.changes}),R=[];return this._trans("readwrite",function($){return l.getMany({trans:$,keys:g,cache:"clone"}).then(function(q){var ae=[],de=[],re=(r.forEach(function(ee,ce){var ue=ee.key,oe=ee.changes,ne=q[ce];if(ne){for(var ye=0,ve=Object.keys(oe);ye<ve.length;ye++){var me=ve[ye],Pe=oe[me];if(me===o.schema.primKey.keyPath){if(xt(Pe,ue)!==0)throw new qe.Constraint("Cannot update primary key in bulkUpdate()")}else H(ne,me,Pe)}R.push(ce),ae.push(ue),de.push(ne)}}),ae.length);return l.mutate({trans:$,type:"put",keys:ae,values:de,updates:{keys:g,changeSpecs:x}}).then(function(ee){var ce=ee.numFailures,ue=ee.failures;if(ce===0)return re;for(var oe=0,ne=Object.keys(ue);oe<ne.length;oe++){var ye,ve=ne[oe],me=R[Number(ve)];me!=null&&(ye=ue[ve],delete ue[ve],ue[me]=ye)}throw new ct("".concat(o.name,".bulkUpdate(): ").concat(ce," of ").concat(re," operations failed"),ue)})})})},Dt.prototype.bulkDelete=function(r){var o=this,l=r.length;return this._trans("readwrite",function(g){return o.core.mutate({trans:g,type:"delete",keys:r}).then(function(x){return zr(o,r,x)})}).then(function(g){var x=g.numFailures,R=g.failures;if(x===0)return g.lastResult;throw new ct("".concat(o.name,".bulkDelete(): ").concat(x," of ").concat(l," operations failed"),R)})};var fn=Dt;function Dt(){}function $r(r){function o($,q){if(q){for(var ae=arguments.length,de=new Array(ae-1);--ae;)de[ae-1]=arguments[ae];return l[$].subscribe.apply(null,de),r}if(typeof $=="string")return l[$]}var l={};o.addEventType=R;for(var g=1,x=arguments.length;g<x;++g)R(arguments[g]);return o;function R($,q,ae){var de,re;if(typeof $!="object")return q=q||Wt,re={subscribers:[],fire:ae=ae||We,subscribe:function(ee){re.subscribers.indexOf(ee)===-1&&(re.subscribers.push(ee),re.fire=q(re.fire,ee))},unsubscribe:function(ee){re.subscribers=re.subscribers.filter(function(ce){return ce!==ee}),re.fire=re.subscribers.reduce(q,ae)}},l[$]=o[$]=re;A(de=$).forEach(function(ee){var ce=de[ee];if(d(ce))R(ee,de[ee][0],de[ee][1]);else{if(ce!=="asap")throw new qe.InvalidArgument("Invalid event config");var ue=R(ee,vt,function(){for(var oe=arguments.length,ne=new Array(oe);oe--;)ne[oe]=arguments[oe];ue.subscribers.forEach(function(ye){Te(function(){ye.apply(null,ne)})})})}})}}function rn(r,o){return we(o).from({prototype:r}),o}function Hr(r,o){return!(r.filter||r.algorithm||r.or)&&(o?r.justLimit:!r.replayFilter)}function Sn(r,o){r.filter=Dr(r.filter,o)}function hn(r,o,l){var g=r.replayFilter;r.replayFilter=g?function(){return Dr(g(),o())}:o,r.justLimit=l&&!g}function dn(r,o){if(r.isPrimKey)return o.primaryKey;var l=o.getIndexByKeyPath(r.index);if(l)return l;throw new qe.Schema("KeyPath "+r.index+" on object store "+o.name+" is not indexed")}function Mn(r,o,l){var g=dn(r,o.schema);return o.openCursor({trans:l,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:g,range:r.range}})}function Qn(r,o,l,g){var x,R,$=r.replayFilter?Dr(r.filter,r.replayFilter()):r.filter;return r.or?(x={},R=function(q,ae,de){var re,ee;$&&!$(ae,de,function(ce){return ae.stop(ce)},function(ce){return ae.fail(ce)})||((ee=""+(re=ae.primaryKey))=="[object ArrayBuffer]"&&(ee=""+new Uint8Array(re)),B(x,ee))||(x[ee]=!0,o(q,ae,de))},Promise.all([r.or._iterate(R,l),wi(Mn(r,g,l),r.algorithm,R,!r.keysOnly&&r.valueMapper)])):wi(Mn(r,g,l),Dr(r.algorithm,$),o,!r.keysOnly&&r.valueMapper)}function wi(r,o,l,g){var x=lt(g?function(R,$,q){return l(g(R),$,q)}:l);return r.then(function(R){if(R)return R.start(function(){var $=function(){return R.continue()};o&&!o(R,function(q){return $=q},function(q){R.stop(q),$=We},function(q){R.fail(q),$=We})||x(R.value,R,function(q){return $=q}),$()})})}Ct.prototype._read=function(r,o){var l=this._ctx;return l.error?l.table._trans(null,_t.bind(null,l.error)):l.table._trans("readonly",r).then(o)},Ct.prototype._write=function(r){var o=this._ctx;return o.error?o.table._trans(null,_t.bind(null,o.error)):o.table._trans("readwrite",r,"locked")},Ct.prototype._addAlgorithm=function(r){var o=this._ctx;o.algorithm=Dr(o.algorithm,r)},Ct.prototype._iterate=function(r,o){return Qn(this._ctx,r,o,this._ctx.table.core)},Ct.prototype.clone=function(r){var o=Object.create(this.constructor.prototype),l=Object.create(this._ctx);return r&&y(l,r),o._ctx=l,o},Ct.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ct.prototype.each=function(r){var o=this._ctx;return this._read(function(l){return Qn(o,r,l,o.table.core)})},Ct.prototype.count=function(r){var o=this;return this._read(function(l){var g,x=o._ctx,R=x.table.core;return Hr(x,!0)?R.count({trans:l,query:{index:dn(x,R.schema),range:x.range}}).then(function($){return Math.min($,x.limit)}):(g=0,Qn(x,function(){return++g,!1},l,R).then(function(){return g}))}).then(r)},Ct.prototype.sortBy=function(r,o){var l=r.split(".").reverse(),g=l[0],x=l.length-1;function R(ae,de){return de?R(ae[l[de]],de-1):ae[g]}var $=this._ctx.dir==="next"?1:-1;function q(ae,de){return xt(R(ae,x),R(de,x))*$}return this.toArray(function(ae){return ae.sort(q)}).then(o)},Ct.prototype.toArray=function(r){var o=this;return this._read(function(l){var g,x,R,$=o._ctx;return $.dir==="next"&&Hr($,!0)&&0<$.limit?(g=$.valueMapper,x=dn($,$.table.core.schema),$.table.core.query({trans:l,limit:$.limit,values:!0,query:{index:x,range:$.range}}).then(function(q){return q=q.result,g?q.map(g):q})):(R=[],Qn($,function(q){return R.push(q)},l,$.table.core).then(function(){return R}))},r)},Ct.prototype.offset=function(r){var o=this._ctx;return r<=0||(o.offset+=r,Hr(o)?hn(o,function(){var l=r;return function(g,x){return l===0||(l===1?--l:x(function(){g.advance(l),l=0}),!1)}}):hn(o,function(){var l=r;return function(){return--l<0}})),this},Ct.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),hn(this._ctx,function(){var o=r;return function(l,g,x){return--o<=0&&g(x),0<=o}},!0),this},Ct.prototype.until=function(r,o){return Sn(this._ctx,function(l,g,x){return!r(l.value)||(g(x),o)}),this},Ct.prototype.first=function(r){return this.limit(1).toArray(function(o){return o[0]}).then(r)},Ct.prototype.last=function(r){return this.reverse().first(r)},Ct.prototype.filter=function(r){var o;return Sn(this._ctx,function(l){return r(l.value)}),(o=this._ctx).isMatch=Dr(o.isMatch,r),this},Ct.prototype.and=function(r){return this.filter(r)},Ct.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},Ct.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ct.prototype.desc=function(){return this.reverse()},Ct.prototype.eachKey=function(r){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(l,g){r(g.key,g)})},Ct.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},Ct.prototype.eachPrimaryKey=function(r){var o=this._ctx;return o.keysOnly=!o.isMatch,this.each(function(l,g){r(g.primaryKey,g)})},Ct.prototype.keys=function(r){var o=this._ctx,l=(o.keysOnly=!o.isMatch,[]);return this.each(function(g,x){l.push(x.key)}).then(function(){return l}).then(r)},Ct.prototype.primaryKeys=function(r){var o=this._ctx;if(o.dir==="next"&&Hr(o,!0)&&0<o.limit)return this._read(function(g){var x=dn(o,o.table.core.schema);return o.table.core.query({trans:g,values:!1,limit:o.limit,query:{index:x,range:o.range}})}).then(function(g){return g.result}).then(r);o.keysOnly=!o.isMatch;var l=[];return this.each(function(g,x){l.push(x.primaryKey)}).then(function(){return l}).then(r)},Ct.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},Ct.prototype.firstKey=function(r){return this.limit(1).keys(function(o){return o[0]}).then(r)},Ct.prototype.lastKey=function(r){return this.reverse().firstKey(r)},Ct.prototype.distinct=function(){var r,o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];return o&&o.multi&&(r={},Sn(this._ctx,function(g){var g=g.primaryKey.toString(),x=B(r,g);return r[g]=!0,!x})),this},Ct.prototype.modify=function(r){var o=this,l=this._ctx;return this._write(function(g){function x(ne,ye){var ve=ye.failures;ce+=ne-ye.numFailures;for(var me=0,Pe=A(ve);me<Pe.length;me++){var je=Pe[me];ee.push(ve[je])}}var R=typeof r=="function"?r:function(ne){return jn(ne,r)},$=l.table.core,re=$.schema.primaryKey,q=re.outbound,ae=re.extractKey,de=200,re=o.db._options.modifyChunkSize,ee=(re&&(de=typeof re=="object"?re[$.name]||re["*"]||200:re),[]),ce=0,ue=[],oe=r===ba;return o.clone().primaryKeys().then(function(ne){function ye(me){var Pe=Math.min(de,ne.length-me),je=ne.slice(me,me+Pe);return(oe?Promise.resolve([]):$.getMany({trans:g,keys:je,cache:"immutable"})).then(function(Ze){var Ve=[],Me=[],tt=q?[]:null,et=oe?je:[];if(!oe)for(var ze=0;ze<Pe;++ze){var nt=Ze[ze],Tt={value:Se(nt),primKey:ne[me+ze]};R.call(Tt,Tt.value,Tt)!==!1&&(Tt.value==null?et.push(ne[me+ze]):q||xt(ae(nt),ae(Tt.value))===0?(Me.push(Tt.value),q&&tt.push(ne[me+ze])):(et.push(ne[me+ze]),Ve.push(Tt.value)))}return Promise.resolve(0<Ve.length&&$.mutate({trans:g,type:"add",values:Ve}).then(function($t){for(var wt in $t.failures)et.splice(parseInt(wt),1);x(Ve.length,$t)})).then(function(){return(0<Me.length||ve&&typeof r=="object")&&$.mutate({trans:g,type:"put",keys:tt,values:Me,criteria:ve,changeSpec:typeof r!="function"&&r,isAdditionalChunk:0<me}).then(function($t){return x(Me.length,$t)})}).then(function(){return(0<et.length||ve&&oe)&&$.mutate({trans:g,type:"delete",keys:et,criteria:ve,isAdditionalChunk:0<me}).then(function($t){return zr(l.table,et,$t)}).then(function($t){return x(et.length,$t)})}).then(function(){return ne.length>me+Pe&&ye(me+de)})})}var ve=Hr(l)&&l.limit===1/0&&(typeof r!="function"||oe)&&{index:l.index,range:l.range};return ye(0).then(function(){if(0<ee.length)throw new Et("Error modifying one or more objects",ee,ce,ue);return ne.length})})})},Ct.prototype.delete=function(){var r=this._ctx,o=r.range;return!Hr(r)||r.table.schema.yProps||!r.isPrimKey&&o.type!==3?this.modify(ba):this._write(function(l){var g=r.table.core.schema.primaryKey,x=o;return r.table.core.count({trans:l,query:{index:g,range:x}}).then(function(R){return r.table.core.mutate({trans:l,type:"deleteRange",range:x}).then(function(ae){var q=ae.failures,ae=ae.numFailures;if(ae)throw new Et("Could not delete some values",Object.keys(q).map(function(de){return q[de]}),R-ae);return R-ae})})})};var Os=Ct;function Ct(){}var ba=function(r,o){return o.value=null};function nn(r,o){return r<o?-1:r===o?0:1}function gi(r,o){return o<r?-1:r===o?0:1}function Pr(r,o,l){return r=r instanceof Zt?new r.Collection(r):r,r._ctx.error=new(l||TypeError)(o),r}function qn(r){return new r.Collection(r,function(){return _a("")}).limit(0)}function mr(ue,o,l,g){var x,R,$,q,ae,de,re,ee=l.length;if(!l.every(function(ne){return typeof ne=="string"}))return Pr(ue,Fn);function ce(ne){x=ne==="next"?function(ve){return ve.toUpperCase()}:function(ve){return ve.toLowerCase()},R=ne==="next"?function(ve){return ve.toLowerCase()}:function(ve){return ve.toUpperCase()},$=ne==="next"?nn:gi;var ye=l.map(function(ve){return{lower:R(ve),upper:x(ve)}}).sort(function(ve,me){return $(ve.lower,me.lower)});q=ye.map(function(ve){return ve.upper}),ae=ye.map(function(ve){return ve.lower}),re=(de=ne)==="next"?"":g}ce("next");var ue=new ue.Collection(ue,function(){return Gr(q[0],ae[ee-1]+g)}),oe=(ue._ondirectionchange=function(ne){ce(ne)},0);return ue._addAlgorithm(function(ne,ye,ve){var me=ne.key;if(typeof me=="string"){var Pe=R(me);if(o(Pe,ae,oe))return!0;for(var je=null,Ze=oe;Ze<ee;++Ze){var Ve=((Me,tt,et,ze,nt,Tt)=>{for(var $t=Math.min(Me.length,ze.length),wt=-1,St=0;St<$t;++St){var Qt=tt[St];if(Qt!==ze[St])return nt(Me[St],et[St])<0?Me.substr(0,St)+et[St]+et.substr(St+1):nt(Me[St],ze[St])<0?Me.substr(0,St)+ze[St]+et.substr(St+1):0<=wt?Me.substr(0,wt)+tt[wt]+et.substr(wt+1):null;nt(Me[St],Qt)<0&&(wt=St)}return $t<ze.length&&Tt==="next"?Me+et.substr(Me.length):$t<Me.length&&Tt==="prev"?Me.substr(0,et.length):wt<0?null:Me.substr(0,wt)+ze[wt]+et.substr(wt+1)})(me,Pe,q[Ze],ae[Ze],$,de);Ve===null&&je===null?oe=Ze+1:(je===null||0<$(je,Ve))&&(je=Ve)}ye(je!==null?function(){ne.continue(je+re)}:ve)}return!1}),ue}function Gr(r,o,l,g){return{type:2,lower:r,upper:o,lowerOpen:l,upperOpen:g}}function _a(r){return{type:1,lower:r,upper:r}}Object.defineProperty(Jt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Jt.prototype.between=function(r,o,l,g){l=l!==!1,g=g===!0;try{return 0<this._cmp(r,o)||this._cmp(r,o)===0&&(l||g)&&(!l||!g)?qn(this):new this.Collection(this,function(){return Gr(r,o,!l,!g)})}catch{return Pr(this,Or)}},Jt.prototype.equals=function(r){return r==null?Pr(this,Or):new this.Collection(this,function(){return _a(r)})},Jt.prototype.above=function(r){return r==null?Pr(this,Or):new this.Collection(this,function(){return Gr(r,void 0,!0)})},Jt.prototype.aboveOrEqual=function(r){return r==null?Pr(this,Or):new this.Collection(this,function(){return Gr(r,void 0,!1)})},Jt.prototype.below=function(r){return r==null?Pr(this,Or):new this.Collection(this,function(){return Gr(void 0,r,!1,!0)})},Jt.prototype.belowOrEqual=function(r){return r==null?Pr(this,Or):new this.Collection(this,function(){return Gr(void 0,r)})},Jt.prototype.startsWith=function(r){return typeof r!="string"?Pr(this,Fn):this.between(r,r+wr,!0,!0)},Jt.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):mr(this,function(o,l){return o.indexOf(l[0])===0},[r],wr)},Jt.prototype.equalsIgnoreCase=function(r){return mr(this,function(o,l){return o===l[0]},[r],"")},Jt.prototype.anyOfIgnoreCase=function(){var r=mt.apply(Ue,arguments);return r.length===0?qn(this):mr(this,function(o,l){return l.indexOf(o)!==-1},r,"")},Jt.prototype.startsWithAnyOfIgnoreCase=function(){var r=mt.apply(Ue,arguments);return r.length===0?qn(this):mr(this,function(o,l){return l.some(function(g){return o.indexOf(g)===0})},r,wr)},Jt.prototype.anyOf=function(){var r,o,l=this,g=mt.apply(Ue,arguments),x=this._cmp;try{g.sort(x)}catch{return Pr(this,Or)}return g.length===0?qn(this):((r=new this.Collection(this,function(){return Gr(g[0],g[g.length-1])}))._ondirectionchange=function(R){x=R==="next"?l._ascending:l._descending,g.sort(x)},o=0,r._addAlgorithm(function(R,$,q){for(var ae=R.key;0<x(ae,g[o]);)if(++o===g.length)return $(q),!1;return x(ae,g[o])===0||($(function(){R.continue(g[o])}),!1)}),r)},Jt.prototype.notEqual=function(r){return this.inAnyRange([[-1/0,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Jt.prototype.noneOf=function(){var r=mt.apply(Ue,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return Pr(this,Or)}var o=r.reduce(function(l,g){return l?l.concat([[l[l.length-1][1],g]]):[[-1/0,g]]},null);return o.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(o,{includeLowers:!1,includeUppers:!1})},Jt.prototype.inAnyRange=function(r,ve){var l=this,g=this._cmp,x=this._ascending,R=this._descending,$=this._min,q=this._max;if(r.length===0)return qn(this);if(!r.every(function(me){return me[0]!==void 0&&me[1]!==void 0&&x(me[0],me[1])<=0}))return Pr(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",qe.InvalidArgument);var ae=!ve||ve.includeLowers!==!1,de=ve&&ve.includeUppers===!0,re,ee=x;function ce(me,Pe){return ee(me[0],Pe[0])}try{(re=r.reduce(function(me,Pe){for(var je=0,Ze=me.length;je<Ze;++je){var Ve=me[je];if(g(Pe[0],Ve[1])<0&&0<g(Pe[1],Ve[0])){Ve[0]=$(Ve[0],Pe[0]),Ve[1]=q(Ve[1],Pe[1]);break}}return je===Ze&&me.push(Pe),me},[])).sort(ce)}catch{return Pr(this,Or)}var ue=0,oe=de?function(me){return 0<x(me,re[ue][1])}:function(me){return 0<=x(me,re[ue][1])},ne=ae?function(me){return 0<R(me,re[ue][0])}:function(me){return 0<=R(me,re[ue][0])},ye=oe,ve=new this.Collection(this,function(){return Gr(re[0][0],re[re.length-1][1],!ae,!de)});return ve._ondirectionchange=function(me){ee=me==="next"?(ye=oe,x):(ye=ne,R),re.sort(ce)},ve._addAlgorithm(function(me,Pe,je){for(var Ze,Ve=me.key;ye(Ve);)if(++ue===re.length)return Pe(je),!1;return!oe(Ze=Ve)&&!ne(Ze)||(l._cmp(Ve,re[ue][1])===0||l._cmp(Ve,re[ue][0])===0||Pe(function(){ee===x?me.continue(re[ue][0]):me.continue(re[ue][1])}),!1)}),ve},Jt.prototype.startsWithAnyOf=function(){var r=mt.apply(Ue,arguments);return r.every(function(o){return typeof o=="string"})?r.length===0?qn(this):this.inAnyRange(r.map(function(o){return[o,o+wr]})):Pr(this,"startsWithAnyOf() only works with strings")};var Zt=Jt;function Jt(){}function Kr(r){return lt(function(o){return gr(o),r(o.target.error),!1})}function gr(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}var ei="storagemutated",pn="x-storagemutated-1",mn=$r(null,ei),xa=(Wr.prototype._lock=function(){return ge(!W.global),++this._reculock,this._reculock!==1||W.global||(W.lockOwnerFor=this),this},Wr.prototype._unlock=function(){if(ge(!W.global),--this._reculock==0)for(W.global||(W.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var r=this._blockedFuncs.shift();try{xn(r[1],r[0])}catch{}}return this},Wr.prototype._locked=function(){return this._reculock&&W.lockOwnerFor!==this},Wr.prototype.create=function(r){var o=this;if(this.mode){var l=this.db.idbdb,g=this.db._state.dbOpenError;if(ge(!this.idbtrans),!r&&!l)switch(g&&g.name){case"DatabaseClosedError":throw new qe.DatabaseClosed(g);case"MissingAPIError":throw new qe.MissingAPI(g.message,g);default:throw new qe.OpenFailed(g)}if(!this.active)throw new qe.TransactionInactive;ge(this._completion._state===null),(r=this.idbtrans=r||(this.db.core||l).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=lt(function(x){gr(x),o._reject(r.error)}),r.onabort=lt(function(x){gr(x),o.active&&o._reject(new qe.Abort(r.error)),o.active=!1,o.on("abort").fire(x)}),r.oncomplete=lt(function(){o.active=!1,o._resolve(),"mutatedParts"in r&&mn.storagemutated.fire(r.mutatedParts)})}return this},Wr.prototype._promise=function(r,o,l){var g,x=this;return r==="readwrite"&&this.mode!=="readwrite"?_t(new qe.ReadOnly("Transaction is readonly")):this.active?this._locked()?new c(function(R,$){x._blockedFuncs.push([function(){x._promise(r,o,l).then(R,$)},W])}):l?sr(function(){var R=new c(function($,q){x._lock();var ae=o($,q,x);ae&&ae.then&&ae.then($,q)});return R.finally(function(){return x._unlock()}),R._lib=!0,R}):((g=new c(function(R,$){var q=o(R,$,x);q&&q.then&&q.then(R,$)}))._lib=!0,g):_t(new qe.TransactionInactive)},Wr.prototype._root=function(){return this.parent?this.parent._root():this},Wr.prototype.waitFor=function(r){var o,l=this._root(),g=c.resolve(r),x=(l._waitingFor?l._waitingFor=l._waitingFor.then(function(){return g}):(l._waitingFor=g,l._waitingQueue=[],o=l.idbtrans.objectStore(l.storeNames[0]),(function R(){for(++l._spinCount;l._waitingQueue.length;)l._waitingQueue.shift()();l._waitingFor&&(o.get(-1/0).onsuccess=R)})()),l._waitingFor);return new c(function(R,$){g.then(function(q){return l._waitingQueue.push(lt(R.bind(null,q)))},function(q){return l._waitingQueue.push(lt($.bind(null,q)))}).finally(function(){l._waitingFor===x&&(l._waitingFor=null)})})},Wr.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new qe.Abort))},Wr.prototype.table=function(r){var o=this._memoizedTables||(this._memoizedTables={});if(B(o,r))return o[r];var l=this.schema[r];if(l)return(l=new this.db.Table(r,l,this)).core=this.db.core.table(r),o[r]=l;throw new qe.NotFound("Table "+r+" not part of transaction")},Wr);function Wr(){}function qi(r,o,l,g,x,R,$,q){return{name:r,keyPath:o,unique:l,multi:g,auto:x,compound:R,src:(l&&!$?"&":"")+(g?"*":"")+(x?"++":"")+an(o),type:q}}function an(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function ti(r,o,l){return{name:r,primKey:o,indexes:l,mappedClass:null,idxByName:(g=function(x){return[x.name,x]},l.reduce(function(x,R,$){return R=g(R,$),R&&(x[R[0]]=R[1]),x},{}))};var g}var ri=function(r){try{return r.only([[]]),ri=function(){return[[]]},[[]]}catch{return ri=function(){return wr},wr}};function Ui(r){return r==null?function(){}:typeof r=="string"?(o=r).split(".").length===1?function(l){return l[o]}:function(l){return le(l,o)}:function(l){return le(l,r)};var o}function Li(r){return[].slice.call(r)}var Ea=0;function Un(r){return r==null?":id":typeof r=="string"?r:"[".concat(r.join("+"),"]")}function Aa(r,o,ae){function g(oe){if(oe.type===3)return null;if(oe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var ee=oe.lower,ce=oe.upper,ue=oe.lowerOpen,oe=oe.upperOpen;return ee===void 0?ce===void 0?null:o.upperBound(ce,!!oe):ce===void 0?o.lowerBound(ee,!!ue):o.bound(ee,ce,!!ue,!!oe)}function x(re){var ee,ce=re.name;return{name:ce,schema:re,mutate:function(ue){var oe=ue.trans,ne=ue.type,ye=ue.keys,ve=ue.values,me=ue.range;return new Promise(function(Pe,je){Pe=lt(Pe);var Ze=oe.objectStore(ce),Ve=Ze.keyPath==null,Me=ne==="put"||ne==="add";if(!Me&&ne!=="delete"&&ne!=="deleteRange")throw new Error("Invalid operation type: "+ne);var tt,et=(ye||ve||{length:1}).length;if(ye&&ve&&ye.length!==ve.length)throw new Error("Given keys array must have same length as given values array.");if(et===0)return Pe({numFailures:0,failures:{},results:[],lastResult:void 0});function ze(ar){++$t,gr(ar)}var nt=[],Tt=[],$t=0;if(ne==="deleteRange"){if(me.type===4)return Pe({numFailures:$t,failures:Tt,results:[],lastResult:void 0});me.type===3?nt.push(tt=Ze.clear()):nt.push(tt=Ze.delete(g(me)))}else{var Ve=Me?Ve?[ve,ye]:[ve,null]:[ye,null],wt=Ve[0],St=Ve[1];if(Me)for(var Qt=0;Qt<et;++Qt)nt.push(tt=St&&St[Qt]!==void 0?Ze[ne](wt[Qt],St[Qt]):Ze[ne](wt[Qt])),tt.onerror=ze;else for(Qt=0;Qt<et;++Qt)nt.push(tt=Ze[ne](wt[Qt])),tt.onerror=ze}function Br(ar){ar=ar.target.result,nt.forEach(function(gn,ta){return gn.error!=null&&(Tt[ta]=gn.error)}),Pe({numFailures:$t,failures:Tt,results:ne==="delete"?ye:nt.map(function(gn){return gn.result}),lastResult:ar})}tt.onerror=function(ar){ze(ar),Br(ar)},tt.onsuccess=Br})},getMany:function(ue){var oe=ue.trans,ne=ue.keys;return new Promise(function(ye,ve){ye=lt(ye);for(var me,Pe=oe.objectStore(ce),je=ne.length,Ze=new Array(je),Ve=0,Me=0,tt=function(nt){nt=nt.target,Ze[nt._pos]=nt.result,++Me===Ve&&ye(Ze)},et=Kr(ve),ze=0;ze<je;++ze)ne[ze]!=null&&((me=Pe.get(ne[ze]))._pos=ze,me.onsuccess=tt,me.onerror=et,++Ve);Ve===0&&ye(Ze)})},get:function(ue){var oe=ue.trans,ne=ue.key;return new Promise(function(ye,ve){ye=lt(ye);var me=oe.objectStore(ce).get(ne);me.onsuccess=function(Pe){return ye(Pe.target.result)},me.onerror=Kr(ve)})},query:(ee=q,function(ue){return new Promise(function(oe,ne){oe=lt(oe);var ye,ve,me,Me=ue.trans,Pe=ue.values,je=ue.limit,Ve=ue.query,Ze=je===1/0?void 0:je,tt=Ve.index,Ve=Ve.range,Me=Me.objectStore(ce),Me=tt.isPrimaryKey?Me:Me.index(tt.name),tt=g(Ve);if(je===0)return oe({result:[]});ee?((Ve=Pe?Me.getAll(tt,Ze):Me.getAllKeys(tt,Ze)).onsuccess=function(et){return oe({result:et.target.result})},Ve.onerror=Kr(ne)):(ye=0,ve=!Pe&&"openKeyCursor"in Me?Me.openKeyCursor(tt):Me.openCursor(tt),me=[],ve.onsuccess=function(et){var ze=ve.result;return!ze||(me.push(Pe?ze.value:ze.primaryKey),++ye===je)?oe({result:me}):void ze.continue()},ve.onerror=Kr(ne))})}),openCursor:function(ue){var oe=ue.trans,ne=ue.values,ye=ue.query,ve=ue.reverse,me=ue.unique;return new Promise(function(Pe,je){Pe=lt(Pe);var Me=ye.index,Ze=ye.range,Ve=oe.objectStore(ce),Ve=Me.isPrimaryKey?Ve:Ve.index(Me.name),Me=ve?me?"prevunique":"prev":me?"nextunique":"next",tt=!ne&&"openKeyCursor"in Ve?Ve.openKeyCursor(g(Ze),Me):Ve.openCursor(g(Ze),Me);tt.onerror=Kr(je),tt.onsuccess=lt(function(et){var ze,nt,Tt,$t,wt=tt.result;wt?(wt.___id=++Ea,wt.done=!1,ze=wt.continue.bind(wt),nt=(nt=wt.continuePrimaryKey)&&nt.bind(wt),Tt=wt.advance.bind(wt),$t=function(){throw new Error("Cursor not stopped")},wt.trans=oe,wt.stop=wt.continue=wt.continuePrimaryKey=wt.advance=function(){throw new Error("Cursor not started")},wt.fail=lt(je),wt.next=function(){var St=this,Qt=1;return this.start(function(){return Qt--?St.continue():St.stop()}).then(function(){return St})},wt.start=function(St){function Qt(){if(tt.result)try{St()}catch(ar){wt.fail(ar)}else wt.done=!0,wt.start=function(){throw new Error("Cursor behind last entry")},wt.stop()}var Br=new Promise(function(ar,gn){ar=lt(ar),tt.onerror=Kr(gn),wt.fail=gn,wt.stop=function(ta){wt.stop=wt.continue=wt.continuePrimaryKey=wt.advance=$t,ar(ta)}});return tt.onsuccess=lt(function(ar){tt.onsuccess=Qt,Qt()}),wt.continue=ze,wt.continuePrimaryKey=nt,wt.advance=Tt,Qt(),Br},Pe(wt)):Pe(null)},je)})},count:function(ue){var oe=ue.query,ne=ue.trans,ye=oe.index,ve=oe.range;return new Promise(function(me,Pe){var je=ne.objectStore(ce),je=ye.isPrimaryKey?je:je.index(ye.name),Ze=g(ve),Ze=Ze?je.count(Ze):je.count();Ze.onsuccess=lt(function(Ve){return me(Ve.target.result)}),Ze.onerror=Kr(Pe)})}}}R=ae,$=Li((ae=r).objectStoreNames);var R,ae={schema:{name:ae.name,tables:$.map(function(re){return R.objectStore(re)}).map(function(re){var ee=re.keyPath,ce=re.autoIncrement,oe=d(ee),ue={},oe={name:re.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:ee==null,compound:oe,keyPath:ee,autoIncrement:ce,unique:!0,extractKey:Ui(ee)},indexes:Li(re.indexNames).map(function(ne){return re.index(ne)}).map(function(me){var Pe=me.name,ye=me.unique,ve=me.multiEntry,me=me.keyPath,Pe={name:Pe,compound:d(me),keyPath:me,unique:ye,multiEntry:ve,extractKey:Ui(me)};return ue[Un(me)]=Pe}),getIndexByKeyPath:function(ne){return ue[Un(ne)]}};return ue[":id"]=oe.primaryKey,ee!=null&&(ue[Un(ee)]=oe.primaryKey),oe})},hasGetAll:0<$.length&&"getAll"in R.objectStore($[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},$=ae.schema,q=ae.hasGetAll,ae=$.tables.map(x),de={};return ae.forEach(function(re){return de[re.name]=re}),{stack:"dbcore",transaction:r.transaction.bind(r),table:function(re){if(de[re])return de[re];throw new Error("Table '".concat(re,"' not found"))},MIN_KEY:-1/0,MAX_KEY:ri(o),schema:$}}function at(r,o,l,g){return l=l.IDBKeyRange,o=Aa(o,l,g),{dbcore:r.dbcore.reduce(function(x,R){return R=R.create,m(m({},x),R(x))},o)}}function se(r,o){var l=o.db,l=at(r._middlewares,l,r._deps,o);r.core=l.dbcore,r.tables.forEach(function(g){var x=g.name;r.core.schema.tables.some(function(R){return R.name===x})&&(g.core=r.core.table(x),r[x]instanceof r.Table)&&(r[x].core=g.core)})}function it(r,o,l,g){l.forEach(function(x){var R=g[x];o.forEach(function($){var q=(function ae(de,re){return ie(de,re)||(de=F(de))&&ae(de,re)})($,x);(!q||"value"in q&&q.value===void 0)&&($===r.Transaction.prototype||$ instanceof r.Transaction?V($,x,{get:function(){return this.table(x)},set:function(ae){j(this,x,{value:ae,writable:!0,configurable:!0,enumerable:!0})}}):$[x]=new r.Table(x,R))})})}function Ln(r,o){o.forEach(function(l){for(var g in l)l[g]instanceof r.Table&&delete l[g]})}function ka(r,o){return r._cfg.version-o._cfg.version}function zn(r,o,l,g){var x=r._dbSchema,R=(l.objectStoreNames.contains("$meta")&&!x.$meta&&(x.$meta=ti("$meta",zi("")[0],[]),r._storeNames.push("$meta")),r._createTransaction("readwrite",r._storeNames,x)),$=(R.create(l),R._completion.catch(g),R._reject.bind(R)),q=W.transless||W;sr(function(){if(W.trans=R,W.transless=q,o!==0)return se(r,l),de=o,((ae=R).storeNames.includes("$meta")?ae.table("$meta").get("version").then(function(re){return re??de}):c.resolve(de)).then(function(ye){var ee=r,ce=ye,ue=R,oe=l,ne=[],ye=ee._versions,ve=ee._dbSchema=yr(0,ee.idbdb,oe);return(ye=ye.filter(function(me){return me._cfg.version>=ce})).length===0?c.resolve():(ye.forEach(function(me){ne.push(function(){var Pe,je,Ze,Ve=ve,Me=me._cfg.dbschema,tt=(ii(ee,Ve,oe),ii(ee,Me,oe),ve=ee._dbSchema=Me,ni(Ve,Me)),et=(tt.add.forEach(function(ze){yi(oe,ze[0],ze[1].primKey,ze[1].indexes)}),tt.change.forEach(function(ze){if(ze.recreate)throw new qe.Upgrade("Not yet support for changing primary key");var nt=oe.objectStore(ze.name);ze.add.forEach(function(Tt){return vi(nt,Tt)}),ze.change.forEach(function(Tt){nt.deleteIndex(Tt.name),vi(nt,Tt)}),ze.del.forEach(function(Tt){return nt.deleteIndex(Tt)})}),me._cfg.contentUpgrade);if(et&&me._cfg.version>ce)return se(ee,oe),ue._memoizedTables={},Pe=fe(Me),tt.del.forEach(function(ze){Pe[ze]=Ve[ze]}),Ln(ee,[ee.Transaction.prototype]),it(ee,[ee.Transaction.prototype],A(Pe),Pe),ue.schema=Pe,(je=pt(et))&&Xt(),Me=c.follow(function(){var ze;(Ze=et(ue))&&je&&(ze=dr.bind(null,null),Ze.then(ze,ze))}),Ze&&typeof Ze.then=="function"?c.resolve(Ze):Me.then(function(){return Ze})}),ne.push(function(Pe){var je,Ze,Ve=me._cfg.dbschema;je=Ve,Ze=Pe,[].slice.call(Ze.db.objectStoreNames).forEach(function(Me){return je[Me]==null&&Ze.db.deleteObjectStore(Me)}),Ln(ee,[ee.Transaction.prototype]),it(ee,[ee.Transaction.prototype],ee._storeNames,ee._dbSchema),ue.schema=ee._dbSchema}),ne.push(function(Pe){ee.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(ee.idbdb.version/10)===me._cfg.version?(ee.idbdb.deleteObjectStore("$meta"),delete ee._dbSchema.$meta,ee._storeNames=ee._storeNames.filter(function(je){return je!=="$meta"})):Pe.objectStore("$meta").put(me._cfg.version,"version"))})}),(function me(){return ne.length?c.resolve(ne.shift()(ue.idbtrans)).then(me):c.resolve()})().then(function(){Sa(ve,oe)}))}).catch($);var ae,de;A(x).forEach(function(re){yi(l,re,x[re].primKey,x[re].indexes)}),se(r,l),c.follow(function(){return r.on.populate.fire(R)}).catch($)})}function Ps(r,o){Sa(r._dbSchema,o),o.db.version%10!=0||o.objectStoreNames.contains("$meta")||o.db.createObjectStore("$meta").add(Math.ceil(o.db.version/10-1),"version");var l=yr(0,r.idbdb,o);ii(r,r._dbSchema,o);for(var g=0,x=ni(l,r._dbSchema).change;g<x.length;g++){var R=($=>{if($.change.length||$.recreate)return console.warn("Unable to patch indexes of table ".concat($.name," because it has changes on the type of index or primary key.")),{value:void 0};var q=o.objectStore($.name);$.add.forEach(function(ae){Ot&&console.debug("Dexie upgrade patch: Creating missing index ".concat($.name,".").concat(ae.src)),vi(q,ae)})})(x[g]);if(typeof R=="object")return R.value}}function ni(r,o){var l,g={del:[],add:[],change:[]};for(l in r)o[l]||g.del.push(l);for(l in o){var x=r[l],R=o[l];if(x){var $={name:l,def:R,recreate:!1,del:[],add:[],change:[]};if(""+(x.primKey.keyPath||"")!=""+(R.primKey.keyPath||"")||x.primKey.auto!==R.primKey.auto)$.recreate=!0,g.change.push($);else{var q=x.idxByName,ae=R.idxByName,de=void 0;for(de in q)ae[de]||$.del.push(de);for(de in ae){var re=q[de],ee=ae[de];re?re.src!==ee.src&&$.change.push(ee):$.add.push(ee)}(0<$.del.length||0<$.add.length||0<$.change.length)&&g.change.push($)}}else g.add.push([l,R])}return g}function yi(r,o,l,g){var x=r.db.createObjectStore(o,l.keyPath?{keyPath:l.keyPath,autoIncrement:l.auto}:{autoIncrement:l.auto});g.forEach(function(R){return vi(x,R)})}function Sa(r,o){A(r).forEach(function(l){o.db.objectStoreNames.contains(l)||(Ot&&console.debug("Dexie: Creating missing table",l),yi(o,l,r[l].primKey,r[l].indexes))})}function vi(r,o){r.createIndex(o.name,o.keyPath,{unique:o.unique,multiEntry:o.multi})}function yr(r,o,l){var g={};return te(o.objectStoreNames,0).forEach(function(x){for(var R=l.objectStore(x),$=qi(an(de=R.keyPath),de||"",!0,!1,!!R.autoIncrement,de&&typeof de!="string",!0),q=[],ae=0;ae<R.indexNames.length;++ae){var re=R.index(R.indexNames[ae]),de=re.keyPath,re=qi(re.name,de,!!re.unique,!!re.multiEntry,!1,de&&typeof de!="string",!1);q.push(re)}g[x]=ti(x,$,q)}),g}function ii(r,o,l){for(var g=l.db.objectStoreNames,x=0;x<g.length;++x){var R=g[x],$=l.objectStore(R);r._hasGetAll="getAll"in $;for(var q=0;q<$.indexNames.length;++q){var ae,de=$.indexNames[q],re=$.index(de).keyPath,re=typeof re=="string"?re:"["+te(re).join("+")+"]";o[R]&&(ae=o[R].idxByName[re])&&(ae.name=de,delete o[R].idxByName[re],o[R].idxByName[de]=ae)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&_.WorkerGlobalScope&&_ instanceof _.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function zi(r){return r.split(",").map(function(o,l){var x=o.split(":"),g=(g=x[1])==null?void 0:g.trim(),x=(o=x[0].trim()).replace(/([&*]|\+\+)/g,""),R=/^\[/.test(x)?x.match(/^\[(.*)\]$/)[1].split("+"):x;return qi(x,R||null,/\&/.test(o),/\*/.test(o),/\+\+/.test(o),d(R),l===0,g)})}Zr.prototype._createTableSchema=ti,Zr.prototype._parseIndexSyntax=zi,Zr.prototype._parseStoresSpec=function(r,o){var l=this;A(r).forEach(function(g){if(r[g]!==null){var x=l._parseIndexSyntax(r[g]),R=x.shift();if(!R)throw new qe.Schema("Invalid schema for table "+g+": "+r[g]);if(R.unique=!0,R.multi)throw new qe.Schema("Primary key cannot be multiEntry*");x.forEach(function($){if($.auto)throw new qe.Schema("Only primary key can be marked as autoIncrement (++)");if(!$.keyPath)throw new qe.Schema("Index must have a name and cannot be an empty string")}),R=l._createTableSchema(g,R,x),o[g]=R}})},Zr.prototype.stores=function(l){var o=this.db,l=(this._cfg.storesSource=this._cfg.storesSource?y(this._cfg.storesSource,l):l,o._versions),g={},x={};return l.forEach(function(R){y(g,R._cfg.storesSource),x=R._cfg.dbschema={},R._parseStoresSpec(g,x)}),o._dbSchema=x,Ln(o,[o._allTables,o,o.Transaction.prototype]),it(o,[o._allTables,o,o.Transaction.prototype,this._cfg.tables],A(x),x),o._storeNames=A(x),this},Zr.prototype.upgrade=function(r){return this._cfg.contentUpgrade=lr(this._cfg.contentUpgrade||We,r),this};var Hi=Zr;function Zr(){}function bi(r,o){var l=r._dbNamesDB;return l||(l=r._dbNamesDB=new Yr(ln,{addons:[],indexedDB:r,IDBKeyRange:o})).version(1).stores({dbnames:"name"}),l.table("dbnames")}function Vr(r){return r&&typeof r.databases=="function"}function on(r){return sr(function(){return W.letThrough=!0,r()})}function _i(r){return!("from"in r)}var Vt=function(r,o){var l;if(!this)return l=new Vt,r&&"d"in r&&y(l,r),l;y(this,arguments.length?{d:1,from:r,to:1<arguments.length?o:r}:{d:0})};function sn(r,o,l){var g=xt(o,l);if(!isNaN(g)){if(0<g)throw RangeError();if(_i(r))return y(r,{from:o,to:l,d:1});var g=r.l,x=r.r;if(xt(l,r.from)<0)return g?sn(g,o,l):r.l={from:o,to:l,d:1,l:null,r:null},Rn(r);if(0<xt(o,r.to))return x?sn(x,o,l):r.r={from:o,to:l,d:1,l:null,r:null},Rn(r);xt(o,r.from)<0&&(r.from=o,r.l=null,r.d=x?x.d+1:1),0<xt(l,r.to)&&(r.to=l,r.r=null,r.d=r.l?r.l.d+1:1),o=!r.r,g&&!r.l&&Hn(r,g),x&&o&&Hn(r,x)}}function Hn(r,o){_i(o)||(function l(g,x){var R=x.from,$=x.l,q=x.r;sn(g,R,x.to),$&&l(g,$),q&&l(g,q)})(r,o)}function Gn(r,o){var l=ai(o),g=l.next();if(!g.done)for(var x=g.value,R=ai(r),$=R.next(x.from),q=$.value;!g.done&&!$.done;){if(xt(q.from,x.to)<=0&&0<=xt(q.to,x.from))return!0;xt(x.from,q.from)<0?x=(g=l.next(q.from)).value:q=($=R.next(x.from)).value}return!1}function ai(r){var o=_i(r)?null:{s:0,n:r};return{next:function(l){for(var g=0<arguments.length;o;)switch(o.s){case 0:if(o.s=1,g)for(;o.n.l&&xt(l,o.n.from)<0;)o={up:o,n:o.n.l,s:1};else for(;o.n.l;)o={up:o,n:o.n.l,s:1};case 1:if(o.s=2,!g||xt(l,o.n.to)<=0)return{value:o.n,done:!1};case 2:if(o.n.r){o.s=3,o={up:o,n:o.n.r,s:0};continue}case 3:o=o.up}return{done:!0}}}}function Rn(r){var o,l,g,x=(((x=r.r)==null?void 0:x.d)||0)-(((x=r.l)==null?void 0:x.d)||0),x=1<x?"r":x<-1?"l":"";x&&(o=x=="r"?"l":"r",l=m({},r),g=r[x],r.from=g.from,r.to=g.to,r[x]=g[x],l[x]=g[o],(r[o]=l).d=Kn(l)),r.d=Kn(r)}function Kn(l){var o=l.r,l=l.l;return(o?l?Math.max(o.d,l.d):o.d:l?l.d:0)+1}function xi(r,o){return A(o).forEach(function(l){r[l]?Hn(r[l],o[l]):r[l]=(function g(x){var R,$,q={};for(R in x)B(x,R)&&($=x[R],q[R]=!$||typeof $!="object"||Be.has($.constructor)?$:g($));return q})(o[l])}),r}function Ei(r,o){return r.all||o.all||Object.keys(r).some(function(l){return o[l]&&Gn(o[l],r[l])})}z(Vt.prototype,((tr={add:function(r){return Hn(this,r),this},addKey:function(r){return sn(this,r,r),this},addKeys:function(r){var o=this;return r.forEach(function(l){return sn(o,l,l)}),this},hasKey:function(r){var o=ai(this).next(r).value;return o&&xt(o.from,r)<=0&&0<=xt(o.to,r)}})[Ne]=function(){return ai(this)},tr));var In={},Tn={},Ai=!1;function oi(r){xi(Tn,r),Ai||(Ai=!0,setTimeout(function(){Ai=!1,Gi(Tn,!(Tn={}))},0))}function Gi(r,o){o===void 0&&(o=!1);var l=new Set;if(r.all)for(var g=0,x=Object.values(In);g<x.length;g++)Ki(q=x[g],r,l,o);else for(var R in r){var $,q,R=/^idb\:\/\/(.*)\/(.*)\//.exec(R);R&&($=R[1],R=R[2],q=In["idb://".concat($,"/").concat(R)])&&Ki(q,r,l,o)}l.forEach(function(ae){return ae()})}function Ki(r,o,l,g){for(var x=[],R=0,$=Object.entries(r.queries.query);R<$.length;R++){for(var q=$[R],ae=q[0],de=[],re=0,ee=q[1];re<ee.length;re++){var ce=ee[re];Ei(o,ce.obsSet)?ce.subscribers.forEach(function(ye){return l.add(ye)}):g&&de.push(ce)}g&&x.push([ae,de])}if(g)for(var ue=0,oe=x;ue<oe.length;ue++){var ne=oe[ue],ae=ne[0],de=ne[1];r.queries.query[ae]=de}}function Bs(r){var o=r._state,l=r._deps.indexedDB;if(o.isBeingOpened||r.idbdb)return o.dbReadyPromise.then(function(){return o.dbOpenError?_t(o.dbOpenError):r});o.isBeingOpened=!0,o.dbOpenError=null,o.openComplete=!1;var g=o.openCanceller,x=Math.round(10*r.verno),R=!1;function $(){if(o.openCanceller!==g)throw new qe.DatabaseClosed("db.open() was cancelled")}function q(){return new c(function(ce,ue){if($(),!l)throw new qe.MissingAPI;var oe=r.name,ne=o.autoSchema||!x?l.open(oe):l.open(oe,x);if(!ne)throw new qe.MissingAPI;ne.onerror=Kr(ue),ne.onblocked=lt(r._fireOnBlocked),ne.onupgradeneeded=lt(function(ye){var ve;re=ne.transaction,o.autoSchema&&!r._options.allowEmptyDB?(ne.onerror=gr,re.abort(),ne.result.close(),(ve=l.deleteDatabase(oe)).onsuccess=ve.onerror=lt(function(){ue(new qe.NoSuchDatabase("Database ".concat(oe," doesnt exist")))})):(re.onerror=Kr(ue),ve=ye.oldVersion>Math.pow(2,62)?0:ye.oldVersion,ee=ve<1,r.idbdb=ne.result,R&&Ps(r,re),zn(r,ve/10,re,ue))},ue),ne.onsuccess=lt(function(){re=null;var ye,ve,me,Pe,je,Ze,Ve=r.idbdb=ne.result,Me=te(Ve.objectStoreNames);if(0<Me.length)try{var tt=Ve.transaction((je=Me).length===1?je[0]:je,"readonly");if(o.autoSchema)Ze=Ve,Pe=tt,(me=r).verno=Ze.version/10,Pe=me._dbSchema=yr(0,Ze,Pe),me._storeNames=te(Ze.objectStoreNames,0),it(me,[me._allTables],A(Pe),Pe);else if(ii(r,r._dbSchema,tt),ve=tt,((ve=ni(yr(0,(ye=r).idbdb,ve),ye._dbSchema)).add.length||ve.change.some(function(et){return et.add.length||et.change.length}))&&!R)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ve.close(),x=Ve.version+1,R=!0,ce(q());se(r,tt)}catch{}Lr.push(r),Ve.onversionchange=lt(function(et){o.vcFired=!0,r.on("versionchange").fire(et)}),Ve.onclose=lt(function(){r.close({disableAutoOpen:!1})}),ee&&(Me=r._deps,je=oe,Vr(Ze=Me.indexedDB)||je===ln||bi(Ze,Me.IDBKeyRange).put({name:je}).catch(We)),ce()},ue)}).catch(function(ce){switch(ce==null?void 0:ce.name){case"UnknownError":if(0<o.PR1398_maxLoop)return o.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),q();break;case"VersionError":if(0<x)return x=0,q()}return c.reject(ce)})}var ae,de=o.dbReadyResolve,re=null,ee=!1;return c.race([g,(typeof navigator>"u"?c.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ce){function ue(){return indexedDB.databases().finally(ce)}ae=setInterval(ue,100),ue()}).finally(function(){return clearInterval(ae)}):Promise.resolve()).then(q)]).then(function(){return $(),o.onReadyBeingFired=[],c.resolve(on(function(){return r.on.ready.fire(r.vip)})).then(function ce(){var ue;if(0<o.onReadyBeingFired.length)return ue=o.onReadyBeingFired.reduce(lr,We),o.onReadyBeingFired=[],c.resolve(on(function(){return ue(r.vip)})).then(ce)})}).finally(function(){o.openCanceller===g&&(o.onReadyBeingFired=null,o.isBeingOpened=!1)}).catch(function(ce){o.dbOpenError=ce;try{re&&re.abort()}catch{}return g===o.openCanceller&&r._close(),_t(ce)}).finally(function(){o.openComplete=!0,de()}).then(function(){var ce;return ee&&(ce={},r.tables.forEach(function(ue){ue.schema.indexes.forEach(function(oe){oe.name&&(ce["idb://".concat(r.name,"/").concat(ue.name,"/").concat(oe.name)]=new Vt(-1/0,[[[]]]))}),ce["idb://".concat(r.name,"/").concat(ue.name,"/")]=ce["idb://".concat(r.name,"/").concat(ue.name,"/:dels")]=new Vt(-1/0,[[[]]])}),mn(ei).fire(ce),Gi(ce,!0)),r})}function ki(r){function o(R){return r.next(R)}var l=x(o),g=x(function(R){return r.throw(R)});function x(R){return function(q){var q=R(q),ae=q.value;return q.done?ae:ae&&typeof ae.then=="function"?ae.then(l,g):d(ae)?Promise.all(ae).then(l,g):l(ae)}}return x(o)()}function si(r,o,l){for(var g=d(r)?r.slice():[r],x=0;x<l;++x)g.push(o);return g}var Wi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return m(m({},r),{table:function(g){var l=r.table(g),g=l.schema,x={},R=[];function $(ce,ue,oe){var me=Un(ce),ne=x[me]=x[me]||[],ye=ce==null?0:typeof ce=="string"?1:ce.length,ve=0<ue,me=m(m({},oe),{name:ve?"".concat(me,"(virtual-from:").concat(oe.name,")"):oe.name,lowLevelIndex:oe,isVirtual:ve,keyTail:ue,keyLength:ye,extractKey:Ui(ce),unique:!ve&&oe.unique});return ne.push(me),me.isPrimaryKey||R.push(me),1<ye&&$(ye===2?ce[0]:ce.slice(0,ye-1),ue+1,oe),ne.sort(function(Pe,je){return Pe.keyTail-je.keyTail}),me}var q=$(g.primaryKey.keyPath,0,g.primaryKey);x[":id"]=[q];for(var ae=0,de=g.indexes;ae<de.length;ae++){var re=de[ae];$(re.keyPath,0,re)}function ee(ce){var ue,oe=ce.query.index;return oe.isVirtual?m(m({},ce),{query:{index:oe.lowLevelIndex,range:(ue=ce.query.range,oe=oe.keyTail,{type:ue.type===1?2:ue.type,lower:si(ue.lower,ue.lowerOpen?r.MAX_KEY:r.MIN_KEY,oe),lowerOpen:!0,upper:si(ue.upper,ue.upperOpen?r.MIN_KEY:r.MAX_KEY,oe),upperOpen:!0})}}):ce}return m(m({},l),{schema:m(m({},g),{primaryKey:q,indexes:R,getIndexByKeyPath:function(ce){return(ce=x[Un(ce)])&&ce[0]}}),count:function(ce){return l.count(ee(ce))},query:function(ce){return l.query(ee(ce))},openCursor:function(ce){var ue=ce.query.index,oe=ue.keyTail,ne=ue.keyLength;return ue.isVirtual?l.openCursor(ee(ce)).then(function(ve){return ve&&ye(ve)}):l.openCursor(ce);function ye(ve){return Object.create(ve,{continue:{value:function(me){me!=null?ve.continue(si(me,ce.reverse?r.MAX_KEY:r.MIN_KEY,oe)):ce.unique?ve.continue(ve.key.slice(0,ne).concat(ce.reverse?r.MIN_KEY:r.MAX_KEY,oe)):ve.continue()}},continuePrimaryKey:{value:function(me,Pe){ve.continuePrimaryKey(si(me,r.MAX_KEY,oe),Pe)}},primaryKey:{get:function(){return ve.primaryKey}},key:{get:function(){var me=ve.key;return ne===1?me[0]:me.slice(0,ne)}},value:{get:function(){return ve.value}}})}}})}})}};function Zi(r,o,l,g){return l=l||{},g=g||"",A(r).forEach(function(x){var R,$,q;B(o,x)?(R=r[x],$=o[x],typeof R=="object"&&typeof $=="object"&&R&&$?(q=ft(R))!==ft($)?l[g+x]=o[x]:q==="Object"?Zi(R,$,l,g+x+"."):R!==$&&(l[g+x]=o[x]):R!==$&&(l[g+x]=o[x])):l[g+x]=void 0}),A(o).forEach(function(x){B(r,x)||(l[g+x]=o[x])}),l}function Vi(r,o){return o.type==="delete"?o.keys:o.keys||o.values.map(r.extractKey)}var Cs={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(r){return m(m({},r),{table:function(o){var l=r.table(o),g=l.schema.primaryKey;return m(m({},l),{mutate:function(x){var R=W.trans,$=R.table(o).hook,q=$.deleting,ae=$.creating,de=$.updating;switch(x.type){case"add":if(ae.fire===We)break;return R._promise("readwrite",function(){return re(x)},!0);case"put":if(ae.fire===We&&de.fire===We)break;return R._promise("readwrite",function(){return re(x)},!0);case"delete":if(q.fire===We)break;return R._promise("readwrite",function(){return re(x)},!0);case"deleteRange":if(q.fire===We)break;return R._promise("readwrite",function(){return(function ee(ce,ue,oe){return l.query({trans:ce,values:!1,query:{index:g,range:ue},limit:oe}).then(function(ne){var ye=ne.result;return re({type:"delete",keys:ye,trans:ce}).then(function(ve){return 0<ve.numFailures?Promise.reject(ve.failures[0]):ye.length<oe?{failures:[],numFailures:0,lastResult:void 0}:ee(ce,m(m({},ue),{lower:ye[ye.length-1],lowerOpen:!0}),oe)})})})(x.trans,x.range,1e4)},!0)}return l.mutate(x);function re(ee){var ce,ue,oe,ne=W.trans,ye=ee.keys||Vi(g,ee);if(ye)return(ee=ee.type==="add"||ee.type==="put"?m(m({},ee),{keys:ye}):m({},ee)).type!=="delete"&&(ee.values=k([],ee.values)),ee.keys&&(ee.keys=k([],ee.keys)),ce=l,oe=ye,((ue=ee).type==="add"?Promise.resolve([]):ce.getMany({trans:ue.trans,keys:oe,cache:"immutable"})).then(function(ve){var me=ye.map(function(Pe,je){var Ze,Ve,Me,tt=ve[je],et={onerror:null,onsuccess:null};return ee.type==="delete"?q.fire.call(et,Pe,tt,ne):ee.type==="add"||tt===void 0?(Ze=ae.fire.call(et,Pe,ee.values[je],ne),Pe==null&&Ze!=null&&(ee.keys[je]=Pe=Ze,g.outbound||H(ee.values[je],g.keyPath,Pe))):(Ze=Zi(tt,ee.values[je]),(Ve=de.fire.call(et,Ze,Pe,tt,ne))&&(Me=ee.values[je],Object.keys(Ve).forEach(function(ze){B(Me,ze)?Me[ze]=Ve[ze]:H(Me,ze,Ve[ze])}))),et});return l.mutate(ee).then(function(Pe){for(var je=Pe.failures,Ze=Pe.results,Ve=Pe.numFailures,Pe=Pe.lastResult,Me=0;Me<ye.length;++Me){var tt=(Ze||ye)[Me],et=me[Me];tt==null?et.onerror&&et.onerror(je[Me]):et.onsuccess&&et.onsuccess(ee.type==="put"&&ve[Me]?ee.values[Me]:tt)}return{failures:je,results:Ze,numFailures:Ve,lastResult:Pe}}).catch(function(Pe){return me.forEach(function(je){return je.onerror&&je.onerror(Pe)}),Promise.reject(Pe)})});throw new Error("Keys missing")}}})}})}};function Yi(r,o,l){try{if(!o||o.keys.length<r.length)return null;for(var g=[],x=0,R=0;x<o.keys.length&&R<r.length;++x)xt(o.keys[x],r[R])===0&&(g.push(l?Se(o.values[x]):o.values[x]),++R);return g.length===r.length?g:null}catch{return null}}var Xi={stack:"dbcore",level:-1,create:function(r){return{table:function(o){var l=r.table(o);return m(m({},l),{getMany:function(g){var x;return g.cache?(x=Yi(g.keys,g.trans._cache,g.cache==="clone"))?c.resolve(x):l.getMany(g).then(function(R){return g.trans._cache={keys:g.keys,values:g.cache==="clone"?Se(R):R},R}):l.getMany(g)},mutate:function(g){return g.type!=="add"&&(g.trans._cache=null),l.mutate(g)}})}}}};function Si(r,o){return r.trans.mode==="readonly"&&!!r.subscr&&!r.trans.explicit&&r.trans.db._options.cache!=="disabled"&&!o.schema.primaryKey.outbound}function Ra(r,o){switch(r){case"query":return o.values&&!o.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ia={stack:"dbcore",level:0,name:"Observability",create:function(r){var o=r.schema.name,l=new Vt(r.MIN_KEY,r.MAX_KEY);return m(m({},r),{transaction:function(g,x,R){if(W.subscr&&x!=="readonly")throw new qe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(W.querier));return r.transaction(g,x,R)},table:function(g){function x(ye){var ne,ye=ye.query;return[ne=ye.index,new Vt((ne=(ye=ye.range).lower)!=null?ne:r.MIN_KEY,(ne=ye.upper)!=null?ne:r.MAX_KEY)]}var R=r.table(g),$=R.schema,q=$.primaryKey,ae=$.indexes,de=q.extractKey,re=q.outbound,ee=q.autoIncrement&&ae.filter(function(oe){return oe.compound&&oe.keyPath.includes(q.keyPath)}),ce=m(m({},R),{mutate:function(oe){function ne(nt){return nt="idb://".concat(o,"/").concat(g,"/").concat(nt),je[nt]||(je[nt]=new Vt)}var ye,ve,me,Pe=oe.trans,je=oe.mutatedParts||(oe.mutatedParts={}),Ze=ne(""),Ve=ne(":dels"),Me=oe.type,et=oe.type==="deleteRange"?[oe.range]:oe.type==="delete"?[oe.keys]:oe.values.length<50?[Vi(q,oe).filter(function(nt){return nt}),oe.values]:[],tt=et[0],et=et[1],ze=oe.trans._cache;return d(tt)?(Ze.addKeys(tt),(Me=Me==="delete"||tt.length===et.length?Yi(tt,ze):null)||Ve.addKeys(tt),(Me||et)&&(ye=ne,ve=Me,me=et,$.indexes.forEach(function(nt){var Tt=ye(nt.name||"");function $t(St){return St!=null?nt.extractKey(St):null}function wt(St){nt.multiEntry&&d(St)?St.forEach(function(Qt){return Tt.addKey(Qt)}):Tt.addKey(St)}(ve||me).forEach(function(St,ar){var Br=ve&&$t(ve[ar]),ar=me&&$t(me[ar]);xt(Br,ar)!==0&&(Br!=null&&wt(Br),ar!=null)&&wt(ar)})}))):tt?(et={from:(ze=tt.lower)!=null?ze:r.MIN_KEY,to:(Me=tt.upper)!=null?Me:r.MAX_KEY},Ve.add(et),Ze.add(et)):(Ze.add(l),Ve.add(l),$.indexes.forEach(function(nt){return ne(nt.name).add(l)})),R.mutate(oe).then(function(nt){return!tt||oe.type!=="add"&&oe.type!=="put"||(Ze.addKeys(nt.results),ee&&ee.forEach(function(Tt){for(var $t=oe.values.map(function(Br){return Tt.extractKey(Br)}),wt=Tt.keyPath.findIndex(function(Br){return Br===q.keyPath}),St=0,Qt=nt.results.length;St<Qt;++St)$t[St][wt]=nt.results[St];ne(Tt.name).addKeys($t)})),Pe.mutatedParts=xi(Pe.mutatedParts||{},je),nt})}}),ue={get:function(oe){return[q,new Vt(oe.key)]},getMany:function(oe){return[q,new Vt().addKeys(oe.keys)]},count:x,query:x,openCursor:x};return A(ue).forEach(function(oe){ce[oe]=function(ne){var ye=W.subscr,ve=!!ye,me=Si(W,R)&&Ra(oe,ne)?ne.obsSet={}:ye;if(ve){var Pe,ye=function(et){return et="idb://".concat(o,"/").concat(g,"/").concat(et),me[et]||(me[et]=new Vt)},je=ye(""),Ze=ye(":dels"),ve=ue[oe](ne),Ve=ve[0],ve=ve[1];if((oe==="query"&&Ve.isPrimaryKey&&!ne.values?Ze:ye(Ve.name||"")).add(ve),!Ve.isPrimaryKey){if(oe!=="count")return Pe=oe==="query"&&re&&ne.values&&R.query(m(m({},ne),{values:!1})),R[oe].apply(this,arguments).then(function(et){if(oe==="query"){if(re&&ne.values)return Pe.then(function($t){return $t=$t.result,je.addKeys($t),et});var ze=ne.values?et.result.map(de):et.result;(ne.values?je:Ze).addKeys(ze)}else{var nt,Tt;if(oe==="openCursor")return Tt=ne.values,(nt=et)&&Object.create(nt,{key:{get:function(){return Ze.addKey(nt.primaryKey),nt.key}},primaryKey:{get:function(){var $t=nt.primaryKey;return Ze.addKey($t),$t}},value:{get:function(){return Tt&&je.addKey(nt.primaryKey),nt.value}}})}return et});Ze.add(l)}}return R[oe].apply(this,arguments)}}),ce}})}};function Ta(r,o,l){var g;return l.numFailures===0?o:o.type==="deleteRange"||(g=o.keys?o.keys.length:"values"in o&&o.values?o.values.length:1,l.numFailures===g)?null:(g=m({},o),d(g.keys)&&(g.keys=g.keys.filter(function(x,R){return!(R in l.failures)})),"values"in g&&d(g.values)&&(g.values=g.values.filter(function(x,R){return!(R in l.failures)})),g)}function Ji(r,o){return l=r,((g=o).lower===void 0||(g.lowerOpen?0<xt(l,g.lower):0<=xt(l,g.lower)))&&(l=r,(g=o).upper===void 0||(g.upperOpen?xt(l,g.upper)<0:xt(l,g.upper)<=0));var l,g}function Ri(r,o,l,g,x,R){var $,q,ae,de,re,ee;return!l||l.length===0||($=o.query.index,q=$.multiEntry,ae=o.query.range,de=g.schema.primaryKey.extractKey,re=$.extractKey,ee=($.lowLevelIndex||$).extractKey,(g=l.reduce(function(ce,ue){var oe=ce,ne=[];if(ue.type==="add"||ue.type==="put")for(var ye=new Vt,ve=ue.values.length-1;0<=ve;--ve){var me,Pe=ue.values[ve],je=de(Pe);!ye.hasKey(je)&&(me=re(Pe),q&&d(me)?me.some(function(et){return Ji(et,ae)}):Ji(me,ae))&&(ye.addKey(je),ne.push(Pe))}switch(ue.type){case"add":var Ze=new Vt().addKeys(o.values?ce.map(function(ze){return de(ze)}):ce),oe=ce.concat(o.values?ne.filter(function(ze){return ze=de(ze),!Ze.hasKey(ze)&&(Ze.addKey(ze),!0)}):ne.map(function(ze){return de(ze)}).filter(function(ze){return!Ze.hasKey(ze)&&(Ze.addKey(ze),!0)}));break;case"put":var Ve=new Vt().addKeys(ue.values.map(function(ze){return de(ze)}));oe=ce.filter(function(ze){return!Ve.hasKey(o.values?de(ze):ze)}).concat(o.values?ne:ne.map(function(ze){return de(ze)}));break;case"delete":var Me=new Vt().addKeys(ue.keys);oe=ce.filter(function(ze){return!Me.hasKey(o.values?de(ze):ze)});break;case"deleteRange":var tt=ue.range;oe=ce.filter(function(ze){return!Ji(de(ze),tt)})}return oe},r))===r)?r:(g.sort(function(ce,ue){return xt(ee(ce),ee(ue))||xt(de(ce),de(ue))}),o.limit&&o.limit<1/0&&(g.length>o.limit?g.length=o.limit:r.length===o.limit&&g.length<o.limit&&(x.dirty=!0)),R?Object.freeze(g):g)}function On(r,o){return xt(r.lower,o.lower)===0&&xt(r.upper,o.upper)===0&&!!r.lowerOpen==!!o.lowerOpen&&!!r.upperOpen==!!o.upperOpen}function $s(r,o){return((l,g,x,R)=>{if(l===void 0)return g!==void 0?-1:0;if(g===void 0)return 1;if((l=xt(l,g))===0){if(x&&R)return 0;if(x)return 1;if(R)return-1}return l})(r.lower,o.lower,r.lowerOpen,o.lowerOpen)<=0&&0<=((l,g,x,R)=>{if(l===void 0)return g!==void 0?1:0;if(g===void 0)return-1;if((l=xt(l,g))===0){if(x&&R)return 0;if(x)return-1;if(R)return 1}return l})(r.upper,o.upper,r.upperOpen,o.upperOpen)}function Fs(r,o,l,g){r.subscribers.add(l),g.addEventListener("abort",function(){var x,R;r.subscribers.delete(l),r.subscribers.size===0&&(x=r,R=o,setTimeout(function(){x.subscribers.size===0&&Fe(R,x)},3e3))})}var Oa={stack:"dbcore",level:0,name:"Cache",create:function(r){var o=r.schema.name;return m(m({},r),{transaction:function(l,g,x){var R,$,q=r.transaction(l,g,x);return g==="readwrite"&&(x=(R=new AbortController).signal,q.addEventListener("abort",($=function(ae){return function(){if(R.abort(),g==="readwrite"){for(var de=new Set,re=0,ee=l;re<ee.length;re++){var ce=ee[re],ue=In["idb://".concat(o,"/").concat(ce)];if(ue){var oe=r.table(ce),ne=ue.optimisticOps.filter(function(nt){return nt.trans===q});if(q._explicit&&ae&&q.mutatedParts)for(var ye=0,ve=Object.values(ue.queries.query);ye<ve.length;ye++)for(var me=0,Pe=(Ve=ve[ye]).slice();me<Pe.length;me++)Ei((Me=Pe[me]).obsSet,q.mutatedParts)&&(Fe(Ve,Me),Me.subscribers.forEach(function(nt){return de.add(nt)}));else if(0<ne.length){ue.optimisticOps=ue.optimisticOps.filter(function(nt){return nt.trans!==q});for(var je=0,Ze=Object.values(ue.queries.query);je<Ze.length;je++)for(var Ve,Me,tt,et=0,ze=(Ve=Ze[je]).slice();et<ze.length;et++)(Me=ze[et]).res!=null&&q.mutatedParts&&(ae&&!Me.dirty?(tt=Object.isFrozen(Me.res),tt=Ri(Me.res,Me.req,ne,oe,Me,tt),Me.dirty?(Fe(Ve,Me),Me.subscribers.forEach(function(nt){return de.add(nt)})):tt!==Me.res&&(Me.res=tt,Me.promise=c.resolve({result:tt}))):(Me.dirty&&Fe(Ve,Me),Me.subscribers.forEach(function(nt){return de.add(nt)})))}}}de.forEach(function(nt){return nt()})}}})(!1),{signal:x}),q.addEventListener("error",$(!1),{signal:x}),q.addEventListener("complete",$(!0),{signal:x})),q},table:function(l){var g=r.table(l),x=g.schema.primaryKey;return m(m({},g),{mutate:function(R){var $,q=W.trans;return!x.outbound&&q.db._options.cache!=="disabled"&&!q.explicit&&q.idbtrans.mode==="readwrite"&&($=In["idb://".concat(o,"/").concat(l)])?(q=g.mutate(R),R.type!=="add"&&R.type!=="put"||!(50<=R.values.length||Vi(x,R).some(function(ae){return ae==null}))?($.optimisticOps.push(R),R.mutatedParts&&oi(R.mutatedParts),q.then(function(ae){0<ae.numFailures&&(Fe($.optimisticOps,R),(ae=Ta(0,R,ae))&&$.optimisticOps.push(ae),R.mutatedParts)&&oi(R.mutatedParts)}),q.catch(function(){Fe($.optimisticOps,R),R.mutatedParts&&oi(R.mutatedParts)})):q.then(function(ae){var de=Ta(0,m(m({},R),{values:R.values.map(function(re,ee){var ce;return ae.failures[ee]?re:(H(ce=(ce=x.keyPath)!=null&&ce.includes(".")?Se(re):m({},re),x.keyPath,ae.results[ee]),ce)})}),ae);$.optimisticOps.push(de),queueMicrotask(function(){return R.mutatedParts&&oi(R.mutatedParts)})}),q):g.mutate(R)},query:function(R){var $,q,ae,de,re,ee,ce;return Si(W,g)&&Ra("query",R)?($=((ae=W.trans)==null?void 0:ae.db._options.cache)==="immutable",q=(ae=W).requery,ae=ae.signal,ee=((ue,oe,ne,ye)=>{var ve=In["idb://".concat(ue,"/").concat(oe)];if(!ve)return[];if(!(ue=ve.queries[ne]))return[null,!1,ve,null];var me=ue[(ye.query?ye.query.index.name:null)||""];if(!me)return[null,!1,ve,null];switch(ne){case"query":var Pe=me.find(function(je){return je.req.limit===ye.limit&&je.req.values===ye.values&&On(je.req.query.range,ye.query.range)});return Pe?[Pe,!0,ve,me]:[me.find(function(je){return("limit"in je.req?je.req.limit:1/0)>=ye.limit&&(!ye.values||je.req.values)&&$s(je.req.query.range,ye.query.range)}),!1,ve,me];case"count":return Pe=me.find(function(je){return On(je.req.query.range,ye.query.range)}),[Pe,!!Pe,ve,me]}})(o,l,"query",R),ce=ee[0],de=ee[2],re=ee[3],ce&&ee[1]?ce.obsSet=R.obsSet:(ee=g.query(R).then(function(ue){var oe=ue.result;if(ce&&(ce.res=oe),$){for(var ne=0,ye=oe.length;ne<ye;++ne)Object.freeze(oe[ne]);Object.freeze(oe)}else ue.result=Se(oe);return ue}).catch(function(ue){return re&&ce&&Fe(re,ce),Promise.reject(ue)}),ce={obsSet:R.obsSet,promise:ee,subscribers:new Set,type:"query",req:R,dirty:!1},re?re.push(ce):(re=[ce],(de=de||(In["idb://".concat(o,"/").concat(l)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[R.query.index.name||""]=re)),Fs(ce,re,q,ae),ce.promise.then(function(ue){return{result:Ri(ue.result,R,de==null?void 0:de.optimisticOps,g,ce,$)}})):g.query(R)}})}})}};function ci(r,o){return new Proxy(r,{get:function(l,g,x){return g==="db"?o:Reflect.get(l,g,x)}})}nr.prototype.version=function(r){if(isNaN(r)||r<.1)throw new qe.Type("Given version is not a positive number");if(r=Math.round(10*r)/10,this.idbdb||this._state.isBeingOpened)throw new qe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var o=this._versions,l=o.filter(function(g){return g._cfg.version===r})[0];return l||(l=new this.Version(r),o.push(l),o.sort(ka),l.stores({}),this._state.autoSchema=!1),l},nr.prototype._whenReady=function(r){var o=this;return this.idbdb&&(this._state.openComplete||W.letThrough||this._vip)?r():new c(function(l,g){if(o._state.openComplete)return g(new qe.DatabaseClosed(o._state.dbOpenError));if(!o._state.isBeingOpened){if(!o._state.autoOpen)return void g(new qe.DatabaseClosed);o.open().catch(We)}o._state.dbReadyPromise.then(l,g)}).then(r)},nr.prototype.use=function(x){var o=x.stack,l=x.create,g=x.level,x=x.name,R=(x&&this.unuse({stack:o,name:x}),this._middlewares[o]||(this._middlewares[o]=[]));return R.push({stack:o,create:l,level:g??10,name:x}),R.sort(function($,q){return $.level-q.level}),this},nr.prototype.unuse=function(r){var o=r.stack,l=r.name,g=r.create;return o&&this._middlewares[o]&&(this._middlewares[o]=this._middlewares[o].filter(function(x){return g?x.create!==g:!!l&&x.name!==l})),this},nr.prototype.open=function(){var r=this;return xn(Z,function(){return Bs(r)})},nr.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var r=this._state,o=Lr.indexOf(this);if(0<=o&&Lr.splice(o,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new c(function(l){r.dbReadyResolve=l}),r.openCanceller=new c(function(l,g){r.cancelOpen=g}))},nr.prototype.close=function(o){var o=(o===void 0?{disableAutoOpen:!0}:o).disableAutoOpen,l=this._state;o?(l.isBeingOpened&&l.cancelOpen(new qe.DatabaseClosed),this._close(),l.autoOpen=!1,l.dbOpenError=new qe.DatabaseClosed):(this._close(),l.autoOpen=this._options.autoOpen||l.isBeingOpened,l.openComplete=!1,l.dbOpenError=null)},nr.prototype.delete=function(r){var o=this,l=(r===void 0&&(r={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),g=this._state;return new c(function(x,R){function $(){o.close(r);var q=o._deps.indexedDB.deleteDatabase(o.name);q.onsuccess=lt(function(){var ae,de,re;ae=o._deps,de=o.name,Vr(re=ae.indexedDB)||de===ln||bi(re,ae.IDBKeyRange).delete(de).catch(We),x()}),q.onerror=Kr(R),q.onblocked=o._fireOnBlocked}if(l)throw new qe.InvalidArgument("Invalid closeOptions argument to db.delete()");g.isBeingOpened?g.dbReadyPromise.then($):$()})},nr.prototype.backendDB=function(){return this.idbdb},nr.prototype.isOpen=function(){return this.idbdb!==null},nr.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},nr.prototype.hasFailed=function(){return this._state.dbOpenError!==null},nr.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(nr.prototype,"tables",{get:function(){var r=this;return A(this._allTables).map(function(o){return r._allTables[o]})},enumerable:!1,configurable:!0}),nr.prototype.transaction=function(){var r=(function(o,l,g){var x=arguments.length;if(x<2)throw new qe.InvalidArgument("Too few arguments");for(var R=new Array(x-1);--x;)R[x-1]=arguments[x];return g=R.pop(),[o,pe(R),g]}).apply(this,arguments);return this._transaction.apply(this,r)},nr.prototype._transaction=function(r,o,l){var g,x,R=this,$=W.trans,q=($&&$.db===this&&r.indexOf("!")===-1||($=null),r.indexOf("?")!==-1);r=r.replace("!","").replace("?","");try{if(x=o.map(function(de){if(de=de instanceof R.Table?de.name:de,typeof de!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return de}),r=="r"||r===En)g=En;else{if(r!="rw"&&r!=An)throw new qe.InvalidArgument("Invalid transaction mode: "+r);g=An}if($){if($.mode===En&&g===An){if(!q)throw new qe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");$=null}$&&x.forEach(function(de){if($&&$.storeNames.indexOf(de)===-1){if(!q)throw new qe.SubTransaction("Table "+de+" not included in parent transaction.");$=null}}),q&&$&&!$.active&&($=null)}}catch(de){return $?$._promise(null,function(re,ee){ee(de)}):_t(de)}var ae=(function de(re,ee,ce,ue,oe){return c.resolve().then(function(){var me=W.transless||W,ne=re._createTransaction(ee,ce,re._dbSchema,ue),me=(ne.explicit=!0,{trans:ne,transless:me});if(ue)ne.idbtrans=ue.idbtrans;else try{ne.create(),ne.idbtrans._explicit=!0,re._state.PR1398_maxLoop=3}catch(Pe){return Pe.name===ht.InvalidState&&re.isOpen()&&0<--re._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),re.close({disableAutoOpen:!1}),re.open().then(function(){return de(re,ee,ce,null,oe)})):_t(Pe)}var ye,ve=pt(oe),me=(ve&&Xt(),c.follow(function(){var Pe;(ye=oe.call(ne,ne))&&(ve?(Pe=dr.bind(null,null),ye.then(Pe,Pe)):typeof ye.next=="function"&&typeof ye.throw=="function"&&(ye=ki(ye)))},me));return(ye&&typeof ye.then=="function"?c.resolve(ye).then(function(Pe){return ne.active?Pe:_t(new qe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):me.then(function(){return ye})).then(function(Pe){return ue&&ne._resolve(),ne._completion.then(function(){return Pe})}).catch(function(Pe){return ne._reject(Pe),_t(Pe)})})}).bind(null,this,g,x,$,l);return $?$._promise(g,ae,"lock"):W.trans?xn(W.transless,function(){return R._whenReady(ae)}):this._whenReady(ae)},nr.prototype.table=function(r){if(B(this._allTables,r))return this._allTables[r];throw new qe.InvalidTable("Table ".concat(r," does not exist"))};var Yr=nr;function nr(r,o){var l,g,x,R,$,q=this,ae=(this._middlewares={},this.verno=0,nr.dependencies),ae=(this._options=o=m({addons:nr.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},o),this._deps={indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange},o.addons),de=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:We,dbReadyPromise:null,cancelOpen:We,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:o.autoOpen}),re=(de.dbReadyPromise=new c(function(ee){de.dbReadyResolve=ee}),de.openCanceller=new c(function(ee,ce){de.cancelOpen=ce}),this._state=de,this.name=r,this.on=$r(this,"populate","blocked","versionchange","close",{ready:[lr,We]}),this.once=function(ee,ce){var ue=function(){for(var oe=[],ne=0;ne<arguments.length;ne++)oe[ne]=arguments[ne];q.on(ee).unsubscribe(ue),ce.apply(q,oe)};return q.on(ee,ue)},this.on.ready.subscribe=Q(this.on.ready.subscribe,function(ee){return function(ce,ue){nr.vip(function(){var oe,ne=q._state;ne.openComplete?(ne.dbOpenError||c.resolve().then(ce),ue&&ee(ce)):ne.onReadyBeingFired?(ne.onReadyBeingFired.push(ce),ue&&ee(ce)):(ee(ce),oe=q,ue||ee(function ye(){oe.on.ready.unsubscribe(ce),oe.on.ready.unsubscribe(ye)}))})}}),this.Collection=(l=this,rn(Os.prototype,function(ye,ne){this.db=l;var ue=Dn,oe=null;if(ne)try{ue=ne()}catch(me){oe=me}var ne=ye._ctx,ye=ne.table,ve=ye.hook.reading.fire;this._ctx={table:ye,index:ne.index,isPrimKey:!ne.index||ye.schema.primKey.keyPath&&ne.index===ye.schema.primKey.name,range:ue,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:oe,or:ne.or,valueMapper:ve!==vt?ve:null}})),this.Table=(g=this,rn(fn.prototype,function(ee,ce,ue){this.db=g,this._tx=ue,this.name=ee,this.schema=ce,this.hook=g._allTables[ee]?g._allTables[ee].hook:$r(null,{creating:[Bt,We],reading:[Ht,vt],updating:[bt,We],deleting:[_e,We]})})),this.Transaction=(x=this,rn(xa.prototype,function(ee,ce,ue,oe,ne){var ye=this;ee!=="readonly"&&ce.forEach(function(ve){ve=(ve=ue[ve])==null?void 0:ve.yProps,ve&&(ce=ce.concat(ve.map(function(me){return me.updatesTable})))}),this.db=x,this.mode=ee,this.storeNames=ce,this.schema=ue,this.chromeTransactionDurability=oe,this.idbtrans=null,this.on=$r(this,"complete","error","abort"),this.parent=ne||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new c(function(ve,me){ye._resolve=ve,ye._reject=me}),this._completion.then(function(){ye.active=!1,ye.on.complete.fire()},function(ve){var me=ye.active;return ye.active=!1,ye.on.error.fire(ve),ye.parent?ye.parent._reject(ve):me&&ye.idbtrans&&ye.idbtrans.abort(),_t(ve)})})),this.Version=(R=this,rn(Hi.prototype,function(ee){this.db=R,this._cfg={version:ee,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=($=this,rn(Zt.prototype,function(ee,ce,ue){if(this.db=$,this._ctx={table:ee,index:ce===":id"?null:ce,or:ue},this._cmp=this._ascending=xt,this._descending=function(oe,ne){return xt(ne,oe)},this._max=function(oe,ne){return 0<xt(oe,ne)?oe:ne},this._min=function(oe,ne){return xt(oe,ne)<0?oe:ne},this._IDBKeyRange=$._deps.IDBKeyRange,!this._IDBKeyRange)throw new qe.MissingAPI})),this.on("versionchange",function(ee){0<ee.newVersion?console.warn("Another connection wants to upgrade database '".concat(q.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(q.name,"'. Closing db now to resume the delete request.")),q.close({disableAutoOpen:!1})}),this.on("blocked",function(ee){!ee.newVersion||ee.newVersion<ee.oldVersion?console.warn("Dexie.delete('".concat(q.name,"') was blocked")):console.warn("Upgrade '".concat(q.name,"' blocked by other connection holding version ").concat(ee.oldVersion/10))}),this._maxKey=ri(o.IDBKeyRange),this._createTransaction=function(ee,ce,ue,oe){return new q.Transaction(ee,ce,ue,q._options.chromeTransactionDurability,oe)},this._fireOnBlocked=function(ee){q.on("blocked").fire(ee),Lr.filter(function(ce){return ce.name===q.name&&ce!==q&&!ce._state.vcFired}).map(function(ce){return ce.on("versionchange").fire(ee)})},this.use(Xi),this.use(Oa),this.use(Ia),this.use(Wi),this.use(Cs),new Proxy(this,{get:function(ee,ce,ue){var oe;return ce==="_vip"||(ce==="table"?function(ne){return ci(q.table(ne),re)}:(oe=Reflect.get(ee,ce,ue))instanceof fn?ci(oe,re):ce==="tables"?oe.map(function(ne){return ci(ne,re)}):ce==="_createTransaction"?function(){return ci(oe.apply(this,arguments),re)}:oe)}}));this.vip=re,ae.forEach(function(ee){return ee(q)})}var Ii,Fr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wn=(Qi.prototype.subscribe=function(r,o,l){return this._subscribe(r&&typeof r!="function"?r:{next:r,error:o,complete:l})},Qi.prototype[Fr]=function(){return this},Qi);function Qi(r){this._subscribe=r}try{Ii={indexedDB:_.indexedDB||_.mozIndexedDB||_.webkitIndexedDB||_.msIndexedDB,IDBKeyRange:_.IDBKeyRange||_.webkitIDBKeyRange}}catch{Ii={indexedDB:null,IDBKeyRange:null}}function ea(r){var o,l=!1,g=new wn(function(x){var R=pt(r),$,q=!1,ae={},de={},re={get closed(){return q},unsubscribe:function(){q||(q=!0,$&&$.abort(),ee&&mn.storagemutated.unsubscribe(ue))}},ee=(x.start&&x.start(re),!1),ce=function(){return Mi(oe)},ue=function(ne){xi(ae,ne),Ei(de,ae)&&ce()},oe=function(){var ne,ye,ve;!q&&Ii.indexedDB&&(ae={},ne={},$&&$.abort(),$=new AbortController,ve=(me=>{var Pe=Ge();try{R&&Xt();var je=sr(r,me);return je=R?je.finally(dr):je}finally{Pe&&yt()}})(ye={subscr:ne,signal:$.signal,requery:ce,querier:r,trans:null}),Promise.resolve(ve).then(function(me){l=!0,o=me,q||ye.signal.aborted||(ae={},(Pe=>{for(var je in Pe)if(B(Pe,je))return;return 1})(de=ne)||ee||(mn(ei,ue),ee=!0),Mi(function(){return!q&&x.next&&x.next(me)}))},function(me){l=!1,["DatabaseClosedError","AbortError"].includes(me==null?void 0:me.name)||q||Mi(function(){q||x.error&&x.error(me)})}))};return setTimeout(ce,0),re});return g.hasValue=function(){return l},g.getValue=function(){return o},g}var Nr=Yr;function Wn(r){var o=Xr;try{Xr=!0,mn.storagemutated.fire(r),Gi(r,!0)}finally{Xr=o}}z(Nr,m(m({},gt),{delete:function(r){return new Nr(r,{addons:[]}).delete()},exists:function(r){return new Nr(r,{addons:[]}).open().then(function(o){return o.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(r){try{return o=Nr.dependencies,l=o.indexedDB,o=o.IDBKeyRange,(Vr(l)?Promise.resolve(l.databases()).then(function(g){return g.map(function(x){return x.name}).filter(function(x){return x!==ln})}):bi(l,o).toCollection().primaryKeys()).then(r)}catch{return _t(new qe.MissingAPI)}var o,l},defineClass:function(){return function(r){y(this,r)}},ignoreTransaction:function(r){return W.trans?xn(W.transless,r):r()},vip:on,async:function(r){return function(){try{var o=ki(r.apply(this,arguments));return o&&typeof o.then=="function"?o:c.resolve(o)}catch(l){return _t(l)}}},spawn:function(r,o,l){try{var g=ki(r.apply(l,o||[]));return g&&typeof g.then=="function"?g:c.resolve(g)}catch(x){return _t(x)}},currentTransaction:{get:function(){return W.trans||null}},waitFor:function(r,o){return r=c.resolve(typeof r=="function"?Nr.ignoreTransaction(r):r).timeout(o||6e4),W.trans?W.trans.waitFor(r):r},Promise:c,debug:{get:function(){return Ot},set:function(r){Ft(r)}},derive:we,extend:y,props:z,override:Q,Events:$r,on:mn,liveQuery:ea,extendObservabilitySet:xi,getByKeyPath:le,setByKeyPath:H,delByKeyPath:function(r,o){typeof o=="string"?H(r,o,void 0):"length"in o&&[].map.call(o,function(l){H(r,l,void 0)})},shallowClone:fe,deepClone:Se,getObjectDiff:Zi,cmp:xt,asap:Te,minKey:-1/0,addons:[],connections:Lr,errnames:ht,dependencies:Ii,cache:In,semVer:"4.3.0",version:"4.3.0".split(".").map(function(r){return parseInt(r)}).reduce(function(r,o,l){return r+o/Math.pow(10,2*l)})})),Nr.maxKey=ri(Nr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(mn(ei,function(r){Xr||(r=new CustomEvent(pn,{detail:r}),Xr=!0,dispatchEvent(r),Xr=!1)}),addEventListener(pn,function(r){r=r.detail,Xr||Wn(r)}));var Pn,Xr=!1,ir=function(){};return typeof BroadcastChannel<"u"&&((ir=function(){(Pn=new BroadcastChannel(pn)).onmessage=function(r){return r.data&&Wn(r.data)}})(),typeof Pn.unref=="function"&&Pn.unref(),mn(ei,function(r){Xr||Pn.postMessage(r)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(r){if(!Yr.disableBfCache&&r.persisted){Ot&&console.debug("Dexie: handling persisted pagehide"),Pn!=null&&Pn.close();for(var o=0,l=Lr;o<l.length;o++)l[o].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(r){!Yr.disableBfCache&&r.persisted&&(Ot&&console.debug("Dexie: handling persisted pageshow"),ir(),Wn({all:new Vt(-1/0,[[]])}))})),c.rejectionMapper=function(r,o){return!r||r instanceof Lt||r instanceof TypeError||r instanceof SyntaxError||!r.name||!It[r.name]?r:(o=new It[r.name](o||r.message,r),"stack"in r&&V(o,"stack",{get:function(){return this.inner.stack}}),o)},Ft(Ot),m(Yr,Object.freeze({__proto__:null,Dexie:Yr,Entity:tn,PropModification:cr,RangeSet:Vt,add:function(r){return new cr({add:r})},cmp:xt,default:Yr,liveQuery:ea,mergeRanges:Hn,rangesOverlap:Gn,remove:function(r){return new cr({remove:r})},replacePrefix:function(r,o){return new cr({replacePrefix:[r,o]})}}),{default:Yr}),Yr})})(aa)),aa.exports}var If=Rf();const $a=Ca(If),Hs=Symbol.for("Dexie"),oa=globalThis[Hs]||(globalThis[Hs]=$a);if($a.semVer!==oa.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${$a.semVer} and ${oa.semVer}`);const{liveQuery:ap,mergeRanges:op,rangesOverlap:sp,RangeSet:cp,cmp:up,Entity:lp,PropModification:fp,replacePrefix:hp,add:dp,remove:pp,DexieYProvider:mp}=oa;class Tf extends oa{constructor(){super("contextgit-meta");Oi(this,"repos");Oi(this,"issues");Oi(this,"pullRequests");this.version(1).stores({repos:"id, name, created"}),this.version(2).stores({repos:"id, name, created",issues:"id, repoId, status, assignedPlatform, createdAt",pullRequests:"id, repoId, issueId, status, createdAt"})}}const er=new Tf;function Gs(){return crypto.randomUUID().replace(/-/g,"").slice(0,12)}var Je={},Fa,Ks;function Of(){if(Ks)return Fa;Ks=1;var f=function(u){if(u=u||{},this.Promise=u.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=u.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=u.timeout||f.DEFAULT_TIMEOUT,this.maxOccupationTime=u.maxOccupationTime||f.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=u.maxExecutionTime||f.DEFAULT_MAX_EXECUTION_TIME,u.maxPending===1/0||Number.isInteger(u.maxPending)&&u.maxPending>=0?this.maxPending=u.maxPending:this.maxPending=f.DEFAULT_MAX_PENDING};return f.DEFAULT_TIMEOUT=0,f.DEFAULT_MAX_OCCUPATION_TIME=0,f.DEFAULT_MAX_EXECUTION_TIME=0,f.DEFAULT_MAX_PENDING=1e3,f.prototype.acquire=function(u,w,m,k){if(Array.isArray(u))return this._acquireBatch(u,w,m,k);if(typeof w!="function")throw new Error("You must pass a function to execute");var _=null,A=null,d=null;typeof m!="function"&&(k=m,m=null,d=new this.Promise(function(Q,ge){_=Q,A=ge})),k=k||{};var y=!1,F=null,D=null,B=null,z=this,j=function(Q,ge,Te){D&&(clearTimeout(D),D=null),B&&(clearTimeout(B),B=null),Q&&(z.queues[u]&&z.queues[u].length===0&&delete z.queues[u],z.domainReentrant&&delete z.domains[u]),y||(d?ge?A(ge):_(Te):typeof m=="function"&&m(ge,Te),y=!0),Q&&z.queues[u]&&z.queues[u].length>0&&z.queues[u].shift()()},V=function(Q){if(y)return j(Q);F&&(clearTimeout(F),F=null),z.domainReentrant&&Q&&(z.domains[u]=process.domain);var ge=k.maxExecutionTime||z.maxExecutionTime;if(ge&&(B=setTimeout(function(){z.queues[u]&&j(Q,new Error("Maximum execution time is exceeded "+u))},ge)),w.length===1){var Te=!1;try{w(function(le,H){Te||(Te=!0,j(Q,le,H))})}catch(le){Te||(Te=!0,j(Q,le))}}else z._promiseTry(function(){return w()}).then(function(le){j(Q,void 0,le)},function(le){j(Q,le)})};z.domainReentrant&&process.domain&&(V=process.domain.bind(V));var we=k.maxPending||z.maxPending;if(!z.queues[u])z.queues[u]=[],V(!0);else if(z.domainReentrant&&process.domain&&process.domain===z.domains[u])V(!1);else if(z.queues[u].length>=we)j(!1,new Error("Too many pending tasks in queue "+u));else{var ie=function(){V(!0)};k.skipQueue?z.queues[u].unshift(ie):z.queues[u].push(ie);var K=k.timeout||z.timeout;K&&(F=setTimeout(function(){F=null,j(!1,new Error("async-lock timed out in queue "+u))},K))}var te=k.maxOccupationTime||z.maxOccupationTime;if(te&&(D=setTimeout(function(){z.queues[u]&&j(!1,new Error("Maximum occupation time is exceeded in queue "+u))},te)),d)return d},f.prototype._acquireBatch=function(u,w,m,k){typeof m!="function"&&(k=m,m=null);var _=this,A=function(y,F){return function(D){_.acquire(y,F,D,k)}},d=u.reduceRight(function(y,F){return A(F,y)},w);if(typeof m=="function")d(m);else return new this.Promise(function(y,F){d.length===1?d(function(D,B){D?F(D):y(B)}):y(d())})},f.prototype.isBusy=function(u){return u?!!this.queues[u]:Object.keys(this.queues).length>0},f.prototype._promiseTry=function(u){try{return this.Promise.resolve(u())}catch(w){return this.Promise.reject(w)}},Fa=f,Fa}var Da,Ws;function Pf(){return Ws||(Ws=1,Da=Of()),Da}var sa={exports:{}},Zs;function Bf(){return Zs||(Zs=1,typeof Object.create=="function"?sa.exports=function(u,w){w&&(u.super_=w,u.prototype=Object.create(w.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}))}:sa.exports=function(u,w){if(w){u.super_=w;var m=function(){};m.prototype=w.prototype,u.prototype=new m,u.prototype.constructor=u}}),sa.exports}var ca={exports:{}},Na={},Bi={},Vs;function Cf(){if(Vs)return Bi;Vs=1,Bi.byteLength=d,Bi.toByteArray=F,Bi.fromByteArray=z;for(var f=[],u=[],w=typeof Uint8Array<"u"?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=0,_=m.length;k<_;++k)f[k]=m[k],u[m.charCodeAt(k)]=k;u[45]=62,u[95]=63;function A(j){var V=j.length;if(V%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var we=j.indexOf("=");we===-1&&(we=V);var ie=we===V?0:4-we%4;return[we,ie]}function d(j){var V=A(j),we=V[0],ie=V[1];return(we+ie)*3/4-ie}function y(j,V,we){return(V+we)*3/4-we}function F(j){var V,we=A(j),ie=we[0],K=we[1],te=new w(y(j,ie,K)),Q=0,ge=K>0?ie-4:ie,Te;for(Te=0;Te<ge;Te+=4)V=u[j.charCodeAt(Te)]<<18|u[j.charCodeAt(Te+1)]<<12|u[j.charCodeAt(Te+2)]<<6|u[j.charCodeAt(Te+3)],te[Q++]=V>>16&255,te[Q++]=V>>8&255,te[Q++]=V&255;return K===2&&(V=u[j.charCodeAt(Te)]<<2|u[j.charCodeAt(Te+1)]>>4,te[Q++]=V&255),K===1&&(V=u[j.charCodeAt(Te)]<<10|u[j.charCodeAt(Te+1)]<<4|u[j.charCodeAt(Te+2)]>>2,te[Q++]=V>>8&255,te[Q++]=V&255),te}function D(j){return f[j>>18&63]+f[j>>12&63]+f[j>>6&63]+f[j&63]}function B(j,V,we){for(var ie,K=[],te=V;te<we;te+=3)ie=(j[te]<<16&16711680)+(j[te+1]<<8&65280)+(j[te+2]&255),K.push(D(ie));return K.join("")}function z(j){for(var V,we=j.length,ie=we%3,K=[],te=16383,Q=0,ge=we-ie;Q<ge;Q+=te)K.push(B(j,Q,Q+te>ge?ge:Q+te));return ie===1?(V=j[we-1],K.push(f[V>>2]+f[V<<4&63]+"==")):ie===2&&(V=(j[we-2]<<8)+j[we-1],K.push(f[V>>10]+f[V>>4&63]+f[V<<2&63]+"=")),K.join("")}return Bi}var ua={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var Ys;function $f(){return Ys||(Ys=1,ua.read=function(f,u,w,m,k){var _,A,d=k*8-m-1,y=(1<<d)-1,F=y>>1,D=-7,B=w?k-1:0,z=w?-1:1,j=f[u+B];for(B+=z,_=j&(1<<-D)-1,j>>=-D,D+=d;D>0;_=_*256+f[u+B],B+=z,D-=8);for(A=_&(1<<-D)-1,_>>=-D,D+=m;D>0;A=A*256+f[u+B],B+=z,D-=8);if(_===0)_=1-F;else{if(_===y)return A?NaN:(j?-1:1)*(1/0);A=A+Math.pow(2,m),_=_-F}return(j?-1:1)*A*Math.pow(2,_-m)},ua.write=function(f,u,w,m,k,_){var A,d,y,F=_*8-k-1,D=(1<<F)-1,B=D>>1,z=k===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=m?0:_-1,V=m?1:-1,we=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(d=isNaN(u)?1:0,A=D):(A=Math.floor(Math.log(u)/Math.LN2),u*(y=Math.pow(2,-A))<1&&(A--,y*=2),A+B>=1?u+=z/y:u+=z*Math.pow(2,1-B),u*y>=2&&(A++,y/=2),A+B>=D?(d=0,A=D):A+B>=1?(d=(u*y-1)*Math.pow(2,k),A=A+B):(d=u*Math.pow(2,B-1)*Math.pow(2,k),A=0));k>=8;f[w+j]=d&255,j+=V,d/=256,k-=8);for(A=A<<k|d,F+=k;F>0;f[w+j]=A&255,j+=V,A/=256,F-=8);f[w+j-V]|=we*128}),ua}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Xs;function Ff(){return Xs||(Xs=1,(function(f){const u=Cf(),w=$f(),m=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;f.Buffer=d,f.SlowBuffer=te,f.INSPECT_MAX_BYTES=50;const k=2147483647;f.kMaxLength=k,d.TYPED_ARRAY_SUPPORT=_(),!d.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function _(){try{const O=new Uint8Array(1),h={foo:function(){return 42}};return Object.setPrototypeOf(h,Uint8Array.prototype),Object.setPrototypeOf(O,h),O.foo()===42}catch{return!1}}Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}});function A(O){if(O>k)throw new RangeError('The value "'+O+'" is invalid for option "size"');const h=new Uint8Array(O);return Object.setPrototypeOf(h,d.prototype),h}function d(O,h,v){if(typeof O=="number"){if(typeof h=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return B(O)}return y(O,h,v)}d.poolSize=8192;function y(O,h,v){if(typeof O=="string")return z(O,h);if(ArrayBuffer.isView(O))return V(O);if(O==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O);if(Ft(O,ArrayBuffer)||O&&Ft(O.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ft(O,SharedArrayBuffer)||O&&Ft(O.buffer,SharedArrayBuffer)))return we(O,h,v);if(typeof O=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const U=O.valueOf&&O.valueOf();if(U!=null&&U!==O)return d.from(U,h,v);const b=ie(O);if(b)return b;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof O[Symbol.toPrimitive]=="function")return d.from(O[Symbol.toPrimitive]("string"),h,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O)}d.from=function(O,h,v){return y(O,h,v)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array);function F(O){if(typeof O!="number")throw new TypeError('"size" argument must be of type number');if(O<0)throw new RangeError('The value "'+O+'" is invalid for option "size"')}function D(O,h,v){return F(O),O<=0?A(O):h!==void 0?typeof v=="string"?A(O).fill(h,v):A(O).fill(h):A(O)}d.alloc=function(O,h,v){return D(O,h,v)};function B(O){return F(O),A(O<0?0:K(O)|0)}d.allocUnsafe=function(O){return B(O)},d.allocUnsafeSlow=function(O){return B(O)};function z(O,h){if((typeof h!="string"||h==="")&&(h="utf8"),!d.isEncoding(h))throw new TypeError("Unknown encoding: "+h);const v=Q(O,h)|0;let U=A(v);const b=U.write(O,h);return b!==v&&(U=U.slice(0,b)),U}function j(O){const h=O.length<0?0:K(O.length)|0,v=A(h);for(let U=0;U<h;U+=1)v[U]=O[U]&255;return v}function V(O){if(Ft(O,Uint8Array)){const h=new Uint8Array(O);return we(h.buffer,h.byteOffset,h.byteLength)}return j(O)}function we(O,h,v){if(h<0||O.byteLength<h)throw new RangeError('"offset" is outside of buffer bounds');if(O.byteLength<h+(v||0))throw new RangeError('"length" is outside of buffer bounds');let U;return h===void 0&&v===void 0?U=new Uint8Array(O):v===void 0?U=new Uint8Array(O,h):U=new Uint8Array(O,h,v),Object.setPrototypeOf(U,d.prototype),U}function ie(O){if(d.isBuffer(O)){const h=K(O.length)|0,v=A(h);return v.length===0||O.copy(v,0,0,h),v}if(O.length!==void 0)return typeof O.length!="number"||or(O.length)?A(0):j(O);if(O.type==="Buffer"&&Array.isArray(O.data))return j(O.data)}function K(O){if(O>=k)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+k.toString(16)+" bytes");return O|0}function te(O){return+O!=O&&(O=0),d.alloc(+O)}d.isBuffer=function(h){return h!=null&&h._isBuffer===!0&&h!==d.prototype},d.compare=function(h,v){if(Ft(h,Uint8Array)&&(h=d.from(h,h.offset,h.byteLength)),Ft(v,Uint8Array)&&(v=d.from(v,v.offset,v.byteLength)),!d.isBuffer(h)||!d.isBuffer(v))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(h===v)return 0;let U=h.length,b=v.length;for(let L=0,J=Math.min(U,b);L<J;++L)if(h[L]!==v[L]){U=h[L],b=v[L];break}return U<b?-1:b<U?1:0},d.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(h,v){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return d.alloc(0);let U;if(v===void 0)for(v=0,U=0;U<h.length;++U)v+=h[U].length;const b=d.allocUnsafe(v);let L=0;for(U=0;U<h.length;++U){let J=h[U];if(Ft(J,Uint8Array))L+J.length>b.length?(d.isBuffer(J)||(J=d.from(J)),J.copy(b,L)):Uint8Array.prototype.set.call(b,J,L);else if(d.isBuffer(J))J.copy(b,L);else throw new TypeError('"list" argument must be an Array of Buffers');L+=J.length}return b};function Q(O,h){if(d.isBuffer(O))return O.length;if(ArrayBuffer.isView(O)||Ft(O,ArrayBuffer))return O.byteLength;if(typeof O!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof O);const v=O.length,U=arguments.length>2&&arguments[2]===!0;if(!U&&v===0)return 0;let b=!1;for(;;)switch(h){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return _e(O).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v*2;case"hex":return v>>>1;case"base64":return lr(O).length;default:if(b)return U?-1:_e(O).length;h=(""+h).toLowerCase(),b=!0}}d.byteLength=Q;function ge(O,h,v){let U=!1;if((h===void 0||h<0)&&(h=0),h>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0,h>>>=0,v<=h))return"";for(O||(O="utf8");;)switch(O){case"hex":return Ue(this,h,v);case"utf8":case"utf-8":return Le(this,h,v);case"ascii":return Re(this,h,v);case"latin1":case"binary":return Fe(this,h,v);case"base64":return Se(this,h,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return mt(this,h,v);default:if(U)throw new TypeError("Unknown encoding: "+O);O=(O+"").toLowerCase(),U=!0}}d.prototype._isBuffer=!0;function Te(O,h,v){const U=O[h];O[h]=O[v],O[v]=U}d.prototype.swap16=function(){const h=this.length;if(h%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let v=0;v<h;v+=2)Te(this,v,v+1);return this},d.prototype.swap32=function(){const h=this.length;if(h%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let v=0;v<h;v+=4)Te(this,v,v+3),Te(this,v+1,v+2);return this},d.prototype.swap64=function(){const h=this.length;if(h%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let v=0;v<h;v+=8)Te(this,v,v+7),Te(this,v+1,v+6),Te(this,v+2,v+5),Te(this,v+3,v+4);return this},d.prototype.toString=function(){const h=this.length;return h===0?"":arguments.length===0?Le(this,0,h):ge.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(h){if(!d.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h?!0:d.compare(this,h)===0},d.prototype.inspect=function(){let h="";const v=f.INSPECT_MAX_BYTES;return h=this.toString("hex",0,v).replace(/(.{2})/g,"$1 ").trim(),this.length>v&&(h+=" ... "),"<Buffer "+h+">"},m&&(d.prototype[m]=d.prototype.inspect),d.prototype.compare=function(h,v,U,b,L){if(Ft(h,Uint8Array)&&(h=d.from(h,h.offset,h.byteLength)),!d.isBuffer(h))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof h);if(v===void 0&&(v=0),U===void 0&&(U=h?h.length:0),b===void 0&&(b=0),L===void 0&&(L=this.length),v<0||U>h.length||b<0||L>this.length)throw new RangeError("out of range index");if(b>=L&&v>=U)return 0;if(b>=L)return-1;if(v>=U)return 1;if(v>>>=0,U>>>=0,b>>>=0,L>>>=0,this===h)return 0;let J=L-b,De=U-v;const Z=Math.min(J,De),W=this.slice(b,L),S=h.slice(v,U);for(let ke=0;ke<Z;++ke)if(W[ke]!==S[ke]){J=W[ke],De=S[ke];break}return J<De?-1:De<J?1:0};function le(O,h,v,U,b){if(O.length===0)return-1;if(typeof v=="string"?(U=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),v=+v,or(v)&&(v=b?0:O.length-1),v<0&&(v=O.length+v),v>=O.length){if(b)return-1;v=O.length-1}else if(v<0)if(b)v=0;else return-1;if(typeof h=="string"&&(h=d.from(h,U)),d.isBuffer(h))return h.length===0?-1:H(O,h,v,U,b);if(typeof h=="number")return h=h&255,typeof Uint8Array.prototype.indexOf=="function"?b?Uint8Array.prototype.indexOf.call(O,h,v):Uint8Array.prototype.lastIndexOf.call(O,h,v):H(O,[h],v,U,b);throw new TypeError("val must be string, number or Buffer")}function H(O,h,v,U,b){let L=1,J=O.length,De=h.length;if(U!==void 0&&(U=String(U).toLowerCase(),U==="ucs2"||U==="ucs-2"||U==="utf16le"||U==="utf-16le")){if(O.length<2||h.length<2)return-1;L=2,J/=2,De/=2,v/=2}function Z(S,ke){return L===1?S[ke]:S.readUInt16BE(ke*L)}let W;if(b){let S=-1;for(W=v;W<J;W++)if(Z(O,W)===Z(h,S===-1?0:W-S)){if(S===-1&&(S=W),W-S+1===De)return S*L}else S!==-1&&(W-=W-S),S=-1}else for(v+De>J&&(v=J-De),W=v;W>=0;W--){let S=!0;for(let ke=0;ke<De;ke++)if(Z(O,W+ke)!==Z(h,ke)){S=!1;break}if(S)return W}return-1}d.prototype.includes=function(h,v,U){return this.indexOf(h,v,U)!==-1},d.prototype.indexOf=function(h,v,U){return le(this,h,v,U,!0)},d.prototype.lastIndexOf=function(h,v,U){return le(this,h,v,U,!1)};function fe(O,h,v,U){v=Number(v)||0;const b=O.length-v;U?(U=Number(U),U>b&&(U=b)):U=b;const L=h.length;U>L/2&&(U=L/2);let J;for(J=0;J<U;++J){const De=parseInt(h.substr(J*2,2),16);if(or(De))return J;O[v+J]=De}return J}function Ae(O,h,v,U){return Ot(_e(h,O.length-v),O,v,U)}function pe(O,h,v,U){return Ot(bt(h),O,v,U)}function Be(O,h,v,U){return Ot(lr(h),O,v,U)}function Ce(O,h,v,U){return Ot(Wt(h,O.length-v),O,v,U)}d.prototype.write=function(h,v,U,b){if(v===void 0)b="utf8",U=this.length,v=0;else if(U===void 0&&typeof v=="string")b=v,U=this.length,v=0;else if(isFinite(v))v=v>>>0,isFinite(U)?(U=U>>>0,b===void 0&&(b="utf8")):(b=U,U=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const L=this.length-v;if((U===void 0||U>L)&&(U=L),h.length>0&&(U<0||v<0)||v>this.length)throw new RangeError("Attempt to write outside buffer bounds");b||(b="utf8");let J=!1;for(;;)switch(b){case"hex":return fe(this,h,v,U);case"utf8":case"utf-8":return Ae(this,h,v,U);case"ascii":case"latin1":case"binary":return pe(this,h,v,U);case"base64":return Be(this,h,v,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ce(this,h,v,U);default:if(J)throw new TypeError("Unknown encoding: "+b);b=(""+b).toLowerCase(),J=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Se(O,h,v){return h===0&&v===O.length?u.fromByteArray(O):u.fromByteArray(O.slice(h,v))}function Le(O,h,v){v=Math.min(O.length,v);const U=[];let b=h;for(;b<v;){const L=O[b];let J=null,De=L>239?4:L>223?3:L>191?2:1;if(b+De<=v){let Z,W,S,ke;switch(De){case 1:L<128&&(J=L);break;case 2:Z=O[b+1],(Z&192)===128&&(ke=(L&31)<<6|Z&63,ke>127&&(J=ke));break;case 3:Z=O[b+1],W=O[b+2],(Z&192)===128&&(W&192)===128&&(ke=(L&15)<<12|(Z&63)<<6|W&63,ke>2047&&(ke<55296||ke>57343)&&(J=ke));break;case 4:Z=O[b+1],W=O[b+2],S=O[b+3],(Z&192)===128&&(W&192)===128&&(S&192)===128&&(ke=(L&15)<<18|(Z&63)<<12|(W&63)<<6|S&63,ke>65535&&ke<1114112&&(J=ke))}}J===null?(J=65533,De=1):J>65535&&(J-=65536,U.push(J>>>10&1023|55296),J=56320|J&1023),U.push(J),b+=De}return Ne(U)}const ft=4096;function Ne(O){const h=O.length;if(h<=ft)return String.fromCharCode.apply(String,O);let v="",U=0;for(;U<h;)v+=String.fromCharCode.apply(String,O.slice(U,U+=ft));return v}function Re(O,h,v){let U="";v=Math.min(O.length,v);for(let b=h;b<v;++b)U+=String.fromCharCode(O[b]&127);return U}function Fe(O,h,v){let U="";v=Math.min(O.length,v);for(let b=h;b<v;++b)U+=String.fromCharCode(O[b]);return U}function Ue(O,h,v){const U=O.length;(!h||h<0)&&(h=0),(!v||v<0||v>U)&&(v=U);let b="";for(let L=h;L<v;++L)b+=pr[O[L]];return b}function mt(O,h,v){const U=O.slice(h,v);let b="";for(let L=0;L<U.length-1;L+=2)b+=String.fromCharCode(U[L]+U[L+1]*256);return b}d.prototype.slice=function(h,v){const U=this.length;h=~~h,v=v===void 0?U:~~v,h<0?(h+=U,h<0&&(h=0)):h>U&&(h=U),v<0?(v+=U,v<0&&(v=0)):v>U&&(v=U),v<h&&(v=h);const b=this.subarray(h,v);return Object.setPrototypeOf(b,d.prototype),b};function pt(O,h,v){if(O%1!==0||O<0)throw new RangeError("offset is not uint");if(O+h>v)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUintLE=d.prototype.readUIntLE=function(h,v,U){h=h>>>0,v=v>>>0,U||pt(h,v,this.length);let b=this[h],L=1,J=0;for(;++J<v&&(L*=256);)b+=this[h+J]*L;return b},d.prototype.readUintBE=d.prototype.readUIntBE=function(h,v,U){h=h>>>0,v=v>>>0,U||pt(h,v,this.length);let b=this[h+--v],L=1;for(;v>0&&(L*=256);)b+=this[h+--v]*L;return b},d.prototype.readUint8=d.prototype.readUInt8=function(h,v){return h=h>>>0,v||pt(h,1,this.length),this[h]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(h,v){return h=h>>>0,v||pt(h,2,this.length),this[h]|this[h+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(h,v){return h=h>>>0,v||pt(h,2,this.length),this[h]<<8|this[h+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+this[h+3]*16777216},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),this[h]*16777216+(this[h+1]<<16|this[h+2]<<8|this[h+3])},d.prototype.readBigUInt64LE=Gt(function(h){h=h>>>0,vt(h,"offset");const v=this[h],U=this[h+7];(v===void 0||U===void 0)&&Ht(h,this.length-8);const b=v+this[++h]*2**8+this[++h]*2**16+this[++h]*2**24,L=this[++h]+this[++h]*2**8+this[++h]*2**16+U*2**24;return BigInt(b)+(BigInt(L)<<BigInt(32))}),d.prototype.readBigUInt64BE=Gt(function(h){h=h>>>0,vt(h,"offset");const v=this[h],U=this[h+7];(v===void 0||U===void 0)&&Ht(h,this.length-8);const b=v*2**24+this[++h]*2**16+this[++h]*2**8+this[++h],L=this[++h]*2**24+this[++h]*2**16+this[++h]*2**8+U;return(BigInt(b)<<BigInt(32))+BigInt(L)}),d.prototype.readIntLE=function(h,v,U){h=h>>>0,v=v>>>0,U||pt(h,v,this.length);let b=this[h],L=1,J=0;for(;++J<v&&(L*=256);)b+=this[h+J]*L;return L*=128,b>=L&&(b-=Math.pow(2,8*v)),b},d.prototype.readIntBE=function(h,v,U){h=h>>>0,v=v>>>0,U||pt(h,v,this.length);let b=v,L=1,J=this[h+--b];for(;b>0&&(L*=256);)J+=this[h+--b]*L;return L*=128,J>=L&&(J-=Math.pow(2,8*v)),J},d.prototype.readInt8=function(h,v){return h=h>>>0,v||pt(h,1,this.length),this[h]&128?(255-this[h]+1)*-1:this[h]},d.prototype.readInt16LE=function(h,v){h=h>>>0,v||pt(h,2,this.length);const U=this[h]|this[h+1]<<8;return U&32768?U|4294901760:U},d.prototype.readInt16BE=function(h,v){h=h>>>0,v||pt(h,2,this.length);const U=this[h+1]|this[h]<<8;return U&32768?U|4294901760:U},d.prototype.readInt32LE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},d.prototype.readInt32BE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},d.prototype.readBigInt64LE=Gt(function(h){h=h>>>0,vt(h,"offset");const v=this[h],U=this[h+7];(v===void 0||U===void 0)&&Ht(h,this.length-8);const b=this[h+4]+this[h+5]*2**8+this[h+6]*2**16+(U<<24);return(BigInt(b)<<BigInt(32))+BigInt(v+this[++h]*256+this[++h]*65536+this[++h]*16777216)}),d.prototype.readBigInt64BE=Gt(function(h){h=h>>>0,vt(h,"offset");const v=this[h],U=this[h+7];(v===void 0||U===void 0)&&Ht(h,this.length-8);const b=(v<<24)+this[++h]*2**16+this[++h]*2**8+this[++h];return(BigInt(b)<<BigInt(32))+BigInt(this[++h]*16777216+this[++h]*65536+this[++h]*256+U)}),d.prototype.readFloatLE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),w.read(this,h,!0,23,4)},d.prototype.readFloatBE=function(h,v){return h=h>>>0,v||pt(h,4,this.length),w.read(this,h,!1,23,4)},d.prototype.readDoubleLE=function(h,v){return h=h>>>0,v||pt(h,8,this.length),w.read(this,h,!0,52,8)},d.prototype.readDoubleBE=function(h,v){return h=h>>>0,v||pt(h,8,this.length),w.read(this,h,!1,52,8)};function gt(O,h,v,U,b,L){if(!d.isBuffer(O))throw new TypeError('"buffer" argument must be a Buffer instance');if(h>b||h<L)throw new RangeError('"value" argument is out of bounds');if(v+U>O.length)throw new RangeError("Index out of range")}d.prototype.writeUintLE=d.prototype.writeUIntLE=function(h,v,U,b){if(h=+h,v=v>>>0,U=U>>>0,!b){const De=Math.pow(2,8*U)-1;gt(this,h,v,U,De,0)}let L=1,J=0;for(this[v]=h&255;++J<U&&(L*=256);)this[v+J]=h/L&255;return v+U},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(h,v,U,b){if(h=+h,v=v>>>0,U=U>>>0,!b){const De=Math.pow(2,8*U)-1;gt(this,h,v,U,De,0)}let L=U-1,J=1;for(this[v+L]=h&255;--L>=0&&(J*=256);)this[v+L]=h/J&255;return v+U},d.prototype.writeUint8=d.prototype.writeUInt8=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,1,255,0),this[v]=h&255,v+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,2,65535,0),this[v]=h&255,this[v+1]=h>>>8,v+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,2,65535,0),this[v]=h>>>8,this[v+1]=h&255,v+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,4,4294967295,0),this[v+3]=h>>>24,this[v+2]=h>>>16,this[v+1]=h>>>8,this[v]=h&255,v+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,4,4294967295,0),this[v]=h>>>24,this[v+1]=h>>>16,this[v+2]=h>>>8,this[v+3]=h&255,v+4};function Pt(O,h,v,U,b){We(h,U,b,O,v,7);let L=Number(h&BigInt(4294967295));O[v++]=L,L=L>>8,O[v++]=L,L=L>>8,O[v++]=L,L=L>>8,O[v++]=L;let J=Number(h>>BigInt(32)&BigInt(4294967295));return O[v++]=J,J=J>>8,O[v++]=J,J=J>>8,O[v++]=J,J=J>>8,O[v++]=J,v}function Lt(O,h,v,U,b){We(h,U,b,O,v,7);let L=Number(h&BigInt(4294967295));O[v+7]=L,L=L>>8,O[v+6]=L,L=L>>8,O[v+5]=L,L=L>>8,O[v+4]=L;let J=Number(h>>BigInt(32)&BigInt(4294967295));return O[v+3]=J,J=J>>8,O[v+2]=J,J=J>>8,O[v+1]=J,J=J>>8,O[v]=J,v+8}d.prototype.writeBigUInt64LE=Gt(function(h,v=0){return Pt(this,h,v,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeBigUInt64BE=Gt(function(h,v=0){return Lt(this,h,v,BigInt(0),BigInt("0xffffffffffffffff"))}),d.prototype.writeIntLE=function(h,v,U,b){if(h=+h,v=v>>>0,!b){const Z=Math.pow(2,8*U-1);gt(this,h,v,U,Z-1,-Z)}let L=0,J=1,De=0;for(this[v]=h&255;++L<U&&(J*=256);)h<0&&De===0&&this[v+L-1]!==0&&(De=1),this[v+L]=(h/J>>0)-De&255;return v+U},d.prototype.writeIntBE=function(h,v,U,b){if(h=+h,v=v>>>0,!b){const Z=Math.pow(2,8*U-1);gt(this,h,v,U,Z-1,-Z)}let L=U-1,J=1,De=0;for(this[v+L]=h&255;--L>=0&&(J*=256);)h<0&&De===0&&this[v+L+1]!==0&&(De=1),this[v+L]=(h/J>>0)-De&255;return v+U},d.prototype.writeInt8=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,1,127,-128),h<0&&(h=255+h+1),this[v]=h&255,v+1},d.prototype.writeInt16LE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,2,32767,-32768),this[v]=h&255,this[v+1]=h>>>8,v+2},d.prototype.writeInt16BE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,2,32767,-32768),this[v]=h>>>8,this[v+1]=h&255,v+2},d.prototype.writeInt32LE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,4,2147483647,-2147483648),this[v]=h&255,this[v+1]=h>>>8,this[v+2]=h>>>16,this[v+3]=h>>>24,v+4},d.prototype.writeInt32BE=function(h,v,U){return h=+h,v=v>>>0,U||gt(this,h,v,4,2147483647,-2147483648),h<0&&(h=4294967295+h+1),this[v]=h>>>24,this[v+1]=h>>>16,this[v+2]=h>>>8,this[v+3]=h&255,v+4},d.prototype.writeBigInt64LE=Gt(function(h,v=0){return Pt(this,h,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),d.prototype.writeBigInt64BE=Gt(function(h,v=0){return Lt(this,h,v,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Mt(O,h,v,U,b,L){if(v+U>O.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function Et(O,h,v,U,b){return h=+h,v=v>>>0,b||Mt(O,h,v,4),w.write(O,h,v,U,23,4),v+4}d.prototype.writeFloatLE=function(h,v,U){return Et(this,h,v,!0,U)},d.prototype.writeFloatBE=function(h,v,U){return Et(this,h,v,!1,U)};function ct(O,h,v,U,b){return h=+h,v=v>>>0,b||Mt(O,h,v,8),w.write(O,h,v,U,52,8),v+8}d.prototype.writeDoubleLE=function(h,v,U){return ct(this,h,v,!0,U)},d.prototype.writeDoubleBE=function(h,v,U){return ct(this,h,v,!1,U)},d.prototype.copy=function(h,v,U,b){if(!d.isBuffer(h))throw new TypeError("argument should be a Buffer");if(U||(U=0),!b&&b!==0&&(b=this.length),v>=h.length&&(v=h.length),v||(v=0),b>0&&b<U&&(b=U),b===U||h.length===0||this.length===0)return 0;if(v<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("sourceEnd out of bounds");b>this.length&&(b=this.length),h.length-v<b-U&&(b=h.length-v+U);const L=b-U;return this===h&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(v,U,b):Uint8Array.prototype.set.call(h,this.subarray(U,b),v),L},d.prototype.fill=function(h,v,U,b){if(typeof h=="string"){if(typeof v=="string"?(b=v,v=0,U=this.length):typeof U=="string"&&(b=U,U=this.length),b!==void 0&&typeof b!="string")throw new TypeError("encoding must be a string");if(typeof b=="string"&&!d.isEncoding(b))throw new TypeError("Unknown encoding: "+b);if(h.length===1){const J=h.charCodeAt(0);(b==="utf8"&&J<128||b==="latin1")&&(h=J)}}else typeof h=="number"?h=h&255:typeof h=="boolean"&&(h=Number(h));if(v<0||this.length<v||this.length<U)throw new RangeError("Out of range index");if(U<=v)return this;v=v>>>0,U=U===void 0?this.length:U>>>0,h||(h=0);let L;if(typeof h=="number")for(L=v;L<U;++L)this[L]=h;else{const J=d.isBuffer(h)?h:d.from(h,b),De=J.length;if(De===0)throw new TypeError('The value "'+h+'" is invalid for argument "value"');for(L=0;L<U-v;++L)this[L+v]=J[L%De]}return this};const ht={};function kt(O,h,v){ht[O]=class extends v{constructor(){super(),Object.defineProperty(this,"message",{value:h.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${O}]`,this.stack,delete this.name}get code(){return O}set code(b){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:b,writable:!0})}toString(){return`${this.name} [${O}]: ${this.message}`}}}kt("ERR_BUFFER_OUT_OF_BOUNDS",function(O){return O?`${O} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),kt("ERR_INVALID_ARG_TYPE",function(O,h){return`The "${O}" argument must be of type number. Received type ${typeof h}`},TypeError),kt("ERR_OUT_OF_RANGE",function(O,h,v){let U=`The value of "${O}" is out of range.`,b=v;return Number.isInteger(v)&&Math.abs(v)>4294967296?b=qe(String(v)):typeof v=="bigint"&&(b=String(v),(v>BigInt(2)**BigInt(32)||v<-(BigInt(2)**BigInt(32)))&&(b=qe(b)),b+="n"),U+=` It must be ${h}. Received ${b}`,U},RangeError);function qe(O){let h="",v=O.length;const U=O[0]==="-"?1:0;for(;v>=U+4;v-=3)h=`_${O.slice(v-3,v)}${h}`;return`${O.slice(0,v)}${h}`}function It(O,h,v){vt(h,"offset"),(O[h]===void 0||O[h+v]===void 0)&&Ht(h,O.length-(v+1))}function We(O,h,v,U,b,L){if(O>v||O<h){const J=typeof h=="bigint"?"n":"";let De;throw h===0||h===BigInt(0)?De=`>= 0${J} and < 2${J} ** ${(L+1)*8}${J}`:De=`>= -(2${J} ** ${(L+1)*8-1}${J}) and < 2 ** ${(L+1)*8-1}${J}`,new ht.ERR_OUT_OF_RANGE("value",De,O)}It(U,b,L)}function vt(O,h){if(typeof O!="number")throw new ht.ERR_INVALID_ARG_TYPE(h,"number",O)}function Ht(O,h,v){throw Math.floor(O)!==O?(vt(O,v),new ht.ERR_OUT_OF_RANGE("offset","an integer",O)):h<0?new ht.ERR_BUFFER_OUT_OF_BOUNDS:new ht.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${h}`,O)}const qt=/[^+/0-9A-Za-z-_]/g;function Bt(O){if(O=O.split("=")[0],O=O.trim().replace(qt,""),O.length<2)return"";for(;O.length%4!==0;)O=O+"=";return O}function _e(O,h){h=h||1/0;let v;const U=O.length;let b=null;const L=[];for(let J=0;J<U;++J){if(v=O.charCodeAt(J),v>55295&&v<57344){if(!b){if(v>56319){(h-=3)>-1&&L.push(239,191,189);continue}else if(J+1===U){(h-=3)>-1&&L.push(239,191,189);continue}b=v;continue}if(v<56320){(h-=3)>-1&&L.push(239,191,189),b=v;continue}v=(b-55296<<10|v-56320)+65536}else b&&(h-=3)>-1&&L.push(239,191,189);if(b=null,v<128){if((h-=1)<0)break;L.push(v)}else if(v<2048){if((h-=2)<0)break;L.push(v>>6|192,v&63|128)}else if(v<65536){if((h-=3)<0)break;L.push(v>>12|224,v>>6&63|128,v&63|128)}else if(v<1114112){if((h-=4)<0)break;L.push(v>>18|240,v>>12&63|128,v>>6&63|128,v&63|128)}else throw new Error("Invalid code point")}return L}function bt(O){const h=[];for(let v=0;v<O.length;++v)h.push(O.charCodeAt(v)&255);return h}function Wt(O,h){let v,U,b;const L=[];for(let J=0;J<O.length&&!((h-=2)<0);++J)v=O.charCodeAt(J),U=v>>8,b=v%256,L.push(b),L.push(U);return L}function lr(O){return u.toByteArray(Bt(O))}function Ot(O,h,v,U){let b;for(b=0;b<U&&!(b+v>=h.length||b>=O.length);++b)h[b+v]=O[b];return b}function Ft(O,h){return O instanceof h||O!=null&&O.constructor!=null&&O.constructor.name!=null&&O.constructor.name===h.name}function or(O){return O!==O}const pr=(function(){const O="0123456789abcdef",h=new Array(256);for(let v=0;v<16;++v){const U=v*16;for(let b=0;b<16;++b)h[U+b]=O[v]+O[b]}return h})();function Gt(O){return typeof BigInt>"u"?tr:O}function tr(){throw new Error("BigInt not supported")}})(Na)),Na}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Js;function ja(){return Js||(Js=1,(function(f,u){var w=Ff(),m=w.Buffer;function k(A,d){for(var y in A)d[y]=A[y]}m.from&&m.alloc&&m.allocUnsafe&&m.allocUnsafeSlow?f.exports=w:(k(w,u),u.Buffer=_);function _(A,d,y){return m(A,d,y)}_.prototype=Object.create(m.prototype),k(m,_),_.from=function(A,d,y){if(typeof A=="number")throw new TypeError("Argument must not be a number");return m(A,d,y)},_.alloc=function(A,d,y){if(typeof A!="number")throw new TypeError("Argument must be a number");var F=m(A);return d!==void 0?typeof y=="string"?F.fill(d,y):F.fill(d):F.fill(0),F},_.allocUnsafe=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return m(A)},_.allocUnsafeSlow=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(A)}})(ca,ca.exports)),ca.exports}var Ma,Qs;function Df(){if(Qs)return Ma;Qs=1;var f={}.toString;return Ma=Array.isArray||function(u){return f.call(u)=="[object Array]"},Ma}var qa,ec;function Ci(){return ec||(ec=1,qa=TypeError),qa}var Ua,tc;function rc(){return tc||(tc=1,Ua=Object),Ua}var La,nc;function Nf(){return nc||(nc=1,La=Error),La}var za,ic;function jf(){return ic||(ic=1,za=EvalError),za}var Ha,ac;function Mf(){return ac||(ac=1,Ha=RangeError),Ha}var Ga,oc;function qf(){return oc||(oc=1,Ga=ReferenceError),Ga}var Ka,sc;function cc(){return sc||(sc=1,Ka=SyntaxError),Ka}var Wa,uc;function Uf(){return uc||(uc=1,Wa=URIError),Wa}var Za,lc;function Lf(){return lc||(lc=1,Za=Math.abs),Za}var Va,fc;function zf(){return fc||(fc=1,Va=Math.floor),Va}var Ya,hc;function Hf(){return hc||(hc=1,Ya=Math.max),Ya}var Xa,dc;function Gf(){return dc||(dc=1,Xa=Math.min),Xa}var Ja,pc;function Kf(){return pc||(pc=1,Ja=Math.pow),Ja}var Qa,mc;function Wf(){return mc||(mc=1,Qa=Math.round),Qa}var eo,wc;function Zf(){return wc||(wc=1,eo=Number.isNaN||function(u){return u!==u}),eo}var to,gc;function Vf(){if(gc)return to;gc=1;var f=Zf();return to=function(w){return f(w)||w===0?w:w<0?-1:1},to}var ro,yc;function Yf(){return yc||(yc=1,ro=Object.getOwnPropertyDescriptor),ro}var no,vc;function $i(){if(vc)return no;vc=1;var f=Yf();if(f)try{f([],"length")}catch{f=null}return no=f,no}var io,bc;function la(){if(bc)return io;bc=1;var f=Object.defineProperty||!1;if(f)try{f({},"a",{value:1})}catch{f=!1}return io=f,io}var ao,_c;function xc(){return _c||(_c=1,ao=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var u={},w=Symbol("test"),m=Object(w);if(typeof w=="string"||Object.prototype.toString.call(w)!=="[object Symbol]"||Object.prototype.toString.call(m)!=="[object Symbol]")return!1;var k=42;u[w]=k;for(var _ in u)return!1;if(typeof Object.keys=="function"&&Object.keys(u).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(u).length!==0)return!1;var A=Object.getOwnPropertySymbols(u);if(A.length!==1||A[0]!==w||!Object.prototype.propertyIsEnumerable.call(u,w))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var d=Object.getOwnPropertyDescriptor(u,w);if(d.value!==k||d.enumerable!==!0)return!1}return!0}),ao}var oo,Ec;function Xf(){if(Ec)return oo;Ec=1;var f=typeof Symbol<"u"&&Symbol,u=xc();return oo=function(){return typeof f!="function"||typeof Symbol!="function"||typeof f("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:u()},oo}var so,Ac;function kc(){return Ac||(Ac=1,so=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),so}var co,Sc;function Rc(){if(Sc)return co;Sc=1;var f=rc();return co=f.getPrototypeOf||null,co}var uo,Ic;function Jf(){if(Ic)return uo;Ic=1;var f="Function.prototype.bind called on incompatible ",u=Object.prototype.toString,w=Math.max,m="[object Function]",k=function(y,F){for(var D=[],B=0;B<y.length;B+=1)D[B]=y[B];for(var z=0;z<F.length;z+=1)D[z+y.length]=F[z];return D},_=function(y,F){for(var D=[],B=F,z=0;B<y.length;B+=1,z+=1)D[z]=y[B];return D},A=function(d,y){for(var F="",D=0;D<d.length;D+=1)F+=d[D],D+1<d.length&&(F+=y);return F};return uo=function(y){var F=this;if(typeof F!="function"||u.apply(F)!==m)throw new TypeError(f+F);for(var D=_(arguments,1),B,z=function(){if(this instanceof B){var K=F.apply(this,k(D,arguments));return Object(K)===K?K:this}return F.apply(y,k(D,arguments))},j=w(0,F.length-D.length),V=[],we=0;we<j;we++)V[we]="$"+we;if(B=Function("binder","return function ("+A(V,",")+"){ return binder.apply(this,arguments); }")(z),F.prototype){var ie=function(){};ie.prototype=F.prototype,B.prototype=new ie,ie.prototype=null}return B},uo}var lo,Tc;function Fi(){if(Tc)return lo;Tc=1;var f=Jf();return lo=Function.prototype.bind||f,lo}var fo,Oc;function ho(){return Oc||(Oc=1,fo=Function.prototype.call),fo}var po,Pc;function mo(){return Pc||(Pc=1,po=Function.prototype.apply),po}var wo,Bc;function Qf(){return Bc||(Bc=1,wo=typeof Reflect<"u"&&Reflect&&Reflect.apply),wo}var go,Cc;function $c(){if(Cc)return go;Cc=1;var f=Fi(),u=mo(),w=ho(),m=Qf();return go=m||f.call(w,u),go}var yo,Fc;function vo(){if(Fc)return yo;Fc=1;var f=Fi(),u=Ci(),w=ho(),m=$c();return yo=function(_){if(_.length<1||typeof _[0]!="function")throw new u("a function is required");return m(f,w,_)},yo}var bo,Dc;function eh(){if(Dc)return bo;Dc=1;var f=vo(),u=$i(),w;try{w=[].__proto__===Array.prototype}catch(A){if(!A||typeof A!="object"||!("code"in A)||A.code!=="ERR_PROTO_ACCESS")throw A}var m=!!w&&u&&u(Object.prototype,"__proto__"),k=Object,_=k.getPrototypeOf;return bo=m&&typeof m.get=="function"?f([m.get]):typeof _=="function"?function(d){return _(d==null?d:k(d))}:!1,bo}var _o,Nc;function jc(){if(Nc)return _o;Nc=1;var f=kc(),u=Rc(),w=eh();return _o=f?function(k){return f(k)}:u?function(k){if(!k||typeof k!="object"&&typeof k!="function")throw new TypeError("getProto: not an object");return u(k)}:w?function(k){return w(k)}:null,_o}var xo,Mc;function th(){if(Mc)return xo;Mc=1;var f=Function.prototype.call,u=Object.prototype.hasOwnProperty,w=Fi();return xo=w.call(f,u),xo}var Eo,qc;function Uc(){if(qc)return Eo;qc=1;var f,u=rc(),w=Nf(),m=jf(),k=Mf(),_=qf(),A=cc(),d=Ci(),y=Uf(),F=Lf(),D=zf(),B=Hf(),z=Gf(),j=Kf(),V=Wf(),we=Vf(),ie=Function,K=function(kt){try{return ie('"use strict"; return ('+kt+").constructor;")()}catch{}},te=$i(),Q=la(),ge=function(){throw new d},Te=te?(function(){try{return arguments.callee,ge}catch{try{return te(arguments,"callee").get}catch{return ge}}})():ge,le=Xf()(),H=jc(),fe=Rc(),Ae=kc(),pe=mo(),Be=ho(),Ce={},Se=typeof Uint8Array>"u"||!H?f:H(Uint8Array),Le={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?f:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?f:ArrayBuffer,"%ArrayIteratorPrototype%":le&&H?H([][Symbol.iterator]()):f,"%AsyncFromSyncIteratorPrototype%":f,"%AsyncFunction%":Ce,"%AsyncGenerator%":Ce,"%AsyncGeneratorFunction%":Ce,"%AsyncIteratorPrototype%":Ce,"%Atomics%":typeof Atomics>"u"?f:Atomics,"%BigInt%":typeof BigInt>"u"?f:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?f:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?f:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?f:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":w,"%eval%":eval,"%EvalError%":m,"%Float16Array%":typeof Float16Array>"u"?f:Float16Array,"%Float32Array%":typeof Float32Array>"u"?f:Float32Array,"%Float64Array%":typeof Float64Array>"u"?f:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?f:FinalizationRegistry,"%Function%":ie,"%GeneratorFunction%":Ce,"%Int8Array%":typeof Int8Array>"u"?f:Int8Array,"%Int16Array%":typeof Int16Array>"u"?f:Int16Array,"%Int32Array%":typeof Int32Array>"u"?f:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":le&&H?H(H([][Symbol.iterator]())):f,"%JSON%":typeof JSON=="object"?JSON:f,"%Map%":typeof Map>"u"?f:Map,"%MapIteratorPrototype%":typeof Map>"u"||!le||!H?f:H(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":u,"%Object.getOwnPropertyDescriptor%":te,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?f:Promise,"%Proxy%":typeof Proxy>"u"?f:Proxy,"%RangeError%":k,"%ReferenceError%":_,"%Reflect%":typeof Reflect>"u"?f:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?f:Set,"%SetIteratorPrototype%":typeof Set>"u"||!le||!H?f:H(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?f:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":le&&H?H(""[Symbol.iterator]()):f,"%Symbol%":le?Symbol:f,"%SyntaxError%":A,"%ThrowTypeError%":Te,"%TypedArray%":Se,"%TypeError%":d,"%Uint8Array%":typeof Uint8Array>"u"?f:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?f:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?f:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?f:Uint32Array,"%URIError%":y,"%WeakMap%":typeof WeakMap>"u"?f:WeakMap,"%WeakRef%":typeof WeakRef>"u"?f:WeakRef,"%WeakSet%":typeof WeakSet>"u"?f:WeakSet,"%Function.prototype.call%":Be,"%Function.prototype.apply%":pe,"%Object.defineProperty%":Q,"%Object.getPrototypeOf%":fe,"%Math.abs%":F,"%Math.floor%":D,"%Math.max%":B,"%Math.min%":z,"%Math.pow%":j,"%Math.round%":V,"%Math.sign%":we,"%Reflect.getPrototypeOf%":Ae};if(H)try{null.error}catch(kt){var ft=H(H(kt));Le["%Error.prototype%"]=ft}var Ne=function kt(qe){var It;if(qe==="%AsyncFunction%")It=K("async function () {}");else if(qe==="%GeneratorFunction%")It=K("function* () {}");else if(qe==="%AsyncGeneratorFunction%")It=K("async function* () {}");else if(qe==="%AsyncGenerator%"){var We=kt("%AsyncGeneratorFunction%");We&&(It=We.prototype)}else if(qe==="%AsyncIteratorPrototype%"){var vt=kt("%AsyncGenerator%");vt&&H&&(It=H(vt.prototype))}return Le[qe]=It,It},Re={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Fe=Fi(),Ue=th(),mt=Fe.call(Be,Array.prototype.concat),pt=Fe.call(pe,Array.prototype.splice),gt=Fe.call(Be,String.prototype.replace),Pt=Fe.call(Be,String.prototype.slice),Lt=Fe.call(Be,RegExp.prototype.exec),Mt=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Et=/\\(\\)?/g,ct=function(qe){var It=Pt(qe,0,1),We=Pt(qe,-1);if(It==="%"&&We!=="%")throw new A("invalid intrinsic syntax, expected closing `%`");if(We==="%"&&It!=="%")throw new A("invalid intrinsic syntax, expected opening `%`");var vt=[];return gt(qe,Mt,function(Ht,qt,Bt,_e){vt[vt.length]=Bt?gt(_e,Et,"$1"):qt||Ht}),vt},ht=function(qe,It){var We=qe,vt;if(Ue(Re,We)&&(vt=Re[We],We="%"+vt[0]+"%"),Ue(Le,We)){var Ht=Le[We];if(Ht===Ce&&(Ht=Ne(We)),typeof Ht>"u"&&!It)throw new d("intrinsic "+qe+" exists, but is not available. Please file an issue!");return{alias:vt,name:We,value:Ht}}throw new A("intrinsic "+qe+" does not exist!")};return Eo=function(qe,It){if(typeof qe!="string"||qe.length===0)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof It!="boolean")throw new d('"allowMissing" argument must be a boolean');if(Lt(/^%?[^%]*%?$/,qe)===null)throw new A("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var We=ct(qe),vt=We.length>0?We[0]:"",Ht=ht("%"+vt+"%",It),qt=Ht.name,Bt=Ht.value,_e=!1,bt=Ht.alias;bt&&(vt=bt[0],pt(We,mt([0,1],bt)));for(var Wt=1,lr=!0;Wt<We.length;Wt+=1){var Ot=We[Wt],Ft=Pt(Ot,0,1),or=Pt(Ot,-1);if((Ft==='"'||Ft==="'"||Ft==="`"||or==='"'||or==="'"||or==="`")&&Ft!==or)throw new A("property names with quotes must have matching quotes");if((Ot==="constructor"||!lr)&&(_e=!0),vt+="."+Ot,qt="%"+vt+"%",Ue(Le,qt))Bt=Le[qt];else if(Bt!=null){if(!(Ot in Bt)){if(!It)throw new d("base intrinsic for "+qe+" exists, but the property is not available.");return}if(te&&Wt+1>=We.length){var pr=te(Bt,Ot);lr=!!pr,lr&&"get"in pr&&!("originalValue"in pr.get)?Bt=pr.get:Bt=Bt[Ot]}else lr=Ue(Bt,Ot),Bt=Bt[Ot];lr&&!_e&&(Le[qt]=Bt)}}return Bt},Eo}var Ao,Lc;function zc(){if(Lc)return Ao;Lc=1;var f=Uc(),u=vo(),w=u([f("%String.prototype.indexOf%")]);return Ao=function(k,_){var A=f(k,!!_);return typeof A=="function"&&w(k,".prototype.")>-1?u([A]):A},Ao}var ko,Hc;function rh(){if(Hc)return ko;Hc=1;var f=Function.prototype.toString,u=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,w,m;if(typeof u=="function"&&typeof Object.defineProperty=="function")try{w=Object.defineProperty({},"length",{get:function(){throw m}}),m={},u(function(){throw 42},null,w)}catch(te){te!==m&&(u=null)}else u=null;var k=/^\s*class\b/,_=function(Q){try{var ge=f.call(Q);return k.test(ge)}catch{return!1}},A=function(Q){try{return _(Q)?!1:(f.call(Q),!0)}catch{return!1}},d=Object.prototype.toString,y="[object Object]",F="[object Function]",D="[object GeneratorFunction]",B="[object HTMLAllCollection]",z="[object HTML document.all class]",j="[object HTMLCollection]",V=typeof Symbol=="function"&&!!Symbol.toStringTag,we=!(0 in[,]),ie=function(){return!1};if(typeof document=="object"){var K=document.all;d.call(K)===d.call(document.all)&&(ie=function(Q){if((we||!Q)&&(typeof Q>"u"||typeof Q=="object"))try{var ge=d.call(Q);return(ge===B||ge===z||ge===j||ge===y)&&Q("")==null}catch{}return!1})}return ko=u?function(Q){if(ie(Q))return!0;if(!Q||typeof Q!="function"&&typeof Q!="object")return!1;try{u(Q,null,w)}catch(ge){if(ge!==m)return!1}return!_(Q)&&A(Q)}:function(Q){if(ie(Q))return!0;if(!Q||typeof Q!="function"&&typeof Q!="object")return!1;if(V)return A(Q);if(_(Q))return!1;var ge=d.call(Q);return ge!==F&&ge!==D&&!/^\[object HTML/.test(ge)?!1:A(Q)},ko}var So,Gc;function nh(){if(Gc)return So;Gc=1;var f=rh(),u=Object.prototype.toString,w=Object.prototype.hasOwnProperty,m=function(y,F,D){for(var B=0,z=y.length;B<z;B++)w.call(y,B)&&(D==null?F(y[B],B,y):F.call(D,y[B],B,y))},k=function(y,F,D){for(var B=0,z=y.length;B<z;B++)D==null?F(y.charAt(B),B,y):F.call(D,y.charAt(B),B,y)},_=function(y,F,D){for(var B in y)w.call(y,B)&&(D==null?F(y[B],B,y):F.call(D,y[B],B,y))};function A(d){return u.call(d)==="[object Array]"}return So=function(y,F,D){if(!f(F))throw new TypeError("iterator must be a function");var B;arguments.length>=3&&(B=D),A(y)?m(y,F,B):typeof y=="string"?k(y,F,B):_(y,F,B)},So}var Ro,Kc;function ih(){return Kc||(Kc=1,Ro=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),Ro}var Io,Wc;function ah(){if(Wc)return Io;Wc=1;var f=ih(),u=typeof globalThis>"u"?Pi:globalThis;return Io=function(){for(var m=[],k=0;k<f.length;k++)typeof u[f[k]]=="function"&&(m[m.length]=f[k]);return m},Io}var To={exports:{}},Oo,Zc;function oh(){if(Zc)return Oo;Zc=1;var f=la(),u=cc(),w=Ci(),m=$i();return Oo=function(_,A,d){if(!_||typeof _!="object"&&typeof _!="function")throw new w("`obj` must be an object or a function`");if(typeof A!="string"&&typeof A!="symbol")throw new w("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new w("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new w("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new w("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new w("`loose`, if provided, must be a boolean");var y=arguments.length>3?arguments[3]:null,F=arguments.length>4?arguments[4]:null,D=arguments.length>5?arguments[5]:null,B=arguments.length>6?arguments[6]:!1,z=!!m&&m(_,A);if(f)f(_,A,{configurable:D===null&&z?z.configurable:!D,enumerable:y===null&&z?z.enumerable:!y,value:d,writable:F===null&&z?z.writable:!F});else if(B||!y&&!F&&!D)_[A]=d;else throw new u("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Oo}var Po,Vc;function sh(){if(Vc)return Po;Vc=1;var f=la(),u=function(){return!!f};return u.hasArrayLengthDefineBug=function(){if(!f)return null;try{return f([],"length",{value:1}).length!==1}catch{return!0}},Po=u,Po}var Bo,Yc;function ch(){if(Yc)return Bo;Yc=1;var f=Uc(),u=oh(),w=sh()(),m=$i(),k=Ci(),_=f("%Math.floor%");return Bo=function(d,y){if(typeof d!="function")throw new k("`fn` is not a function");if(typeof y!="number"||y<0||y>4294967295||_(y)!==y)throw new k("`length` must be a positive 32-bit integer");var F=arguments.length>2&&!!arguments[2],D=!0,B=!0;if("length"in d&&m){var z=m(d,"length");z&&!z.configurable&&(D=!1),z&&!z.writable&&(B=!1)}return(D||B||!F)&&(w?u(d,"length",y,!0,!0):u(d,"length",y)),d},Bo}var Co,Xc;function uh(){if(Xc)return Co;Xc=1;var f=Fi(),u=mo(),w=$c();return Co=function(){return w(f,u,arguments)},Co}var Jc;function lh(){return Jc||(Jc=1,(function(f){var u=ch(),w=la(),m=vo(),k=uh();f.exports=function(A){var d=m(arguments),y=A.length-(arguments.length-1);return u(d,1+(y>0?y:0),!0)},w?w(f.exports,"apply",{value:k}):f.exports.apply=k})(To)),To.exports}var $o,Qc;function fh(){if(Qc)return $o;Qc=1;var f=xc();return $o=function(){return f()&&!!Symbol.toStringTag},$o}var Fo,eu;function hh(){if(eu)return Fo;eu=1;var f=nh(),u=ah(),w=lh(),m=zc(),k=$i(),_=jc(),A=m("Object.prototype.toString"),d=fh()(),y=typeof globalThis>"u"?Pi:globalThis,F=u(),D=m("String.prototype.slice"),B=m("Array.prototype.indexOf",!0)||function(ie,K){for(var te=0;te<ie.length;te+=1)if(ie[te]===K)return te;return-1},z={__proto__:null};d&&k&&_?f(F,function(we){var ie=new y[we];if(Symbol.toStringTag in ie&&_){var K=_(ie),te=k(K,Symbol.toStringTag);if(!te&&K){var Q=_(K);te=k(Q,Symbol.toStringTag)}if(te&&te.get){var ge=w(te.get);z["$"+we]=ge}}}):f(F,function(we){var ie=new y[we],K=ie.slice||ie.set;if(K){var te=w(K);z["$"+we]=te}});var j=function(ie){var K=!1;return f(z,function(te,Q){if(!K)try{"$"+te(ie)===Q&&(K=D(Q,1))}catch{}}),K},V=function(ie){var K=!1;return f(z,function(te,Q){if(!K)try{te(ie),K=D(Q,1)}catch{}}),K};return Fo=function(ie){if(!ie||typeof ie!="object")return!1;if(!d){var K=D(A(ie),8,-1);return B(F,K)>-1?K:K!=="Object"?!1:V(ie)}return k?j(ie):null},Fo}var Do,tu;function dh(){if(tu)return Do;tu=1;var f=hh();return Do=function(w){return!!f(w)},Do}var No,ru;function ph(){if(ru)return No;ru=1;var f=Ci(),u=zc(),w=u("TypedArray.prototype.buffer",!0),m=dh();return No=w||function(_){if(!m(_))throw new f("Not a Typed Array");return _.buffer},No}var jo,nu;function mh(){if(nu)return jo;nu=1;var f=ja().Buffer,u=Df(),w=ph(),m=ArrayBuffer.isView||function(y){try{return w(y),!0}catch{return!1}},k=typeof Uint8Array<"u",_=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",A=_&&(f.prototype instanceof Uint8Array||f.TYPED_ARRAY_SUPPORT);return jo=function(y,F){if(f.isBuffer(y))return y.constructor&&!("isBuffer"in y)?f.from(y):y;if(typeof y=="string")return f.from(y,F);if(_&&m(y)){if(y.byteLength===0)return f.alloc(0);if(A){var D=f.from(y.buffer,y.byteOffset,y.byteLength);if(D.byteLength===y.byteLength)return D}var B=y instanceof Uint8Array?y:new Uint8Array(y.buffer,y.byteOffset,y.byteLength),z=f.from(B);if(z.length===y.byteLength)return z}if(k&&y instanceof Uint8Array)return f.from(y);var j=u(y);if(j)for(var V=0;V<y.length;V+=1){var we=y[V];if(typeof we!="number"||we<0||we>255||~~we!==we)throw new RangeError("Array items must be numbers in the range 0-255.")}if(j||f.isBuffer(y)&&y.constructor&&typeof y.constructor.isBuffer=="function"&&y.constructor.isBuffer(y))return f.from(y);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},jo}var Mo,iu;function wh(){if(iu)return Mo;iu=1;var f=ja().Buffer,u=mh();function w(m,k){this._block=f.alloc(m),this._finalSize=k,this._blockSize=m,this._len=0}return w.prototype.update=function(m,k){m=u(m,k||"utf8");for(var _=this._block,A=this._blockSize,d=m.length,y=this._len,F=0;F<d;){for(var D=y%A,B=Math.min(d-F,A-D),z=0;z<B;z++)_[D+z]=m[F+z];y+=B,F+=B,y%A===0&&this._update(_)}return this._len+=d,this},w.prototype.digest=function(m){var k=this._len%this._blockSize;this._block[k]=128,this._block.fill(0,k+1),k>=this._finalSize&&(this._update(this._block),this._block.fill(0));var _=this._len*8;if(_<=4294967295)this._block.writeUInt32BE(_,this._blockSize-4);else{var A=(_&4294967295)>>>0,d=(_-A)/4294967296;this._block.writeUInt32BE(d,this._blockSize-8),this._block.writeUInt32BE(A,this._blockSize-4)}this._update(this._block);var y=this._hash();return m?y.toString(m):y},w.prototype._update=function(){throw new Error("_update must be implemented by subclass")},Mo=w,Mo}var qo,au;function gh(){if(au)return qo;au=1;var f=Bf(),u=wh(),w=ja().Buffer,m=[1518500249,1859775393,-1894007588,-899497514],k=new Array(80);function _(){this.init(),this._w=k,u.call(this,64,56)}f(_,u),_.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function A(D){return D<<1|D>>>31}function d(D){return D<<5|D>>>27}function y(D){return D<<30|D>>>2}function F(D,B,z,j){return D===0?B&z|~B&j:D===2?B&z|B&j|z&j:B^z^j}return _.prototype._update=function(D){for(var B=this._w,z=this._a|0,j=this._b|0,V=this._c|0,we=this._d|0,ie=this._e|0,K=0;K<16;++K)B[K]=D.readInt32BE(K*4);for(;K<80;++K)B[K]=A(B[K-3]^B[K-8]^B[K-14]^B[K-16]);for(var te=0;te<80;++te){var Q=~~(te/20),ge=d(z)+F(Q,j,V,we)+ie+B[te]+m[Q]|0;ie=we,we=V,V=y(j),j=z,z=ge}this._a=z+this._a|0,this._b=j+this._b|0,this._c=V+this._c|0,this._d=we+this._d|0,this._e=ie+this._e|0},_.prototype._hash=function(){var D=w.allocUnsafe(20);return D.writeInt32BE(this._a|0,0),D.writeInt32BE(this._b|0,4),D.writeInt32BE(this._c|0,8),D.writeInt32BE(this._d|0,12),D.writeInt32BE(this._e|0,16),D},qo=_,qo}var Uo={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var ou;function yh(){return ou||(ou=1,(function(f){(function(u){u(typeof DO_NOT_EXPORT_CRC>"u"?f:{})})(function(u){u.version="1.2.2";function w(){for(var fe=0,Ae=new Array(256),pe=0;pe!=256;++pe)fe=pe,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,fe=fe&1?-306674912^fe>>>1:fe>>>1,Ae[pe]=fe;return typeof Int32Array<"u"?new Int32Array(Ae):Ae}var m=w();function k(fe){var Ae=0,pe=0,Be=0,Ce=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Be=0;Be!=256;++Be)Ce[Be]=fe[Be];for(Be=0;Be!=256;++Be)for(pe=fe[Be],Ae=256+Be;Ae<4096;Ae+=256)pe=Ce[Ae]=pe>>>8^fe[pe&255];var Se=[];for(Be=1;Be!=16;++Be)Se[Be-1]=typeof Int32Array<"u"?Ce.subarray(Be*256,Be*256+256):Ce.slice(Be*256,Be*256+256);return Se}var _=k(m),A=_[0],d=_[1],y=_[2],F=_[3],D=_[4],B=_[5],z=_[6],j=_[7],V=_[8],we=_[9],ie=_[10],K=_[11],te=_[12],Q=_[13],ge=_[14];function Te(fe,Ae){for(var pe=Ae^-1,Be=0,Ce=fe.length;Be<Ce;)pe=pe>>>8^m[(pe^fe.charCodeAt(Be++))&255];return~pe}function le(fe,Ae){for(var pe=Ae^-1,Be=fe.length-15,Ce=0;Ce<Be;)pe=ge[fe[Ce++]^pe&255]^Q[fe[Ce++]^pe>>8&255]^te[fe[Ce++]^pe>>16&255]^K[fe[Ce++]^pe>>>24]^ie[fe[Ce++]]^we[fe[Ce++]]^V[fe[Ce++]]^j[fe[Ce++]]^z[fe[Ce++]]^B[fe[Ce++]]^D[fe[Ce++]]^F[fe[Ce++]]^y[fe[Ce++]]^d[fe[Ce++]]^A[fe[Ce++]]^m[fe[Ce++]];for(Be+=15;Ce<Be;)pe=pe>>>8^m[(pe^fe[Ce++])&255];return~pe}function H(fe,Ae){for(var pe=Ae^-1,Be=0,Ce=fe.length,Se=0,Le=0;Be<Ce;)Se=fe.charCodeAt(Be++),Se<128?pe=pe>>>8^m[(pe^Se)&255]:Se<2048?(pe=pe>>>8^m[(pe^(192|Se>>6&31))&255],pe=pe>>>8^m[(pe^(128|Se&63))&255]):Se>=55296&&Se<57344?(Se=(Se&1023)+64,Le=fe.charCodeAt(Be++)&1023,pe=pe>>>8^m[(pe^(240|Se>>8&7))&255],pe=pe>>>8^m[(pe^(128|Se>>2&63))&255],pe=pe>>>8^m[(pe^(128|Le>>6&15|(Se&3)<<4))&255],pe=pe>>>8^m[(pe^(128|Le&63))&255]):(pe=pe>>>8^m[(pe^(224|Se>>12&15))&255],pe=pe>>>8^m[(pe^(128|Se>>6&63))&255],pe=pe>>>8^m[(pe^(128|Se&63))&255]);return~pe}u.table=m,u.bstr=Te,u.buf=le,u.str=H})})(Uo)),Uo}var Lo={},su;function Cn(){return su||(su=1,(function(f){var u=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function w(_,A){return Object.prototype.hasOwnProperty.call(_,A)}f.assign=function(_){for(var A=Array.prototype.slice.call(arguments,1);A.length;){var d=A.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var y in d)w(d,y)&&(_[y]=d[y])}}return _},f.shrinkBuf=function(_,A){return _.length===A?_:_.subarray?_.subarray(0,A):(_.length=A,_)};var m={arraySet:function(_,A,d,y,F){if(A.subarray&&_.subarray){_.set(A.subarray(d,d+y),F);return}for(var D=0;D<y;D++)_[F+D]=A[d+D]},flattenChunks:function(_){var A,d,y,F,D,B;for(y=0,A=0,d=_.length;A<d;A++)y+=_[A].length;for(B=new Uint8Array(y),F=0,A=0,d=_.length;A<d;A++)D=_[A],B.set(D,F),F+=D.length;return B}},k={arraySet:function(_,A,d,y,F){for(var D=0;D<y;D++)_[F+D]=A[d+D]},flattenChunks:function(_){return[].concat.apply([],_)}};f.setTyped=function(_){_?(f.Buf8=Uint8Array,f.Buf16=Uint16Array,f.Buf32=Int32Array,f.assign(f,m)):(f.Buf8=Array,f.Buf16=Array,f.Buf32=Array,f.assign(f,k))},f.setTyped(u)})(Lo)),Lo}var hi={},Qr={},Vn={},cu;function vh(){if(cu)return Vn;cu=1;var f=Cn(),u=4,w=0,m=1,k=2;function _(b){for(var L=b.length;--L>=0;)b[L]=0}var A=0,d=1,y=2,F=3,D=258,B=29,z=256,j=z+1+B,V=30,we=19,ie=2*j+1,K=15,te=16,Q=7,ge=256,Te=16,le=17,H=18,fe=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ae=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ce=512,Se=new Array((j+2)*2);_(Se);var Le=new Array(V*2);_(Le);var ft=new Array(Ce);_(ft);var Ne=new Array(D-F+1);_(Ne);var Re=new Array(B);_(Re);var Fe=new Array(V);_(Fe);function Ue(b,L,J,De,Z){this.static_tree=b,this.extra_bits=L,this.extra_base=J,this.elems=De,this.max_length=Z,this.has_stree=b&&b.length}var mt,pt,gt;function Pt(b,L){this.dyn_tree=b,this.max_code=0,this.stat_desc=L}function Lt(b){return b<256?ft[b]:ft[256+(b>>>7)]}function Mt(b,L){b.pending_buf[b.pending++]=L&255,b.pending_buf[b.pending++]=L>>>8&255}function Et(b,L,J){b.bi_valid>te-J?(b.bi_buf|=L<<b.bi_valid&65535,Mt(b,b.bi_buf),b.bi_buf=L>>te-b.bi_valid,b.bi_valid+=J-te):(b.bi_buf|=L<<b.bi_valid&65535,b.bi_valid+=J)}function ct(b,L,J){Et(b,J[L*2],J[L*2+1])}function ht(b,L){var J=0;do J|=b&1,b>>>=1,J<<=1;while(--L>0);return J>>>1}function kt(b){b.bi_valid===16?(Mt(b,b.bi_buf),b.bi_buf=0,b.bi_valid=0):b.bi_valid>=8&&(b.pending_buf[b.pending++]=b.bi_buf&255,b.bi_buf>>=8,b.bi_valid-=8)}function qe(b,L){var J=L.dyn_tree,De=L.max_code,Z=L.stat_desc.static_tree,W=L.stat_desc.has_stree,S=L.stat_desc.extra_bits,ke=L.stat_desc.extra_base,dt=L.stat_desc.max_length,c,G,Ee,P,X,be,ut=0;for(P=0;P<=K;P++)b.bl_count[P]=0;for(J[b.heap[b.heap_max]*2+1]=0,c=b.heap_max+1;c<ie;c++)G=b.heap[c],P=J[J[G*2+1]*2+1]+1,P>dt&&(P=dt,ut++),J[G*2+1]=P,!(G>De)&&(b.bl_count[P]++,X=0,G>=ke&&(X=S[G-ke]),be=J[G*2],b.opt_len+=be*(P+X),W&&(b.static_len+=be*(Z[G*2+1]+X)));if(ut!==0){do{for(P=dt-1;b.bl_count[P]===0;)P--;b.bl_count[P]--,b.bl_count[P+1]+=2,b.bl_count[dt]--,ut-=2}while(ut>0);for(P=dt;P!==0;P--)for(G=b.bl_count[P];G!==0;)Ee=b.heap[--c],!(Ee>De)&&(J[Ee*2+1]!==P&&(b.opt_len+=(P-J[Ee*2+1])*J[Ee*2],J[Ee*2+1]=P),G--)}}function It(b,L,J){var De=new Array(K+1),Z=0,W,S;for(W=1;W<=K;W++)De[W]=Z=Z+J[W-1]<<1;for(S=0;S<=L;S++){var ke=b[S*2+1];ke!==0&&(b[S*2]=ht(De[ke]++,ke))}}function We(){var b,L,J,De,Z,W=new Array(K+1);for(J=0,De=0;De<B-1;De++)for(Re[De]=J,b=0;b<1<<fe[De];b++)Ne[J++]=De;for(Ne[J-1]=De,Z=0,De=0;De<16;De++)for(Fe[De]=Z,b=0;b<1<<Ae[De];b++)ft[Z++]=De;for(Z>>=7;De<V;De++)for(Fe[De]=Z<<7,b=0;b<1<<Ae[De]-7;b++)ft[256+Z++]=De;for(L=0;L<=K;L++)W[L]=0;for(b=0;b<=143;)Se[b*2+1]=8,b++,W[8]++;for(;b<=255;)Se[b*2+1]=9,b++,W[9]++;for(;b<=279;)Se[b*2+1]=7,b++,W[7]++;for(;b<=287;)Se[b*2+1]=8,b++,W[8]++;for(It(Se,j+1,W),b=0;b<V;b++)Le[b*2+1]=5,Le[b*2]=ht(b,5);mt=new Ue(Se,fe,z+1,j,K),pt=new Ue(Le,Ae,0,V,K),gt=new Ue(new Array(0),pe,0,we,Q)}function vt(b){var L;for(L=0;L<j;L++)b.dyn_ltree[L*2]=0;for(L=0;L<V;L++)b.dyn_dtree[L*2]=0;for(L=0;L<we;L++)b.bl_tree[L*2]=0;b.dyn_ltree[ge*2]=1,b.opt_len=b.static_len=0,b.last_lit=b.matches=0}function Ht(b){b.bi_valid>8?Mt(b,b.bi_buf):b.bi_valid>0&&(b.pending_buf[b.pending++]=b.bi_buf),b.bi_buf=0,b.bi_valid=0}function qt(b,L,J,De){Ht(b),Mt(b,J),Mt(b,~J),f.arraySet(b.pending_buf,b.window,L,J,b.pending),b.pending+=J}function Bt(b,L,J,De){var Z=L*2,W=J*2;return b[Z]<b[W]||b[Z]===b[W]&&De[L]<=De[J]}function _e(b,L,J){for(var De=b.heap[J],Z=J<<1;Z<=b.heap_len&&(Z<b.heap_len&&Bt(L,b.heap[Z+1],b.heap[Z],b.depth)&&Z++,!Bt(L,De,b.heap[Z],b.depth));)b.heap[J]=b.heap[Z],J=Z,Z<<=1;b.heap[J]=De}function bt(b,L,J){var De,Z,W=0,S,ke;if(b.last_lit!==0)do De=b.pending_buf[b.d_buf+W*2]<<8|b.pending_buf[b.d_buf+W*2+1],Z=b.pending_buf[b.l_buf+W],W++,De===0?ct(b,Z,L):(S=Ne[Z],ct(b,S+z+1,L),ke=fe[S],ke!==0&&(Z-=Re[S],Et(b,Z,ke)),De--,S=Lt(De),ct(b,S,J),ke=Ae[S],ke!==0&&(De-=Fe[S],Et(b,De,ke)));while(W<b.last_lit);ct(b,ge,L)}function Wt(b,L){var J=L.dyn_tree,De=L.stat_desc.static_tree,Z=L.stat_desc.has_stree,W=L.stat_desc.elems,S,ke,dt=-1,c;for(b.heap_len=0,b.heap_max=ie,S=0;S<W;S++)J[S*2]!==0?(b.heap[++b.heap_len]=dt=S,b.depth[S]=0):J[S*2+1]=0;for(;b.heap_len<2;)c=b.heap[++b.heap_len]=dt<2?++dt:0,J[c*2]=1,b.depth[c]=0,b.opt_len--,Z&&(b.static_len-=De[c*2+1]);for(L.max_code=dt,S=b.heap_len>>1;S>=1;S--)_e(b,J,S);c=W;do S=b.heap[1],b.heap[1]=b.heap[b.heap_len--],_e(b,J,1),ke=b.heap[1],b.heap[--b.heap_max]=S,b.heap[--b.heap_max]=ke,J[c*2]=J[S*2]+J[ke*2],b.depth[c]=(b.depth[S]>=b.depth[ke]?b.depth[S]:b.depth[ke])+1,J[S*2+1]=J[ke*2+1]=c,b.heap[1]=c++,_e(b,J,1);while(b.heap_len>=2);b.heap[--b.heap_max]=b.heap[1],qe(b,L),It(J,dt,b.bl_count)}function lr(b,L,J){var De,Z=-1,W,S=L[1],ke=0,dt=7,c=4;for(S===0&&(dt=138,c=3),L[(J+1)*2+1]=65535,De=0;De<=J;De++)W=S,S=L[(De+1)*2+1],!(++ke<dt&&W===S)&&(ke<c?b.bl_tree[W*2]+=ke:W!==0?(W!==Z&&b.bl_tree[W*2]++,b.bl_tree[Te*2]++):ke<=10?b.bl_tree[le*2]++:b.bl_tree[H*2]++,ke=0,Z=W,S===0?(dt=138,c=3):W===S?(dt=6,c=3):(dt=7,c=4))}function Ot(b,L,J){var De,Z=-1,W,S=L[1],ke=0,dt=7,c=4;for(S===0&&(dt=138,c=3),De=0;De<=J;De++)if(W=S,S=L[(De+1)*2+1],!(++ke<dt&&W===S)){if(ke<c)do ct(b,W,b.bl_tree);while(--ke!==0);else W!==0?(W!==Z&&(ct(b,W,b.bl_tree),ke--),ct(b,Te,b.bl_tree),Et(b,ke-3,2)):ke<=10?(ct(b,le,b.bl_tree),Et(b,ke-3,3)):(ct(b,H,b.bl_tree),Et(b,ke-11,7));ke=0,Z=W,S===0?(dt=138,c=3):W===S?(dt=6,c=3):(dt=7,c=4)}}function Ft(b){var L;for(lr(b,b.dyn_ltree,b.l_desc.max_code),lr(b,b.dyn_dtree,b.d_desc.max_code),Wt(b,b.bl_desc),L=we-1;L>=3&&b.bl_tree[Be[L]*2+1]===0;L--);return b.opt_len+=3*(L+1)+5+5+4,L}function or(b,L,J,De){var Z;for(Et(b,L-257,5),Et(b,J-1,5),Et(b,De-4,4),Z=0;Z<De;Z++)Et(b,b.bl_tree[Be[Z]*2+1],3);Ot(b,b.dyn_ltree,L-1),Ot(b,b.dyn_dtree,J-1)}function pr(b){var L=4093624447,J;for(J=0;J<=31;J++,L>>>=1)if(L&1&&b.dyn_ltree[J*2]!==0)return w;if(b.dyn_ltree[18]!==0||b.dyn_ltree[20]!==0||b.dyn_ltree[26]!==0)return m;for(J=32;J<z;J++)if(b.dyn_ltree[J*2]!==0)return m;return w}var Gt=!1;function tr(b){Gt||(We(),Gt=!0),b.l_desc=new Pt(b.dyn_ltree,mt),b.d_desc=new Pt(b.dyn_dtree,pt),b.bl_desc=new Pt(b.bl_tree,gt),b.bi_buf=0,b.bi_valid=0,vt(b)}function O(b,L,J,De){Et(b,(A<<1)+(De?1:0),3),qt(b,L,J)}function h(b){Et(b,d<<1,3),ct(b,ge,Se),kt(b)}function v(b,L,J,De){var Z,W,S=0;b.level>0?(b.strm.data_type===k&&(b.strm.data_type=pr(b)),Wt(b,b.l_desc),Wt(b,b.d_desc),S=Ft(b),Z=b.opt_len+3+7>>>3,W=b.static_len+3+7>>>3,W<=Z&&(Z=W)):Z=W=J+5,J+4<=Z&&L!==-1?O(b,L,J,De):b.strategy===u||W===Z?(Et(b,(d<<1)+(De?1:0),3),bt(b,Se,Le)):(Et(b,(y<<1)+(De?1:0),3),or(b,b.l_desc.max_code+1,b.d_desc.max_code+1,S+1),bt(b,b.dyn_ltree,b.dyn_dtree)),vt(b),De&&Ht(b)}function U(b,L,J){return b.pending_buf[b.d_buf+b.last_lit*2]=L>>>8&255,b.pending_buf[b.d_buf+b.last_lit*2+1]=L&255,b.pending_buf[b.l_buf+b.last_lit]=J&255,b.last_lit++,L===0?b.dyn_ltree[J*2]++:(b.matches++,L--,b.dyn_ltree[(Ne[J]+z+1)*2]++,b.dyn_dtree[Lt(L)*2]++),b.last_lit===b.lit_bufsize-1}return Vn._tr_init=tr,Vn._tr_stored_block=O,Vn._tr_flush_block=v,Vn._tr_tally=U,Vn._tr_align=h,Vn}var zo,uu;function lu(){if(uu)return zo;uu=1;function f(u,w,m,k){for(var _=u&65535|0,A=u>>>16&65535|0,d=0;m!==0;){d=m>2e3?2e3:m,m-=d;do _=_+w[k++]|0,A=A+_|0;while(--d);_%=65521,A%=65521}return _|A<<16|0}return zo=f,zo}var Ho,fu;function hu(){if(fu)return Ho;fu=1;function f(){for(var m,k=[],_=0;_<256;_++){m=_;for(var A=0;A<8;A++)m=m&1?3988292384^m>>>1:m>>>1;k[_]=m}return k}var u=f();function w(m,k,_,A){var d=u,y=A+_;m^=-1;for(var F=A;F<y;F++)m=m>>>8^d[(m^k[F])&255];return m^-1}return Ho=w,Ho}var Go,du;function Ko(){return du||(du=1,Go={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),Go}var pu;function bh(){if(pu)return Qr;pu=1;var f=Cn(),u=vh(),w=lu(),m=hu(),k=Ko(),_=0,A=1,d=3,y=4,F=5,D=0,B=1,z=-2,j=-3,V=-5,we=-1,ie=1,K=2,te=3,Q=4,ge=0,Te=2,le=8,H=9,fe=15,Ae=8,pe=29,Be=256,Ce=Be+1+pe,Se=30,Le=19,ft=2*Ce+1,Ne=15,Re=3,Fe=258,Ue=Fe+Re+1,mt=32,pt=42,gt=69,Pt=73,Lt=91,Mt=103,Et=113,ct=666,ht=1,kt=2,qe=3,It=4,We=3;function vt(c,G){return c.msg=k[G],G}function Ht(c){return(c<<1)-(c>4?9:0)}function qt(c){for(var G=c.length;--G>=0;)c[G]=0}function Bt(c){var G=c.state,Ee=G.pending;Ee>c.avail_out&&(Ee=c.avail_out),Ee!==0&&(f.arraySet(c.output,G.pending_buf,G.pending_out,Ee,c.next_out),c.next_out+=Ee,G.pending_out+=Ee,c.total_out+=Ee,c.avail_out-=Ee,G.pending-=Ee,G.pending===0&&(G.pending_out=0))}function _e(c,G){u._tr_flush_block(c,c.block_start>=0?c.block_start:-1,c.strstart-c.block_start,G),c.block_start=c.strstart,Bt(c.strm)}function bt(c,G){c.pending_buf[c.pending++]=G}function Wt(c,G){c.pending_buf[c.pending++]=G>>>8&255,c.pending_buf[c.pending++]=G&255}function lr(c,G,Ee,P){var X=c.avail_in;return X>P&&(X=P),X===0?0:(c.avail_in-=X,f.arraySet(G,c.input,c.next_in,X,Ee),c.state.wrap===1?c.adler=w(c.adler,G,X,Ee):c.state.wrap===2&&(c.adler=m(c.adler,G,X,Ee)),c.next_in+=X,c.total_in+=X,X)}function Ot(c,G){var Ee=c.max_chain_length,P=c.strstart,X,be,ut=c.prev_length,Qe=c.nice_match,Ge=c.strstart>c.w_size-Ue?c.strstart-(c.w_size-Ue):0,yt=c.window,Sr=c.w_mask,zt=c.prev,lt=c.strstart+Fe,Rt=yt[P+ut-1],fr=yt[P+ut];c.prev_length>=c.good_match&&(Ee>>=2),Qe>c.lookahead&&(Qe=c.lookahead);do if(X=G,!(yt[X+ut]!==fr||yt[X+ut-1]!==Rt||yt[X]!==yt[P]||yt[++X]!==yt[P+1])){P+=2,X++;do;while(yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&yt[++P]===yt[++X]&&P<lt);if(be=Fe-(lt-P),P=lt-Fe,be>ut){if(c.match_start=G,ut=be,be>=Qe)break;Rt=yt[P+ut-1],fr=yt[P+ut]}}while((G=zt[G&Sr])>Ge&&--Ee!==0);return ut<=c.lookahead?ut:c.lookahead}function Ft(c){var G=c.w_size,Ee,P,X,be,ut;do{if(be=c.window_size-c.lookahead-c.strstart,c.strstart>=G+(G-Ue)){f.arraySet(c.window,c.window,G,G,0),c.match_start-=G,c.strstart-=G,c.block_start-=G,P=c.hash_size,Ee=P;do X=c.head[--Ee],c.head[Ee]=X>=G?X-G:0;while(--P);P=G,Ee=P;do X=c.prev[--Ee],c.prev[Ee]=X>=G?X-G:0;while(--P);be+=G}if(c.strm.avail_in===0)break;if(P=lr(c.strm,c.window,c.strstart+c.lookahead,be),c.lookahead+=P,c.lookahead+c.insert>=Re)for(ut=c.strstart-c.insert,c.ins_h=c.window[ut],c.ins_h=(c.ins_h<<c.hash_shift^c.window[ut+1])&c.hash_mask;c.insert&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[ut+Re-1])&c.hash_mask,c.prev[ut&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=ut,ut++,c.insert--,!(c.lookahead+c.insert<Re)););}while(c.lookahead<Ue&&c.strm.avail_in!==0)}function or(c,G){var Ee=65535;for(Ee>c.pending_buf_size-5&&(Ee=c.pending_buf_size-5);;){if(c.lookahead<=1){if(Ft(c),c.lookahead===0&&G===_)return ht;if(c.lookahead===0)break}c.strstart+=c.lookahead,c.lookahead=0;var P=c.block_start+Ee;if((c.strstart===0||c.strstart>=P)&&(c.lookahead=c.strstart-P,c.strstart=P,_e(c,!1),c.strm.avail_out===0)||c.strstart-c.block_start>=c.w_size-Ue&&(_e(c,!1),c.strm.avail_out===0))return ht}return c.insert=0,G===y?(_e(c,!0),c.strm.avail_out===0?qe:It):(c.strstart>c.block_start&&(_e(c,!1),c.strm.avail_out===0),ht)}function pr(c,G){for(var Ee,P;;){if(c.lookahead<Ue){if(Ft(c),c.lookahead<Ue&&G===_)return ht;if(c.lookahead===0)break}if(Ee=0,c.lookahead>=Re&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+Re-1])&c.hash_mask,Ee=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),Ee!==0&&c.strstart-Ee<=c.w_size-Ue&&(c.match_length=Ot(c,Ee)),c.match_length>=Re)if(P=u._tr_tally(c,c.strstart-c.match_start,c.match_length-Re),c.lookahead-=c.match_length,c.match_length<=c.max_lazy_match&&c.lookahead>=Re){c.match_length--;do c.strstart++,c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+Re-1])&c.hash_mask,Ee=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart;while(--c.match_length!==0);c.strstart++}else c.strstart+=c.match_length,c.match_length=0,c.ins_h=c.window[c.strstart],c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+1])&c.hash_mask;else P=u._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++;if(P&&(_e(c,!1),c.strm.avail_out===0))return ht}return c.insert=c.strstart<Re-1?c.strstart:Re-1,G===y?(_e(c,!0),c.strm.avail_out===0?qe:It):c.last_lit&&(_e(c,!1),c.strm.avail_out===0)?ht:kt}function Gt(c,G){for(var Ee,P,X;;){if(c.lookahead<Ue){if(Ft(c),c.lookahead<Ue&&G===_)return ht;if(c.lookahead===0)break}if(Ee=0,c.lookahead>=Re&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+Re-1])&c.hash_mask,Ee=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart),c.prev_length=c.match_length,c.prev_match=c.match_start,c.match_length=Re-1,Ee!==0&&c.prev_length<c.max_lazy_match&&c.strstart-Ee<=c.w_size-Ue&&(c.match_length=Ot(c,Ee),c.match_length<=5&&(c.strategy===ie||c.match_length===Re&&c.strstart-c.match_start>4096)&&(c.match_length=Re-1)),c.prev_length>=Re&&c.match_length<=c.prev_length){X=c.strstart+c.lookahead-Re,P=u._tr_tally(c,c.strstart-1-c.prev_match,c.prev_length-Re),c.lookahead-=c.prev_length-1,c.prev_length-=2;do++c.strstart<=X&&(c.ins_h=(c.ins_h<<c.hash_shift^c.window[c.strstart+Re-1])&c.hash_mask,Ee=c.prev[c.strstart&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=c.strstart);while(--c.prev_length!==0);if(c.match_available=0,c.match_length=Re-1,c.strstart++,P&&(_e(c,!1),c.strm.avail_out===0))return ht}else if(c.match_available){if(P=u._tr_tally(c,0,c.window[c.strstart-1]),P&&_e(c,!1),c.strstart++,c.lookahead--,c.strm.avail_out===0)return ht}else c.match_available=1,c.strstart++,c.lookahead--}return c.match_available&&(P=u._tr_tally(c,0,c.window[c.strstart-1]),c.match_available=0),c.insert=c.strstart<Re-1?c.strstart:Re-1,G===y?(_e(c,!0),c.strm.avail_out===0?qe:It):c.last_lit&&(_e(c,!1),c.strm.avail_out===0)?ht:kt}function tr(c,G){for(var Ee,P,X,be,ut=c.window;;){if(c.lookahead<=Fe){if(Ft(c),c.lookahead<=Fe&&G===_)return ht;if(c.lookahead===0)break}if(c.match_length=0,c.lookahead>=Re&&c.strstart>0&&(X=c.strstart-1,P=ut[X],P===ut[++X]&&P===ut[++X]&&P===ut[++X])){be=c.strstart+Fe;do;while(P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&P===ut[++X]&&X<be);c.match_length=Fe-(be-X),c.match_length>c.lookahead&&(c.match_length=c.lookahead)}if(c.match_length>=Re?(Ee=u._tr_tally(c,1,c.match_length-Re),c.lookahead-=c.match_length,c.strstart+=c.match_length,c.match_length=0):(Ee=u._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++),Ee&&(_e(c,!1),c.strm.avail_out===0))return ht}return c.insert=0,G===y?(_e(c,!0),c.strm.avail_out===0?qe:It):c.last_lit&&(_e(c,!1),c.strm.avail_out===0)?ht:kt}function O(c,G){for(var Ee;;){if(c.lookahead===0&&(Ft(c),c.lookahead===0)){if(G===_)return ht;break}if(c.match_length=0,Ee=u._tr_tally(c,0,c.window[c.strstart]),c.lookahead--,c.strstart++,Ee&&(_e(c,!1),c.strm.avail_out===0))return ht}return c.insert=0,G===y?(_e(c,!0),c.strm.avail_out===0?qe:It):c.last_lit&&(_e(c,!1),c.strm.avail_out===0)?ht:kt}function h(c,G,Ee,P,X){this.good_length=c,this.max_lazy=G,this.nice_length=Ee,this.max_chain=P,this.func=X}var v;v=[new h(0,0,0,0,or),new h(4,4,8,4,pr),new h(4,5,16,8,pr),new h(4,6,32,32,pr),new h(4,4,16,16,Gt),new h(8,16,32,32,Gt),new h(8,16,128,128,Gt),new h(8,32,128,256,Gt),new h(32,128,258,1024,Gt),new h(32,258,258,4096,Gt)];function U(c){c.window_size=2*c.w_size,qt(c.head),c.max_lazy_match=v[c.level].max_lazy,c.good_match=v[c.level].good_length,c.nice_match=v[c.level].nice_length,c.max_chain_length=v[c.level].max_chain,c.strstart=0,c.block_start=0,c.lookahead=0,c.insert=0,c.match_length=c.prev_length=Re-1,c.match_available=0,c.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=le,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(ft*2),this.dyn_dtree=new f.Buf16((2*Se+1)*2),this.bl_tree=new f.Buf16((2*Le+1)*2),qt(this.dyn_ltree),qt(this.dyn_dtree),qt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(Ne+1),this.heap=new f.Buf16(2*Ce+1),qt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*Ce+1),qt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function L(c){var G;return!c||!c.state?vt(c,z):(c.total_in=c.total_out=0,c.data_type=Te,G=c.state,G.pending=0,G.pending_out=0,G.wrap<0&&(G.wrap=-G.wrap),G.status=G.wrap?pt:Et,c.adler=G.wrap===2?0:1,G.last_flush=_,u._tr_init(G),D)}function J(c){var G=L(c);return G===D&&U(c.state),G}function De(c,G){return!c||!c.state||c.state.wrap!==2?z:(c.state.gzhead=G,D)}function Z(c,G,Ee,P,X,be){if(!c)return z;var ut=1;if(G===we&&(G=6),P<0?(ut=0,P=-P):P>15&&(ut=2,P-=16),X<1||X>H||Ee!==le||P<8||P>15||G<0||G>9||be<0||be>Q)return vt(c,z);P===8&&(P=9);var Qe=new b;return c.state=Qe,Qe.strm=c,Qe.wrap=ut,Qe.gzhead=null,Qe.w_bits=P,Qe.w_size=1<<Qe.w_bits,Qe.w_mask=Qe.w_size-1,Qe.hash_bits=X+7,Qe.hash_size=1<<Qe.hash_bits,Qe.hash_mask=Qe.hash_size-1,Qe.hash_shift=~~((Qe.hash_bits+Re-1)/Re),Qe.window=new f.Buf8(Qe.w_size*2),Qe.head=new f.Buf16(Qe.hash_size),Qe.prev=new f.Buf16(Qe.w_size),Qe.lit_bufsize=1<<X+6,Qe.pending_buf_size=Qe.lit_bufsize*4,Qe.pending_buf=new f.Buf8(Qe.pending_buf_size),Qe.d_buf=1*Qe.lit_bufsize,Qe.l_buf=3*Qe.lit_bufsize,Qe.level=G,Qe.strategy=be,Qe.method=Ee,J(c)}function W(c,G){return Z(c,G,le,fe,Ae,ge)}function S(c,G){var Ee,P,X,be;if(!c||!c.state||G>F||G<0)return c?vt(c,z):z;if(P=c.state,!c.output||!c.input&&c.avail_in!==0||P.status===ct&&G!==y)return vt(c,c.avail_out===0?V:z);if(P.strm=c,Ee=P.last_flush,P.last_flush=G,P.status===pt)if(P.wrap===2)c.adler=0,bt(P,31),bt(P,139),bt(P,8),P.gzhead?(bt(P,(P.gzhead.text?1:0)+(P.gzhead.hcrc?2:0)+(P.gzhead.extra?4:0)+(P.gzhead.name?8:0)+(P.gzhead.comment?16:0)),bt(P,P.gzhead.time&255),bt(P,P.gzhead.time>>8&255),bt(P,P.gzhead.time>>16&255),bt(P,P.gzhead.time>>24&255),bt(P,P.level===9?2:P.strategy>=K||P.level<2?4:0),bt(P,P.gzhead.os&255),P.gzhead.extra&&P.gzhead.extra.length&&(bt(P,P.gzhead.extra.length&255),bt(P,P.gzhead.extra.length>>8&255)),P.gzhead.hcrc&&(c.adler=m(c.adler,P.pending_buf,P.pending,0)),P.gzindex=0,P.status=gt):(bt(P,0),bt(P,0),bt(P,0),bt(P,0),bt(P,0),bt(P,P.level===9?2:P.strategy>=K||P.level<2?4:0),bt(P,We),P.status=Et);else{var ut=le+(P.w_bits-8<<4)<<8,Qe=-1;P.strategy>=K||P.level<2?Qe=0:P.level<6?Qe=1:P.level===6?Qe=2:Qe=3,ut|=Qe<<6,P.strstart!==0&&(ut|=mt),ut+=31-ut%31,P.status=Et,Wt(P,ut),P.strstart!==0&&(Wt(P,c.adler>>>16),Wt(P,c.adler&65535)),c.adler=1}if(P.status===gt)if(P.gzhead.extra){for(X=P.pending;P.gzindex<(P.gzhead.extra.length&65535)&&!(P.pending===P.pending_buf_size&&(P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),Bt(c),X=P.pending,P.pending===P.pending_buf_size));)bt(P,P.gzhead.extra[P.gzindex]&255),P.gzindex++;P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),P.gzindex===P.gzhead.extra.length&&(P.gzindex=0,P.status=Pt)}else P.status=Pt;if(P.status===Pt)if(P.gzhead.name){X=P.pending;do{if(P.pending===P.pending_buf_size&&(P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),Bt(c),X=P.pending,P.pending===P.pending_buf_size)){be=1;break}P.gzindex<P.gzhead.name.length?be=P.gzhead.name.charCodeAt(P.gzindex++)&255:be=0,bt(P,be)}while(be!==0);P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),be===0&&(P.gzindex=0,P.status=Lt)}else P.status=Lt;if(P.status===Lt)if(P.gzhead.comment){X=P.pending;do{if(P.pending===P.pending_buf_size&&(P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),Bt(c),X=P.pending,P.pending===P.pending_buf_size)){be=1;break}P.gzindex<P.gzhead.comment.length?be=P.gzhead.comment.charCodeAt(P.gzindex++)&255:be=0,bt(P,be)}while(be!==0);P.gzhead.hcrc&&P.pending>X&&(c.adler=m(c.adler,P.pending_buf,P.pending-X,X)),be===0&&(P.status=Mt)}else P.status=Mt;if(P.status===Mt&&(P.gzhead.hcrc?(P.pending+2>P.pending_buf_size&&Bt(c),P.pending+2<=P.pending_buf_size&&(bt(P,c.adler&255),bt(P,c.adler>>8&255),c.adler=0,P.status=Et)):P.status=Et),P.pending!==0){if(Bt(c),c.avail_out===0)return P.last_flush=-1,D}else if(c.avail_in===0&&Ht(G)<=Ht(Ee)&&G!==y)return vt(c,V);if(P.status===ct&&c.avail_in!==0)return vt(c,V);if(c.avail_in!==0||P.lookahead!==0||G!==_&&P.status!==ct){var Ge=P.strategy===K?O(P,G):P.strategy===te?tr(P,G):v[P.level].func(P,G);if((Ge===qe||Ge===It)&&(P.status=ct),Ge===ht||Ge===qe)return c.avail_out===0&&(P.last_flush=-1),D;if(Ge===kt&&(G===A?u._tr_align(P):G!==F&&(u._tr_stored_block(P,0,0,!1),G===d&&(qt(P.head),P.lookahead===0&&(P.strstart=0,P.block_start=0,P.insert=0))),Bt(c),c.avail_out===0))return P.last_flush=-1,D}return G!==y?D:P.wrap<=0?B:(P.wrap===2?(bt(P,c.adler&255),bt(P,c.adler>>8&255),bt(P,c.adler>>16&255),bt(P,c.adler>>24&255),bt(P,c.total_in&255),bt(P,c.total_in>>8&255),bt(P,c.total_in>>16&255),bt(P,c.total_in>>24&255)):(Wt(P,c.adler>>>16),Wt(P,c.adler&65535)),Bt(c),P.wrap>0&&(P.wrap=-P.wrap),P.pending!==0?D:B)}function ke(c){var G;return!c||!c.state?z:(G=c.state.status,G!==pt&&G!==gt&&G!==Pt&&G!==Lt&&G!==Mt&&G!==Et&&G!==ct?vt(c,z):(c.state=null,G===Et?vt(c,j):D))}function dt(c,G){var Ee=G.length,P,X,be,ut,Qe,Ge,yt,Sr;if(!c||!c.state||(P=c.state,ut=P.wrap,ut===2||ut===1&&P.status!==pt||P.lookahead))return z;for(ut===1&&(c.adler=w(c.adler,G,Ee,0)),P.wrap=0,Ee>=P.w_size&&(ut===0&&(qt(P.head),P.strstart=0,P.block_start=0,P.insert=0),Sr=new f.Buf8(P.w_size),f.arraySet(Sr,G,Ee-P.w_size,P.w_size,0),G=Sr,Ee=P.w_size),Qe=c.avail_in,Ge=c.next_in,yt=c.input,c.avail_in=Ee,c.next_in=0,c.input=G,Ft(P);P.lookahead>=Re;){X=P.strstart,be=P.lookahead-(Re-1);do P.ins_h=(P.ins_h<<P.hash_shift^P.window[X+Re-1])&P.hash_mask,P.prev[X&P.w_mask]=P.head[P.ins_h],P.head[P.ins_h]=X,X++;while(--be);P.strstart=X,P.lookahead=Re-1,Ft(P)}return P.strstart+=P.lookahead,P.block_start=P.strstart,P.insert=P.lookahead,P.lookahead=0,P.match_length=P.prev_length=Re-1,P.match_available=0,c.next_in=Ge,c.input=yt,c.avail_in=Qe,P.wrap=ut,D}return Qr.deflateInit=W,Qr.deflateInit2=Z,Qr.deflateReset=J,Qr.deflateResetKeep=L,Qr.deflateSetHeader=De,Qr.deflate=S,Qr.deflateEnd=ke,Qr.deflateSetDictionary=dt,Qr.deflateInfo="pako deflate (from Nodeca project)",Qr}var Yn={},mu;function wu(){if(mu)return Yn;mu=1;var f=Cn(),u=!0,w=!0;try{String.fromCharCode.apply(null,[0])}catch{u=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{w=!1}for(var m=new f.Buf8(256),k=0;k<256;k++)m[k]=k>=252?6:k>=248?5:k>=240?4:k>=224?3:k>=192?2:1;m[254]=m[254]=1,Yn.string2buf=function(A){var d,y,F,D,B,z=A.length,j=0;for(D=0;D<z;D++)y=A.charCodeAt(D),(y&64512)===55296&&D+1<z&&(F=A.charCodeAt(D+1),(F&64512)===56320&&(y=65536+(y-55296<<10)+(F-56320),D++)),j+=y<128?1:y<2048?2:y<65536?3:4;for(d=new f.Buf8(j),B=0,D=0;B<j;D++)y=A.charCodeAt(D),(y&64512)===55296&&D+1<z&&(F=A.charCodeAt(D+1),(F&64512)===56320&&(y=65536+(y-55296<<10)+(F-56320),D++)),y<128?d[B++]=y:y<2048?(d[B++]=192|y>>>6,d[B++]=128|y&63):y<65536?(d[B++]=224|y>>>12,d[B++]=128|y>>>6&63,d[B++]=128|y&63):(d[B++]=240|y>>>18,d[B++]=128|y>>>12&63,d[B++]=128|y>>>6&63,d[B++]=128|y&63);return d};function _(A,d){if(d<65534&&(A.subarray&&w||!A.subarray&&u))return String.fromCharCode.apply(null,f.shrinkBuf(A,d));for(var y="",F=0;F<d;F++)y+=String.fromCharCode(A[F]);return y}return Yn.buf2binstring=function(A){return _(A,A.length)},Yn.binstring2buf=function(A){for(var d=new f.Buf8(A.length),y=0,F=d.length;y<F;y++)d[y]=A.charCodeAt(y);return d},Yn.buf2string=function(A,d){var y,F,D,B,z=d||A.length,j=new Array(z*2);for(F=0,y=0;y<z;){if(D=A[y++],D<128){j[F++]=D;continue}if(B=m[D],B>4){j[F++]=65533,y+=B-1;continue}for(D&=B===2?31:B===3?15:7;B>1&&y<z;)D=D<<6|A[y++]&63,B--;if(B>1){j[F++]=65533;continue}D<65536?j[F++]=D:(D-=65536,j[F++]=55296|D>>10&1023,j[F++]=56320|D&1023)}return _(j,F)},Yn.utf8border=function(A,d){var y;for(d=d||A.length,d>A.length&&(d=A.length),y=d-1;y>=0&&(A[y]&192)===128;)y--;return y<0||y===0?d:y+m[A[y]]>d?y:d},Yn}var Wo,gu;function yu(){if(gu)return Wo;gu=1;function f(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return Wo=f,Wo}var vu;function _h(){if(vu)return hi;vu=1;var f=bh(),u=Cn(),w=wu(),m=Ko(),k=yu(),_=Object.prototype.toString,A=0,d=4,y=0,F=1,D=2,B=-1,z=0,j=8;function V(te){if(!(this instanceof V))return new V(te);this.options=u.assign({level:B,method:j,chunkSize:16384,windowBits:15,memLevel:8,strategy:z,to:""},te||{});var Q=this.options;Q.raw&&Q.windowBits>0?Q.windowBits=-Q.windowBits:Q.gzip&&Q.windowBits>0&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var ge=f.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(ge!==y)throw new Error(m[ge]);if(Q.header&&f.deflateSetHeader(this.strm,Q.header),Q.dictionary){var Te;if(typeof Q.dictionary=="string"?Te=w.string2buf(Q.dictionary):_.call(Q.dictionary)==="[object ArrayBuffer]"?Te=new Uint8Array(Q.dictionary):Te=Q.dictionary,ge=f.deflateSetDictionary(this.strm,Te),ge!==y)throw new Error(m[ge]);this._dict_set=!0}}V.prototype.push=function(te,Q){var ge=this.strm,Te=this.options.chunkSize,le,H;if(this.ended)return!1;H=Q===~~Q?Q:Q===!0?d:A,typeof te=="string"?ge.input=w.string2buf(te):_.call(te)==="[object ArrayBuffer]"?ge.input=new Uint8Array(te):ge.input=te,ge.next_in=0,ge.avail_in=ge.input.length;do{if(ge.avail_out===0&&(ge.output=new u.Buf8(Te),ge.next_out=0,ge.avail_out=Te),le=f.deflate(ge,H),le!==F&&le!==y)return this.onEnd(le),this.ended=!0,!1;(ge.avail_out===0||ge.avail_in===0&&(H===d||H===D))&&(this.options.to==="string"?this.onData(w.buf2binstring(u.shrinkBuf(ge.output,ge.next_out))):this.onData(u.shrinkBuf(ge.output,ge.next_out)))}while((ge.avail_in>0||ge.avail_out===0)&&le!==F);return H===d?(le=f.deflateEnd(this.strm),this.onEnd(le),this.ended=!0,le===y):(H===D&&(this.onEnd(y),ge.avail_out=0),!0)},V.prototype.onData=function(te){this.chunks.push(te)},V.prototype.onEnd=function(te){te===y&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=te,this.msg=this.strm.msg};function we(te,Q){var ge=new V(Q);if(ge.push(te,!0),ge.err)throw ge.msg||m[ge.err];return ge.result}function ie(te,Q){return Q=Q||{},Q.raw=!0,we(te,Q)}function K(te,Q){return Q=Q||{},Q.gzip=!0,we(te,Q)}return hi.Deflate=V,hi.deflate=we,hi.deflateRaw=ie,hi.gzip=K,hi}var di={},Mr={},Zo,bu;function xh(){if(bu)return Zo;bu=1;var f=30,u=12;return Zo=function(m,k){var _,A,d,y,F,D,B,z,j,V,we,ie,K,te,Q,ge,Te,le,H,fe,Ae,pe,Be,Ce,Se;_=m.state,A=m.next_in,Ce=m.input,d=A+(m.avail_in-5),y=m.next_out,Se=m.output,F=y-(k-m.avail_out),D=y+(m.avail_out-257),B=_.dmax,z=_.wsize,j=_.whave,V=_.wnext,we=_.window,ie=_.hold,K=_.bits,te=_.lencode,Q=_.distcode,ge=(1<<_.lenbits)-1,Te=(1<<_.distbits)-1;e:do{K<15&&(ie+=Ce[A++]<<K,K+=8,ie+=Ce[A++]<<K,K+=8),le=te[ie&ge];t:for(;;){if(H=le>>>24,ie>>>=H,K-=H,H=le>>>16&255,H===0)Se[y++]=le&65535;else if(H&16){fe=le&65535,H&=15,H&&(K<H&&(ie+=Ce[A++]<<K,K+=8),fe+=ie&(1<<H)-1,ie>>>=H,K-=H),K<15&&(ie+=Ce[A++]<<K,K+=8,ie+=Ce[A++]<<K,K+=8),le=Q[ie&Te];r:for(;;){if(H=le>>>24,ie>>>=H,K-=H,H=le>>>16&255,H&16){if(Ae=le&65535,H&=15,K<H&&(ie+=Ce[A++]<<K,K+=8,K<H&&(ie+=Ce[A++]<<K,K+=8)),Ae+=ie&(1<<H)-1,Ae>B){m.msg="invalid distance too far back",_.mode=f;break e}if(ie>>>=H,K-=H,H=y-F,Ae>H){if(H=Ae-H,H>j&&_.sane){m.msg="invalid distance too far back",_.mode=f;break e}if(pe=0,Be=we,V===0){if(pe+=z-H,H<fe){fe-=H;do Se[y++]=we[pe++];while(--H);pe=y-Ae,Be=Se}}else if(V<H){if(pe+=z+V-H,H-=V,H<fe){fe-=H;do Se[y++]=we[pe++];while(--H);if(pe=0,V<fe){H=V,fe-=H;do Se[y++]=we[pe++];while(--H);pe=y-Ae,Be=Se}}}else if(pe+=V-H,H<fe){fe-=H;do Se[y++]=we[pe++];while(--H);pe=y-Ae,Be=Se}for(;fe>2;)Se[y++]=Be[pe++],Se[y++]=Be[pe++],Se[y++]=Be[pe++],fe-=3;fe&&(Se[y++]=Be[pe++],fe>1&&(Se[y++]=Be[pe++]))}else{pe=y-Ae;do Se[y++]=Se[pe++],Se[y++]=Se[pe++],Se[y++]=Se[pe++],fe-=3;while(fe>2);fe&&(Se[y++]=Se[pe++],fe>1&&(Se[y++]=Se[pe++]))}}else if((H&64)===0){le=Q[(le&65535)+(ie&(1<<H)-1)];continue r}else{m.msg="invalid distance code",_.mode=f;break e}break}}else if((H&64)===0){le=te[(le&65535)+(ie&(1<<H)-1)];continue t}else if(H&32){_.mode=u;break e}else{m.msg="invalid literal/length code",_.mode=f;break e}break}}while(A<d&&y<D);fe=K>>3,A-=fe,K-=fe<<3,ie&=(1<<K)-1,m.next_in=A,m.next_out=y,m.avail_in=A<d?5+(d-A):5-(A-d),m.avail_out=y<D?257+(D-y):257-(y-D),_.hold=ie,_.bits=K},Zo}var Vo,_u;function Eh(){if(_u)return Vo;_u=1;var f=Cn(),u=15,w=852,m=592,k=0,_=1,A=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return Vo=function(z,j,V,we,ie,K,te,Q){var ge=Q.bits,Te=0,le=0,H=0,fe=0,Ae=0,pe=0,Be=0,Ce=0,Se=0,Le=0,ft,Ne,Re,Fe,Ue,mt=null,pt=0,gt,Pt=new f.Buf16(u+1),Lt=new f.Buf16(u+1),Mt=null,Et=0,ct,ht,kt;for(Te=0;Te<=u;Te++)Pt[Te]=0;for(le=0;le<we;le++)Pt[j[V+le]]++;for(Ae=ge,fe=u;fe>=1&&Pt[fe]===0;fe--);if(Ae>fe&&(Ae=fe),fe===0)return ie[K++]=20971520,ie[K++]=20971520,Q.bits=1,0;for(H=1;H<fe&&Pt[H]===0;H++);for(Ae<H&&(Ae=H),Ce=1,Te=1;Te<=u;Te++)if(Ce<<=1,Ce-=Pt[Te],Ce<0)return-1;if(Ce>0&&(z===k||fe!==1))return-1;for(Lt[1]=0,Te=1;Te<u;Te++)Lt[Te+1]=Lt[Te]+Pt[Te];for(le=0;le<we;le++)j[V+le]!==0&&(te[Lt[j[V+le]]++]=le);if(z===k?(mt=Mt=te,gt=19):z===_?(mt=d,pt-=257,Mt=y,Et-=257,gt=256):(mt=F,Mt=D,gt=-1),Le=0,le=0,Te=H,Ue=K,pe=Ae,Be=0,Re=-1,Se=1<<Ae,Fe=Se-1,z===_&&Se>w||z===A&&Se>m)return 1;for(;;){ct=Te-Be,te[le]<gt?(ht=0,kt=te[le]):te[le]>gt?(ht=Mt[Et+te[le]],kt=mt[pt+te[le]]):(ht=96,kt=0),ft=1<<Te-Be,Ne=1<<pe,H=Ne;do Ne-=ft,ie[Ue+(Le>>Be)+Ne]=ct<<24|ht<<16|kt|0;while(Ne!==0);for(ft=1<<Te-1;Le&ft;)ft>>=1;if(ft!==0?(Le&=ft-1,Le+=ft):Le=0,le++,--Pt[Te]===0){if(Te===fe)break;Te=j[V+te[le]]}if(Te>Ae&&(Le&Fe)!==Re){for(Be===0&&(Be=Ae),Ue+=H,pe=Te-Be,Ce=1<<pe;pe+Be<fe&&(Ce-=Pt[pe+Be],!(Ce<=0));)pe++,Ce<<=1;if(Se+=1<<pe,z===_&&Se>w||z===A&&Se>m)return 1;Re=Le&Fe,ie[Re]=Ae<<24|pe<<16|Ue-K|0}}return Le!==0&&(ie[Ue+Le]=Te-Be<<24|4194304|0),Q.bits=Ae,0},Vo}var xu;function Ah(){if(xu)return Mr;xu=1;var f=Cn(),u=lu(),w=hu(),m=xh(),k=Eh(),_=0,A=1,d=2,y=4,F=5,D=6,B=0,z=1,j=2,V=-2,we=-3,ie=-4,K=-5,te=8,Q=1,ge=2,Te=3,le=4,H=5,fe=6,Ae=7,pe=8,Be=9,Ce=10,Se=11,Le=12,ft=13,Ne=14,Re=15,Fe=16,Ue=17,mt=18,pt=19,gt=20,Pt=21,Lt=22,Mt=23,Et=24,ct=25,ht=26,kt=27,qe=28,It=29,We=30,vt=31,Ht=32,qt=852,Bt=592,_e=15,bt=_e;function Wt(Z){return(Z>>>24&255)+(Z>>>8&65280)+((Z&65280)<<8)+((Z&255)<<24)}function lr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Ot(Z){var W;return!Z||!Z.state?V:(W=Z.state,Z.total_in=Z.total_out=W.total=0,Z.msg="",W.wrap&&(Z.adler=W.wrap&1),W.mode=Q,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new f.Buf32(qt),W.distcode=W.distdyn=new f.Buf32(Bt),W.sane=1,W.back=-1,B)}function Ft(Z){var W;return!Z||!Z.state?V:(W=Z.state,W.wsize=0,W.whave=0,W.wnext=0,Ot(Z))}function or(Z,W){var S,ke;return!Z||!Z.state||(ke=Z.state,W<0?(S=0,W=-W):(S=(W>>4)+1,W<48&&(W&=15)),W&&(W<8||W>15))?V:(ke.window!==null&&ke.wbits!==W&&(ke.window=null),ke.wrap=S,ke.wbits=W,Ft(Z))}function pr(Z,W){var S,ke;return Z?(ke=new lr,Z.state=ke,ke.window=null,S=or(Z,W),S!==B&&(Z.state=null),S):V}function Gt(Z){return pr(Z,bt)}var tr=!0,O,h;function v(Z){if(tr){var W;for(O=new f.Buf32(512),h=new f.Buf32(32),W=0;W<144;)Z.lens[W++]=8;for(;W<256;)Z.lens[W++]=9;for(;W<280;)Z.lens[W++]=7;for(;W<288;)Z.lens[W++]=8;for(k(A,Z.lens,0,288,O,0,Z.work,{bits:9}),W=0;W<32;)Z.lens[W++]=5;k(d,Z.lens,0,32,h,0,Z.work,{bits:5}),tr=!1}Z.lencode=O,Z.lenbits=9,Z.distcode=h,Z.distbits=5}function U(Z,W,S,ke){var dt,c=Z.state;return c.window===null&&(c.wsize=1<<c.wbits,c.wnext=0,c.whave=0,c.window=new f.Buf8(c.wsize)),ke>=c.wsize?(f.arraySet(c.window,W,S-c.wsize,c.wsize,0),c.wnext=0,c.whave=c.wsize):(dt=c.wsize-c.wnext,dt>ke&&(dt=ke),f.arraySet(c.window,W,S-ke,dt,c.wnext),ke-=dt,ke?(f.arraySet(c.window,W,S-ke,ke,0),c.wnext=ke,c.whave=c.wsize):(c.wnext+=dt,c.wnext===c.wsize&&(c.wnext=0),c.whave<c.wsize&&(c.whave+=dt))),0}function b(Z,W){var S,ke,dt,c,G,Ee,P,X,be,ut,Qe,Ge,yt,Sr,zt=0,lt,Rt,fr,hr,qr,Ur,rr,sr,Xt=new f.Buf8(4),dr,xr,pi=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Z||!Z.state||!Z.output||!Z.input&&Z.avail_in!==0)return V;S=Z.state,S.mode===Le&&(S.mode=ft),G=Z.next_out,dt=Z.output,P=Z.avail_out,c=Z.next_in,ke=Z.input,Ee=Z.avail_in,X=S.hold,be=S.bits,ut=Ee,Qe=P,sr=B;e:for(;;)switch(S.mode){case Q:if(S.wrap===0){S.mode=ft;break}for(;be<16;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(S.wrap&2&&X===35615){S.check=0,Xt[0]=X&255,Xt[1]=X>>>8&255,S.check=w(S.check,Xt,2,0),X=0,be=0,S.mode=ge;break}if(S.flags=0,S.head&&(S.head.done=!1),!(S.wrap&1)||(((X&255)<<8)+(X>>8))%31){Z.msg="incorrect header check",S.mode=We;break}if((X&15)!==te){Z.msg="unknown compression method",S.mode=We;break}if(X>>>=4,be-=4,rr=(X&15)+8,S.wbits===0)S.wbits=rr;else if(rr>S.wbits){Z.msg="invalid window size",S.mode=We;break}S.dmax=1<<rr,Z.adler=S.check=1,S.mode=X&512?Ce:Le,X=0,be=0;break;case ge:for(;be<16;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(S.flags=X,(S.flags&255)!==te){Z.msg="unknown compression method",S.mode=We;break}if(S.flags&57344){Z.msg="unknown header flags set",S.mode=We;break}S.head&&(S.head.text=X>>8&1),S.flags&512&&(Xt[0]=X&255,Xt[1]=X>>>8&255,S.check=w(S.check,Xt,2,0)),X=0,be=0,S.mode=Te;case Te:for(;be<32;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.head&&(S.head.time=X),S.flags&512&&(Xt[0]=X&255,Xt[1]=X>>>8&255,Xt[2]=X>>>16&255,Xt[3]=X>>>24&255,S.check=w(S.check,Xt,4,0)),X=0,be=0,S.mode=le;case le:for(;be<16;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.head&&(S.head.xflags=X&255,S.head.os=X>>8),S.flags&512&&(Xt[0]=X&255,Xt[1]=X>>>8&255,S.check=w(S.check,Xt,2,0)),X=0,be=0,S.mode=H;case H:if(S.flags&1024){for(;be<16;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.length=X,S.head&&(S.head.extra_len=X),S.flags&512&&(Xt[0]=X&255,Xt[1]=X>>>8&255,S.check=w(S.check,Xt,2,0)),X=0,be=0}else S.head&&(S.head.extra=null);S.mode=fe;case fe:if(S.flags&1024&&(Ge=S.length,Ge>Ee&&(Ge=Ee),Ge&&(S.head&&(rr=S.head.extra_len-S.length,S.head.extra||(S.head.extra=new Array(S.head.extra_len)),f.arraySet(S.head.extra,ke,c,Ge,rr)),S.flags&512&&(S.check=w(S.check,ke,Ge,c)),Ee-=Ge,c+=Ge,S.length-=Ge),S.length))break e;S.length=0,S.mode=Ae;case Ae:if(S.flags&2048){if(Ee===0)break e;Ge=0;do rr=ke[c+Ge++],S.head&&rr&&S.length<65536&&(S.head.name+=String.fromCharCode(rr));while(rr&&Ge<Ee);if(S.flags&512&&(S.check=w(S.check,ke,Ge,c)),Ee-=Ge,c+=Ge,rr)break e}else S.head&&(S.head.name=null);S.length=0,S.mode=pe;case pe:if(S.flags&4096){if(Ee===0)break e;Ge=0;do rr=ke[c+Ge++],S.head&&rr&&S.length<65536&&(S.head.comment+=String.fromCharCode(rr));while(rr&&Ge<Ee);if(S.flags&512&&(S.check=w(S.check,ke,Ge,c)),Ee-=Ge,c+=Ge,rr)break e}else S.head&&(S.head.comment=null);S.mode=Be;case Be:if(S.flags&512){for(;be<16;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(X!==(S.check&65535)){Z.msg="header crc mismatch",S.mode=We;break}X=0,be=0}S.head&&(S.head.hcrc=S.flags>>9&1,S.head.done=!0),Z.adler=S.check=0,S.mode=Le;break;case Ce:for(;be<32;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}Z.adler=S.check=Wt(X),X=0,be=0,S.mode=Se;case Se:if(S.havedict===0)return Z.next_out=G,Z.avail_out=P,Z.next_in=c,Z.avail_in=Ee,S.hold=X,S.bits=be,j;Z.adler=S.check=1,S.mode=Le;case Le:if(W===F||W===D)break e;case ft:if(S.last){X>>>=be&7,be-=be&7,S.mode=kt;break}for(;be<3;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}switch(S.last=X&1,X>>>=1,be-=1,X&3){case 0:S.mode=Ne;break;case 1:if(v(S),S.mode=gt,W===D){X>>>=2,be-=2;break e}break;case 2:S.mode=Ue;break;case 3:Z.msg="invalid block type",S.mode=We}X>>>=2,be-=2;break;case Ne:for(X>>>=be&7,be-=be&7;be<32;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if((X&65535)!==(X>>>16^65535)){Z.msg="invalid stored block lengths",S.mode=We;break}if(S.length=X&65535,X=0,be=0,S.mode=Re,W===D)break e;case Re:S.mode=Fe;case Fe:if(Ge=S.length,Ge){if(Ge>Ee&&(Ge=Ee),Ge>P&&(Ge=P),Ge===0)break e;f.arraySet(dt,ke,c,Ge,G),Ee-=Ge,c+=Ge,P-=Ge,G+=Ge,S.length-=Ge;break}S.mode=Le;break;case Ue:for(;be<14;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(S.nlen=(X&31)+257,X>>>=5,be-=5,S.ndist=(X&31)+1,X>>>=5,be-=5,S.ncode=(X&15)+4,X>>>=4,be-=4,S.nlen>286||S.ndist>30){Z.msg="too many length or distance symbols",S.mode=We;break}S.have=0,S.mode=mt;case mt:for(;S.have<S.ncode;){for(;be<3;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.lens[pi[S.have++]]=X&7,X>>>=3,be-=3}for(;S.have<19;)S.lens[pi[S.have++]]=0;if(S.lencode=S.lendyn,S.lenbits=7,dr={bits:S.lenbits},sr=k(_,S.lens,0,19,S.lencode,0,S.work,dr),S.lenbits=dr.bits,sr){Z.msg="invalid code lengths set",S.mode=We;break}S.have=0,S.mode=pt;case pt:for(;S.have<S.nlen+S.ndist;){for(;zt=S.lencode[X&(1<<S.lenbits)-1],lt=zt>>>24,Rt=zt>>>16&255,fr=zt&65535,!(lt<=be);){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(fr<16)X>>>=lt,be-=lt,S.lens[S.have++]=fr;else{if(fr===16){for(xr=lt+2;be<xr;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(X>>>=lt,be-=lt,S.have===0){Z.msg="invalid bit length repeat",S.mode=We;break}rr=S.lens[S.have-1],Ge=3+(X&3),X>>>=2,be-=2}else if(fr===17){for(xr=lt+3;be<xr;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}X>>>=lt,be-=lt,rr=0,Ge=3+(X&7),X>>>=3,be-=3}else{for(xr=lt+7;be<xr;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}X>>>=lt,be-=lt,rr=0,Ge=11+(X&127),X>>>=7,be-=7}if(S.have+Ge>S.nlen+S.ndist){Z.msg="invalid bit length repeat",S.mode=We;break}for(;Ge--;)S.lens[S.have++]=rr}}if(S.mode===We)break;if(S.lens[256]===0){Z.msg="invalid code -- missing end-of-block",S.mode=We;break}if(S.lenbits=9,dr={bits:S.lenbits},sr=k(A,S.lens,0,S.nlen,S.lencode,0,S.work,dr),S.lenbits=dr.bits,sr){Z.msg="invalid literal/lengths set",S.mode=We;break}if(S.distbits=6,S.distcode=S.distdyn,dr={bits:S.distbits},sr=k(d,S.lens,S.nlen,S.ndist,S.distcode,0,S.work,dr),S.distbits=dr.bits,sr){Z.msg="invalid distances set",S.mode=We;break}if(S.mode=gt,W===D)break e;case gt:S.mode=Pt;case Pt:if(Ee>=6&&P>=258){Z.next_out=G,Z.avail_out=P,Z.next_in=c,Z.avail_in=Ee,S.hold=X,S.bits=be,m(Z,Qe),G=Z.next_out,dt=Z.output,P=Z.avail_out,c=Z.next_in,ke=Z.input,Ee=Z.avail_in,X=S.hold,be=S.bits,S.mode===Le&&(S.back=-1);break}for(S.back=0;zt=S.lencode[X&(1<<S.lenbits)-1],lt=zt>>>24,Rt=zt>>>16&255,fr=zt&65535,!(lt<=be);){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(Rt&&(Rt&240)===0){for(hr=lt,qr=Rt,Ur=fr;zt=S.lencode[Ur+((X&(1<<hr+qr)-1)>>hr)],lt=zt>>>24,Rt=zt>>>16&255,fr=zt&65535,!(hr+lt<=be);){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}X>>>=hr,be-=hr,S.back+=hr}if(X>>>=lt,be-=lt,S.back+=lt,S.length=fr,Rt===0){S.mode=ht;break}if(Rt&32){S.back=-1,S.mode=Le;break}if(Rt&64){Z.msg="invalid literal/length code",S.mode=We;break}S.extra=Rt&15,S.mode=Lt;case Lt:if(S.extra){for(xr=S.extra;be<xr;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.length+=X&(1<<S.extra)-1,X>>>=S.extra,be-=S.extra,S.back+=S.extra}S.was=S.length,S.mode=Mt;case Mt:for(;zt=S.distcode[X&(1<<S.distbits)-1],lt=zt>>>24,Rt=zt>>>16&255,fr=zt&65535,!(lt<=be);){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if((Rt&240)===0){for(hr=lt,qr=Rt,Ur=fr;zt=S.distcode[Ur+((X&(1<<hr+qr)-1)>>hr)],lt=zt>>>24,Rt=zt>>>16&255,fr=zt&65535,!(hr+lt<=be);){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}X>>>=hr,be-=hr,S.back+=hr}if(X>>>=lt,be-=lt,S.back+=lt,Rt&64){Z.msg="invalid distance code",S.mode=We;break}S.offset=fr,S.extra=Rt&15,S.mode=Et;case Et:if(S.extra){for(xr=S.extra;be<xr;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}S.offset+=X&(1<<S.extra)-1,X>>>=S.extra,be-=S.extra,S.back+=S.extra}if(S.offset>S.dmax){Z.msg="invalid distance too far back",S.mode=We;break}S.mode=ct;case ct:if(P===0)break e;if(Ge=Qe-P,S.offset>Ge){if(Ge=S.offset-Ge,Ge>S.whave&&S.sane){Z.msg="invalid distance too far back",S.mode=We;break}Ge>S.wnext?(Ge-=S.wnext,yt=S.wsize-Ge):yt=S.wnext-Ge,Ge>S.length&&(Ge=S.length),Sr=S.window}else Sr=dt,yt=G-S.offset,Ge=S.length;Ge>P&&(Ge=P),P-=Ge,S.length-=Ge;do dt[G++]=Sr[yt++];while(--Ge);S.length===0&&(S.mode=Pt);break;case ht:if(P===0)break e;dt[G++]=S.length,P--,S.mode=Pt;break;case kt:if(S.wrap){for(;be<32;){if(Ee===0)break e;Ee--,X|=ke[c++]<<be,be+=8}if(Qe-=P,Z.total_out+=Qe,S.total+=Qe,Qe&&(Z.adler=S.check=S.flags?w(S.check,dt,Qe,G-Qe):u(S.check,dt,Qe,G-Qe)),Qe=P,(S.flags?X:Wt(X))!==S.check){Z.msg="incorrect data check",S.mode=We;break}X=0,be=0}S.mode=qe;case qe:if(S.wrap&&S.flags){for(;be<32;){if(Ee===0)break e;Ee--,X+=ke[c++]<<be,be+=8}if(X!==(S.total&4294967295)){Z.msg="incorrect length check",S.mode=We;break}X=0,be=0}S.mode=It;case It:sr=z;break e;case We:sr=we;break e;case vt:return ie;case Ht:default:return V}return Z.next_out=G,Z.avail_out=P,Z.next_in=c,Z.avail_in=Ee,S.hold=X,S.bits=be,(S.wsize||Qe!==Z.avail_out&&S.mode<We&&(S.mode<kt||W!==y))&&U(Z,Z.output,Z.next_out,Qe-Z.avail_out),ut-=Z.avail_in,Qe-=Z.avail_out,Z.total_in+=ut,Z.total_out+=Qe,S.total+=Qe,S.wrap&&Qe&&(Z.adler=S.check=S.flags?w(S.check,dt,Qe,Z.next_out-Qe):u(S.check,dt,Qe,Z.next_out-Qe)),Z.data_type=S.bits+(S.last?64:0)+(S.mode===Le?128:0)+(S.mode===gt||S.mode===Re?256:0),(ut===0&&Qe===0||W===y)&&sr===B&&(sr=K),sr}function L(Z){if(!Z||!Z.state)return V;var W=Z.state;return W.window&&(W.window=null),Z.state=null,B}function J(Z,W){var S;return!Z||!Z.state||(S=Z.state,(S.wrap&2)===0)?V:(S.head=W,W.done=!1,B)}function De(Z,W){var S=W.length,ke,dt,c;return!Z||!Z.state||(ke=Z.state,ke.wrap!==0&&ke.mode!==Se)?V:ke.mode===Se&&(dt=1,dt=u(dt,W,S,0),dt!==ke.check)?we:(c=U(Z,W,S,S),c?(ke.mode=vt,ie):(ke.havedict=1,B))}return Mr.inflateReset=Ft,Mr.inflateReset2=or,Mr.inflateResetKeep=Ot,Mr.inflateInit=Gt,Mr.inflateInit2=pr,Mr.inflate=b,Mr.inflateEnd=L,Mr.inflateGetHeader=J,Mr.inflateSetDictionary=De,Mr.inflateInfo="pako inflate (from Nodeca project)",Mr}var Yo,Eu;function Au(){return Eu||(Eu=1,Yo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),Yo}var Xo,ku;function kh(){if(ku)return Xo;ku=1;function f(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return Xo=f,Xo}var Su;function Sh(){if(Su)return di;Su=1;var f=Ah(),u=Cn(),w=wu(),m=Au(),k=Ko(),_=yu(),A=kh(),d=Object.prototype.toString;function y(B){if(!(this instanceof y))return new y(B);this.options=u.assign({chunkSize:16384,windowBits:0,to:""},B||{});var z=this.options;z.raw&&z.windowBits>=0&&z.windowBits<16&&(z.windowBits=-z.windowBits,z.windowBits===0&&(z.windowBits=-15)),z.windowBits>=0&&z.windowBits<16&&!(B&&B.windowBits)&&(z.windowBits+=32),z.windowBits>15&&z.windowBits<48&&(z.windowBits&15)===0&&(z.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var j=f.inflateInit2(this.strm,z.windowBits);if(j!==m.Z_OK)throw new Error(k[j]);if(this.header=new A,f.inflateGetHeader(this.strm,this.header),z.dictionary&&(typeof z.dictionary=="string"?z.dictionary=w.string2buf(z.dictionary):d.call(z.dictionary)==="[object ArrayBuffer]"&&(z.dictionary=new Uint8Array(z.dictionary)),z.raw&&(j=f.inflateSetDictionary(this.strm,z.dictionary),j!==m.Z_OK)))throw new Error(k[j])}y.prototype.push=function(B,z){var j=this.strm,V=this.options.chunkSize,we=this.options.dictionary,ie,K,te,Q,ge,Te=!1;if(this.ended)return!1;K=z===~~z?z:z===!0?m.Z_FINISH:m.Z_NO_FLUSH,typeof B=="string"?j.input=w.binstring2buf(B):d.call(B)==="[object ArrayBuffer]"?j.input=new Uint8Array(B):j.input=B,j.next_in=0,j.avail_in=j.input.length;do{if(j.avail_out===0&&(j.output=new u.Buf8(V),j.next_out=0,j.avail_out=V),ie=f.inflate(j,m.Z_NO_FLUSH),ie===m.Z_NEED_DICT&&we&&(ie=f.inflateSetDictionary(this.strm,we)),ie===m.Z_BUF_ERROR&&Te===!0&&(ie=m.Z_OK,Te=!1),ie!==m.Z_STREAM_END&&ie!==m.Z_OK)return this.onEnd(ie),this.ended=!0,!1;j.next_out&&(j.avail_out===0||ie===m.Z_STREAM_END||j.avail_in===0&&(K===m.Z_FINISH||K===m.Z_SYNC_FLUSH))&&(this.options.to==="string"?(te=w.utf8border(j.output,j.next_out),Q=j.next_out-te,ge=w.buf2string(j.output,te),j.next_out=Q,j.avail_out=V-Q,Q&&u.arraySet(j.output,j.output,te,Q,0),this.onData(ge)):this.onData(u.shrinkBuf(j.output,j.next_out))),j.avail_in===0&&j.avail_out===0&&(Te=!0)}while((j.avail_in>0||j.avail_out===0)&&ie!==m.Z_STREAM_END);return ie===m.Z_STREAM_END&&(K=m.Z_FINISH),K===m.Z_FINISH?(ie=f.inflateEnd(this.strm),this.onEnd(ie),this.ended=!0,ie===m.Z_OK):(K===m.Z_SYNC_FLUSH&&(this.onEnd(m.Z_OK),j.avail_out=0),!0)},y.prototype.onData=function(B){this.chunks.push(B)},y.prototype.onEnd=function(B){B===m.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=u.flattenChunks(this.chunks)),this.chunks=[],this.err=B,this.msg=this.strm.msg};function F(B,z){var j=new y(z);if(j.push(B,!0),j.err)throw j.msg||k[j.err];return j.result}function D(B,z){return z=z||{},z.raw=!0,F(B,z)}return di.Inflate=y,di.inflate=F,di.inflateRaw=D,di.ungzip=F,di}var Jo,Ru;function Rh(){if(Ru)return Jo;Ru=1;var f=Cn().assign,u=_h(),w=Sh(),m=Au(),k={};return f(k,u,w,m),Jo=k,Jo}var Qo,Iu;function Ih(){if(Iu)return Qo;Iu=1;const f=(u,w)=>function(...m){const k=w.promiseModule;return new k((_,A)=>{w.multiArgs?m.push((...d)=>{w.errorFirst?d[0]?A(d):(d.shift(),_(d)):_(d)}):w.errorFirst?m.push((d,y)=>{d?A(d):_(y)}):m.push(_),u.apply(this,m)})};return Qo=(u,w)=>{w=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},w);const m=typeof u;if(!(u!==null&&(m==="object"||m==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${u===null?"null":m}\``);const k=A=>{const d=y=>typeof y=="string"?A===y:y.test(A);return w.include?w.include.some(d):!w.exclude.some(d)};let _;m==="function"?_=function(...A){return w.excludeMain?u(...A):f(u,w).apply(this,A)}:_=Object.create(Object.getPrototypeOf(u));for(const A in u){const d=u[A];_[A]=typeof d=="function"&&k(A)?f(d,w):d}return _},Qo}var es,Tu;function Th(){if(Tu)return es;Tu=1;function f(Ne){return Array.isArray(Ne)?Ne:[Ne]}const u="",w=" ",m="\\",k=/^\s+$/,_=/(?:[^\\]|^)\\$/,A=/^\\!/,d=/^\\#/,y=/\r?\n/g,F=/^\.*\/|^\.+$/,D="/";let B="node-ignore";typeof Symbol<"u"&&(B=Symbol.for("node-ignore"));const z=B,j=(Ne,Re,Fe)=>Object.defineProperty(Ne,Re,{value:Fe}),V=/([0-z])-([0-z])/g,we=()=>!1,ie=Ne=>Ne.replace(V,(Re,Fe,Ue)=>Fe.charCodeAt(0)<=Ue.charCodeAt(0)?Re:u),K=Ne=>{const{length:Re}=Ne;return Ne.slice(0,Re-Re%2)},te=[[/^\uFEFF/,()=>u],[/((?:\\\\)*?)(\\?\s+)$/,(Ne,Re,Fe)=>Re+(Fe.indexOf("\\")===0?w:u)],[/(\\+?)\s/g,(Ne,Re)=>{const{length:Fe}=Re;return Re.slice(0,Fe-Fe%2)+w}],[/[\\$.|*+(){^]/g,Ne=>`\\${Ne}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(Ne,Re,Fe)=>Re+6<Fe.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(Ne,Re,Fe)=>{const Ue=Fe.replace(/\\\*/g,"[^\\/]*");return Re+Ue}],[/\\\\\\(?=[$.|*+(){^])/g,()=>m],[/\\\\/g,()=>m],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(Ne,Re,Fe,Ue,mt)=>Re===m?`\\[${Fe}${K(Ue)}${mt}`:mt==="]"&&Ue.length%2===0?`[${ie(Fe)}${Ue}]`:"[]"],[/(?:[^*])$/,Ne=>/\/$/.test(Ne)?`${Ne}$`:`${Ne}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(Ne,Re)=>`${Re?`${Re}[^/]+`:"[^/]*"}(?=$|\\/$)`]],Q=Object.create(null),ge=(Ne,Re)=>{let Fe=Q[Ne];return Fe||(Fe=te.reduce((Ue,[mt,pt])=>Ue.replace(mt,pt.bind(Ne)),Ne),Q[Ne]=Fe),Re?new RegExp(Fe,"i"):new RegExp(Fe)},Te=Ne=>typeof Ne=="string",le=Ne=>Ne&&Te(Ne)&&!k.test(Ne)&&!_.test(Ne)&&Ne.indexOf("#")!==0,H=Ne=>Ne.split(y);class fe{constructor(Re,Fe,Ue,mt){this.origin=Re,this.pattern=Fe,this.negative=Ue,this.regex=mt}}const Ae=(Ne,Re)=>{const Fe=Ne;let Ue=!1;Ne.indexOf("!")===0&&(Ue=!0,Ne=Ne.substr(1)),Ne=Ne.replace(A,"!").replace(d,"#");const mt=ge(Ne,Re);return new fe(Fe,Ne,Ue,mt)},pe=(Ne,Re)=>{throw new Re(Ne)},Be=(Ne,Re,Fe)=>Te(Ne)?Ne?Be.isNotRelative(Ne)?Fe(`path should be a \`path.relative()\`d string, but got "${Re}"`,RangeError):!0:Fe("path must not be empty",TypeError):Fe(`path must be a string, but got \`${Re}\``,TypeError),Ce=Ne=>F.test(Ne);Be.isNotRelative=Ce,Be.convert=Ne=>Ne;class Se{constructor({ignorecase:Re=!0,ignoreCase:Fe=Re,allowRelativePaths:Ue=!1}={}){j(this,z,!0),this._rules=[],this._ignoreCase=Fe,this._allowRelativePaths=Ue,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(Re){if(Re&&Re[z]){this._rules=this._rules.concat(Re._rules),this._added=!0;return}if(le(Re)){const Fe=Ae(Re,this._ignoreCase);this._added=!0,this._rules.push(Fe)}}add(Re){return this._added=!1,f(Te(Re)?H(Re):Re).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(Re){return this.add(Re)}_testOne(Re,Fe){let Ue=!1,mt=!1;return this._rules.forEach(pt=>{const{negative:gt}=pt;if(mt===gt&&Ue!==mt||gt&&!Ue&&!mt&&!Fe)return;pt.regex.test(Re)&&(Ue=!gt,mt=gt)}),{ignored:Ue,unignored:mt}}_test(Re,Fe,Ue,mt){const pt=Re&&Be.convert(Re);return Be(pt,Re,this._allowRelativePaths?we:pe),this._t(pt,Fe,Ue,mt)}_t(Re,Fe,Ue,mt){if(Re in Fe)return Fe[Re];if(mt||(mt=Re.split(D)),mt.pop(),!mt.length)return Fe[Re]=this._testOne(Re,Ue);const pt=this._t(mt.join(D)+D,Fe,Ue,mt);return Fe[Re]=pt.ignored?pt:this._testOne(Re,Ue)}ignores(Re){return this._test(Re,this._ignoreCache,!1).ignored}createFilter(){return Re=>!this.ignores(Re)}filter(Re){return f(Re).filter(this.createFilter())}test(Re){return this._test(Re,this._testCache,!0)}}const Le=Ne=>new Se(Ne),ft=Ne=>Be(Ne&&Be.convert(Ne),Ne,we);if(Le.isPathValid=ft,Le.default=Le,es=Le,typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){const Ne=Fe=>/^\\\\\?\\/.test(Fe)||/["<>|\u0000-\u001F]+/u.test(Fe)?Fe:Fe.replace(/\\/g,"/");Be.convert=Ne;const Re=/^[a-z]:\//i;Be.isNotRelative=Fe=>Re.test(Fe)||Ce(Fe)}return es}var ts,Ou;function Oh(){if(Ou)return ts;Ou=1;function f(m){return m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function u(m,k,_){return k=k instanceof RegExp?k:new RegExp(f(k),"g"),m.replace(k,_)}var w={clean:function(k){if(typeof k!="string")throw new Error("Expected a string, received: "+k);return k=u(k,"./","/"),k=u(k,"..","."),k=u(k," ","-"),k=u(k,/^[~^:?*\\\-]/g,""),k=u(k,/[~^:?*\\]/g,"-"),k=u(k,/[~^:?*\\\-]$/g,""),k=u(k,"@{","-"),k=u(k,/\.$/g,""),k=u(k,/\/$/g,""),k=u(k,/\.lock$/g,""),k}};return ts=w,ts}var rs,Pu;function Ph(){return Pu||(Pu=1,rs=function(f,u){var w=f,m=u,k=w.length,_=m.length,A=!1,d=null,y=k+1,F=[],D=[],B=[],z="",j=-1,V=0,we=1,ie,K,te=function(){k>=_&&(ie=w,K=k,w=m,m=ie,k=_,_=K,A=!0,y=k+1)},Q=function(H,fe,Ae){return{x:H,y:fe,k:Ae}},ge=function(H,fe){return{elem:H,t:fe}},Te=function(H,fe,Ae){var pe,Be,Ce;for(fe>Ae?pe=F[H-1+y]:pe=F[H+1+y],Ce=Math.max(fe,Ae),Be=Ce-H;Be<k&&Ce<_&&w[Be]===m[Ce];)++Be,++Ce;return F[H+y]=D.length,D[D.length]=new Q(Be,Ce,pe),Ce},le=function(H){var fe,Ae,pe;for(fe=Ae=0,pe=H.length-1;pe>=0;--pe)for(;fe<H[pe].x||Ae<H[pe].y;)H[pe].y-H[pe].x>Ae-fe?(A?B[B.length]=new ge(m[Ae],j):B[B.length]=new ge(m[Ae],we),++Ae):H[pe].y-H[pe].x<Ae-fe?(A?B[B.length]=new ge(w[fe],we):B[B.length]=new ge(w[fe],j),++fe):(B[B.length]=new ge(w[fe],V),z+=w[fe],++fe,++Ae)};return te(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return d},getlcs:function(){return z},getses:function(){return B},compose:function(){var H,fe,Ae,pe,Be,Ce,Se,Le;for(H=_-k,fe=k+_+3,Ae={},Se=0;Se<fe;++Se)Ae[Se]=-1,F[Se]=-1;pe=-1;do{for(++pe,Le=-pe;Le<=H-1;++Le)Ae[Le+y]=Te(Le,Ae[Le-1+y]+1,Ae[Le+1+y]);for(Le=H+pe;Le>=H+1;--Le)Ae[Le+y]=Te(Le,Ae[Le-1+y]+1,Ae[Le+1+y]);Ae[H+y]=Te(H,Ae[H-1+y]+1,Ae[H+1+y])}while(Ae[H+y]!==_);for(d=H+2*pe,Be=F[H+y],Ce=[];Be!==-1;)Ce[Ce.length]=new Q(D[Be].x,D[Be].y,null),Be=D[Be].k;le(Ce)}}}),rs}var ns,Bu;function Bh(){if(Bu)return ns;Bu=1;var f=Ph();function u(_,A){var d=new f(_,A);d.compose();for(var y=d.getses(),F,D,B=_.length-1,z=A.length-1,j=y.length-1;j>=0;--j)y[j].t===d.SES_COMMON?(D?(D.chain={file1index:B,file2index:z,chain:null},D=D.chain):(F={file1index:B,file2index:z,chain:null},D=F),B--,z--):y[j].t===d.SES_DELETE?B--:y[j].t===d.SES_ADD&&z--;var V={file1index:-1,file2index:-1,chain:null};return D?(D.chain=V,F):V}function w(_,A){for(var d=[],y=_.length,F=A.length,D=u(_,A);D!==null;D=D.chain){var B=y-D.file1index-1,z=F-D.file2index-1;y=D.file1index,F=D.file2index,(B||z)&&d.push({file1:[y+1,B],file2:[F+1,z]})}return d.reverse(),d}function m(_,A,d){var y,F=w(A,_),D=w(A,d),B=[];function z(Fe,Ue){B.push([Fe.file1[0],Ue,Fe.file1[1],Fe.file2[0],Fe.file2[1]])}for(y=0;y<F.length;y++)z(F[y],0);for(y=0;y<D.length;y++)z(D[y],2);B.sort(function(Fe,Ue){return Fe[0]-Ue[0]});var j=[],V=0;function we(Fe){Fe>V&&(j.push([1,V,Fe-V]),V=Fe)}for(var ie=0;ie<B.length;ie++){for(var K=ie,te=B[ie],Q=te[0],ge=Q+te[2];ie<B.length-1;){var Te=B[ie+1],le=Te[0];if(le>ge)break;ge=Math.max(ge,le+Te[2]),ie++}if(we(Q),K==ie)te[4]>0&&j.push([te[1],te[3],te[4]]);else{var H={0:[_.length,-1,A.length,-1],2:[d.length,-1,A.length,-1]};for(y=K;y<=ie;y++){te=B[y];var fe=te[1],Ae=H[fe],pe=te[0],Be=pe+te[2],Ce=te[3],Se=Ce+te[4];Ae[0]=Math.min(Ce,Ae[0]),Ae[1]=Math.max(Se,Ae[1]),Ae[2]=Math.min(pe,Ae[2]),Ae[3]=Math.max(Be,Ae[3])}var Le=H[0][0]+(Q-H[0][2]),ft=H[0][1]+(ge-H[0][3]),Ne=H[2][0]+(Q-H[2][2]),Re=H[2][1]+(ge-H[2][3]);j.push([-1,Le,ft-Le,Q,ge-Q,Ne,Re-Ne])}V=ge}return we(A.length),j}function k(_,A,d){var y=[],F=[_,A,d],D=m(_,A,d),B=[];function z(){B.length&&y.push({ok:B}),B=[]}function j(te){for(var Q=0;Q<te.length;Q++)B.push(te[Q])}function V(te){if(te[2]!=te[6])return!0;for(var Q=te[1],ge=te[5],Te=0;Te<te[2];Te++)if(_[Te+Q]!=d[Te+ge])return!0;return!1}for(var we=0;we<D.length;we++){var ie=D[we],K=ie[0];K==-1?V(ie)?(z(),y.push({conflict:{a:_.slice(ie[1],ie[1]+ie[2]),aIndex:ie[1],o:A.slice(ie[3],ie[3]+ie[4]),oIndex:ie[3],b:d.slice(ie[5],ie[5]+ie[6]),bIndex:ie[5]}})):j(F[0].slice(ie[1],ie[1]+ie[2])):j(F[K].slice(ie[1],ie[1]+ie[2]))}return z(),y}return ns=k,ns}var Cu;function Ch(){if(Cu)return Je;Cu=1,Object.defineProperty(Je,"__esModule",{value:!0});function f(n){return n&&typeof n=="object"&&"default"in n?n.default:n}var u=f(Pf()),w=f(gh()),m=f(yh()),k=f(Rh()),_=f(Ih()),A=f(Th()),d=f(Oh()),y=f(Bh());class F extends Error{constructor(e){super(e),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(e){const t=new F(e.message);return t.code=e.code,t.data=e.data,t.caller=e.caller,t.stack=e.stack,t}get isIsomorphicGitError(){return!0}}class D extends F{constructor(e){super(`Modifying the index is not possible because you have unmerged files: ${e.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=D.code,this.data={filepaths:e}}}D.code="UnmergedPathsError";class B extends F{constructor(e){super(`An internal error caused this command to fail.

If you're not a developer, report the bug to the developers of the application you're using. If this is a bug in isomorphic-git then you should create a proper bug yourselves. The bug should include a minimal reproduction and details about the version and environment.

Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${e}`),this.code=this.name=B.code,this.data={message:e}}}B.code="InternalError";class z extends F{constructor(e){super(`The filepath "${e}" contains unsafe character sequences`),this.code=this.name=z.code,this.data={filepath:e}}}z.code="UnsafeFilepathError";class j{constructor(e){this.buffer=e,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(e){this._start=e}slice(e){const t=this.buffer.slice(this._start,this._start+e);return this._start+=e,t}toString(e,t){const i=this.buffer.toString(e,this._start,this._start+t);return this._start+=t,i}write(e,t,i){const a=this.buffer.write(e,this._start,t,i);return this._start+=t,a}copy(e,t,i){const a=e.copy(this.buffer,this._start,t,i);return this._start+=a,a}readUInt8(){const e=this.buffer.readUInt8(this._start);return this._start+=1,e}writeUInt8(e){const t=this.buffer.writeUInt8(e,this._start);return this._start+=1,t}readUInt16BE(){const e=this.buffer.readUInt16BE(this._start);return this._start+=2,e}writeUInt16BE(e){const t=this.buffer.writeUInt16BE(e,this._start);return this._start+=2,t}readUInt32BE(){const e=this.buffer.readUInt32BE(this._start);return this._start+=4,e}writeUInt32BE(e){const t=this.buffer.writeUInt32BE(e,this._start);return this._start+=4,t}}function V(n,e){return-(n<e)||+(n>e)}function we(n,e){return V(n.path,e.path)}function ie(n){let e=n>0?n>>12:0;e!==4&&e!==8&&e!==10&&e!==14&&(e=8);let t=n&511;return t&73?t=493:t=420,e!==8&&(t=0),(e<<12)+t}const K=2**32;function te(n,e,t,i){if(n!==void 0&&e!==void 0)return[n,e];t===void 0&&(t=i.valueOf());const a=Math.floor(t/1e3),s=(t-a*1e3)*1e6;return[a,s]}function Q(n){const[e,t]=te(n.ctimeSeconds,n.ctimeNanoseconds,n.ctimeMs,n.ctime),[i,a]=te(n.mtimeSeconds,n.mtimeNanoseconds,n.mtimeMs,n.mtime);return{ctimeSeconds:e%K,ctimeNanoseconds:t%K,mtimeSeconds:i%K,mtimeNanoseconds:a%K,dev:n.dev%K,ino:n.ino%K,mode:ie(n.mode%K),uid:n.uid%K,gid:n.gid%K,size:n.size>-1?n.size%K:0}}function ge(n){let e="";for(const t of new Uint8Array(n))t<16&&(e+="0"),e+=t.toString(16);return e}let Te=null;async function le(n){return Te===null&&(Te=await Ae()),Te?fe(n):H(n)}function H(n){return new w().update(n).digest("hex")}async function fe(n){const e=await crypto.subtle.digest("SHA-1",n);return ge(e)}async function Ae(){try{return await fe(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709"}catch{}return!1}function pe(n){return{assumeValid:!!(n&32768),extended:!!(n&16384),stage:(n&12288)>>12,nameLength:n&4095}}function Be(n){const e=n.flags;return e.extended=!1,e.nameLength=Math.min(Buffer.from(n.path).length,4095),(e.assumeValid?32768:0)+(e.extended?16384:0)+((e.stage&3)<<12)+(e.nameLength&4095)}class Ce{constructor(e,t){this._dirty=!1,this._unmergedPaths=t||new Set,this._entries=e||new Map}_addEntry(e){if(e.flags.stage===0)e.stages=[e],this._entries.set(e.path,e),this._unmergedPaths.delete(e.path);else{let t=this._entries.get(e.path);t||(this._entries.set(e.path,e),t=e),t.stages[e.flags.stage]=e,this._unmergedPaths.add(e.path)}}static async from(e){if(Buffer.isBuffer(e))return Ce.fromBuffer(e);if(e===null)return new Ce(null);throw new B("invalid type passed to GitIndex.from")}static async fromBuffer(e){if(e.length===0)throw new B("Index file is empty (.git/index)");const t=new Ce,i=new j(e),a=i.toString("utf8",4);if(a!=="DIRC")throw new B(`Invalid dircache magic file number: ${a}`);const s=await le(e.slice(0,-20)),p=e.slice(-20).toString("hex");if(p!==s)throw new B(`Invalid checksum in GitIndex buffer: expected ${p} but saw ${s}`);const E=i.readUInt32BE();if(E!==2)throw new B(`Unsupported dircache version: ${E}`);const T=i.readUInt32BE();let C=0;for(;!i.eof()&&C<T;){const I={};I.ctimeSeconds=i.readUInt32BE(),I.ctimeNanoseconds=i.readUInt32BE(),I.mtimeSeconds=i.readUInt32BE(),I.mtimeNanoseconds=i.readUInt32BE(),I.dev=i.readUInt32BE(),I.ino=i.readUInt32BE(),I.mode=i.readUInt32BE(),I.uid=i.readUInt32BE(),I.gid=i.readUInt32BE(),I.size=i.readUInt32BE(),I.oid=i.slice(20).toString("hex");const N=i.readUInt16BE();I.flags=pe(N);const M=e.indexOf(0,i.tell()+1)-i.tell();if(M<1)throw new B(`Got a path length of: ${M}`);if(I.path=i.toString("utf8",M),I.path.includes("..\\")||I.path.includes("../"))throw new z(I.path);let Y=8-(i.tell()-12)%8;for(Y===0&&(Y=8);Y--;){const he=i.readUInt8();if(he!==0)throw new B(`Expected 1-8 null characters but got '${he}' after ${I.path}`);if(i.eof())throw new B("Unexpected end of file")}I.stages=[],t._addEntry(I),C++}return t}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(we)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(e=>e.stages.length>1?e.stages.filter(t=>t):e)}*[Symbol.iterator](){for(const e of this.entries)yield e}insert({filepath:e,stats:t,oid:i,stage:a=0}){t||(t={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),t=Q(t);const s=Buffer.from(e),p={ctimeSeconds:t.ctimeSeconds,ctimeNanoseconds:t.ctimeNanoseconds,mtimeSeconds:t.mtimeSeconds,mtimeNanoseconds:t.mtimeNanoseconds,dev:t.dev,ino:t.ino,mode:t.mode||33188,uid:t.uid,gid:t.gid,size:t.size,path:e,oid:i,flags:{assumeValid:!1,extended:!1,stage:a,nameLength:s.length<4095?s.length:4095},stages:[]};this._addEntry(p),this._dirty=!0}delete({filepath:e}){if(this._entries.has(e))this._entries.delete(e);else for(const t of this._entries.keys())t.startsWith(e+"/")&&this._entries.delete(t);this._unmergedPaths.has(e)&&this._unmergedPaths.delete(e),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:e}){return this._entries.has(e)}render(){return this.entries.map(e=>`${e.mode.toString(8)} ${e.oid}    ${e.path}`).join(`
`)}static async _entryToBuffer(e){const t=Buffer.from(e.path),i=Math.ceil((62+t.length+1)/8)*8,a=Buffer.alloc(i),s=new j(a),p=Q(e);return s.writeUInt32BE(p.ctimeSeconds),s.writeUInt32BE(p.ctimeNanoseconds),s.writeUInt32BE(p.mtimeSeconds),s.writeUInt32BE(p.mtimeNanoseconds),s.writeUInt32BE(p.dev),s.writeUInt32BE(p.ino),s.writeUInt32BE(p.mode),s.writeUInt32BE(p.uid),s.writeUInt32BE(p.gid),s.writeUInt32BE(p.size),s.write(e.oid,20,"hex"),s.writeUInt16BE(Be(e)),s.write(e.path,t.length,"utf8"),a}async toObject(){const e=Buffer.alloc(12),t=new j(e);t.write("DIRC",4,"utf8"),t.writeUInt32BE(2),t.writeUInt32BE(this.entriesFlat.length);let i=[];for(const E of this.entries)if(i.push(Ce._entryToBuffer(E)),E.stages.length>1)for(const T of E.stages)T&&T!==E&&i.push(Ce._entryToBuffer(T));i=await Promise.all(i);const a=Buffer.concat(i),s=Buffer.concat([e,a]),p=await le(s);return Buffer.concat([s,Buffer.from(p,"hex")])}}function Se(n,e,t=!0,i=!0){const a=Q(n),s=Q(e);return t&&a.mode!==s.mode||a.mtimeSeconds!==s.mtimeSeconds||a.ctimeSeconds!==s.ctimeSeconds||a.uid!==s.uid||a.gid!==s.gid||i&&a.ino!==s.ino||a.size!==s.size}let Le=null;const ft=Symbol("IndexCache");function Ne(){return{map:new Map,stats:new Map}}async function Re(n,e,t){const[i,a]=await Promise.all([n.lstat(e),n.read(e)]),s=await Ce.from(a);t.map.set(e,s),t.stats.set(e,i)}async function Fe(n,e,t){const i=t.stats.get(e);if(i===void 0)return!0;if(i===null)return!1;const a=await n.lstat(e);return a===null?!1:Se(i,a)}class Ue{static async acquire({fs:e,gitdir:t,cache:i,allowUnmerged:a=!0},s){i[ft]||(i[ft]=Ne());const p=`${t}/index`;Le===null&&(Le=new u({maxPending:1/0}));let E,T=[];return await Le.acquire(p,async()=>{const C=i[ft];await Fe(e,p,C)&&await Re(e,p,C);const I=C.map.get(p);if(T=I.unmergedPaths,T.length&&!a)throw new D(T);if(E=await s(I),I._dirty){const N=await I.toObject();await e.write(p,N),C.stats.set(p,await e.lstat(p)),I._dirty=!1}}),E}}function mt(n){const e=Math.max(n.lastIndexOf("/"),n.lastIndexOf("\\"));return e>-1&&(n=n.slice(e+1)),n}function pt(n){const e=Math.max(n.lastIndexOf("/"),n.lastIndexOf("\\"));return e===-1?".":e===0?"/":n.slice(0,e)}function gt(n){const e=new Map,t=function(a){if(!e.has(a)){const s={type:"tree",fullpath:a,basename:mt(a),metadata:{},children:[]};e.set(a,s),s.parent=t(pt(a)),s.parent&&s.parent!==s&&s.parent.children.push(s)}return e.get(a)},i=function(a,s){if(!e.has(a)){const p={type:"blob",fullpath:a,basename:mt(a),metadata:s,parent:t(pt(a)),children:[]};p.parent&&p.parent.children.push(p),e.set(a,p)}return e.get(a)};t(".");for(const a of n)i(a.path,a);return e}function Pt(n){switch(n){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new B(`Unexpected GitTree entry mode: ${n.toString(8)}`)}class Lt{constructor({fs:e,gitdir:t,cache:i}){this.treePromise=Ue.acquire({fs:e,gitdir:t,cache:i},async function(s){return gt(s.entries)});const a=this;this.ConstructEntry=class{constructor(p){this._fullpath=p,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return a.type(this)}async mode(){return a.mode(this)}async stat(){return a.stat(this)}async content(){return a.content(this)}async oid(){return a.oid(this)}}}async readdir(e){const t=e._fullpath,a=(await this.treePromise).get(t);if(!a||a.type==="blob")return null;if(a.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${t}'`);const s=a.children.map(p=>p.fullpath);return s.sort(V),s}async type(e){return e._type===!1&&await e.stat(),e._type}async mode(e){return e._mode===!1&&await e.stat(),e._mode}async stat(e){if(e._stat===!1){const i=(await this.treePromise).get(e._fullpath);if(!i)throw new Error(`ENOENT: no such file or directory, lstat '${e._fullpath}'`);const a=i.type==="tree"?{}:Q(i.metadata);e._type=i.type==="tree"?"tree":Pt(a.mode),e._mode=a.mode,i.type==="tree"?e._stat=void 0:e._stat=a}return e._stat}async content(e){}async oid(e){if(e._oid===!1){const i=(await this.treePromise).get(e._fullpath);e._oid=i.metadata.oid}return e._oid}}const Mt=Symbol("GitWalkSymbol");function Et(){const n=Object.create(null);return Object.defineProperty(n,Mt,{value:function({fs:e,gitdir:t,cache:i}){return new Lt({fs:e,gitdir:t,cache:i})}}),Object.freeze(n),n}class ct extends F{constructor(e){super(`Could not find ${e}.`),this.code=this.name=ct.code,this.data={what:e}}}ct.code="NotFoundError";class ht extends F{constructor(e,t,i,a){super(`Object ${e} ${a?`at ${a}`:""}was anticipated to be a ${i} but it is a ${t}.`),this.code=this.name=ht.code,this.data={oid:e,actual:t,expected:i,filepath:a}}}ht.code="ObjectTypeError";class kt extends F{constructor(e){super(`Expected a 40-char hex object id but saw "${e}".`),this.code=this.name=kt.code,this.data={value:e}}}kt.code="InvalidOidError";class qe extends F{constructor(e){super(`Could not find a fetch refspec for remote "${e}". Make sure the config file has an entry like the following:
[remote "${e}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=qe.code,this.data={remote:e}}}qe.code="NoRefspecError";class It{constructor(e){if(this.refs=new Map,this.parsedConfig=[],e){let t=null;this.parsedConfig=e.trim().split(`
`).map(i=>{if(/^\s*#/.test(i))return{line:i,comment:!0};const a=i.indexOf(" ");if(i.startsWith("^")){const s=i.slice(1);return this.refs.set(t+"^{}",s),{line:i,ref:t,peeled:s}}else{const s=i.slice(0,a);return t=i.slice(a+1),this.refs.set(t,s),{line:i,ref:t,oid:s}}})}return this}static from(e){return new It(e)}delete(e){this.parsedConfig=this.parsedConfig.filter(t=>t.ref!==e),this.refs.delete(e)}toString(){return this.parsedConfig.map(({line:e})=>e).join(`
`)+`
`}}class We{constructor({remotePath:e,localPath:t,force:i,matchPrefix:a}){Object.assign(this,{remotePath:e,localPath:t,force:i,matchPrefix:a})}static from(e){const[t,i,a,s,p]=e.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),E=t==="+",T=a==="*";if(T!==(p==="*"))throw new B("Invalid refspec");return new We({remotePath:i,localPath:s,force:E,matchPrefix:T})}translate(e){if(this.matchPrefix){if(e.startsWith(this.remotePath))return this.localPath+e.replace(this.remotePath,"")}else if(e===this.remotePath)return this.localPath;return null}reverseTranslate(e){if(this.matchPrefix){if(e.startsWith(this.localPath))return this.remotePath+e.replace(this.localPath,"")}else if(e===this.localPath)return this.remotePath;return null}}class vt{constructor(e=[]){this.rules=e}static from(e){const t=[];for(const i of e)t.push(We.from(i));return new vt(t)}add(e){const t=We.from(e);this.rules.push(t)}translate(e){const t=[];for(const i of this.rules)for(const a of e){const s=i.translate(a);s&&t.push([a,s])}return t}translateOne(e){let t=null;for(const i of this.rules){const a=i.translate(e);a&&(t=a)}return t}localNamespaces(){return this.rules.filter(e=>e.matchPrefix).map(e=>e.localPath.replace(/\/$/,""))}}function Ht(n,e){const t=n.replace(/\^\{\}$/,""),i=e.replace(/\^\{\}$/,""),a=-(t<i)||+(t>i);return a===0?n.endsWith("^{}")?1:-1:a}/*!
 * This code for `path.join` is directly copied from @zenfs/core/path for bundle size improvements.
 * SPDX-License-Identifier: LGPL-3.0-or-later
 * Copyright (c) James Prevett and other ZenFS contributors.
 */function qt(n,e){let t="",i=0,a=-1,s=0,p="\0";for(let E=0;E<=n.length;++E){if(E<n.length)p=n[E];else{if(p==="/")break;p="/"}if(p==="/"){if(!(a===E-1||s===1))if(s===2){if(t.length<2||i!==2||t.at(-1)!=="."||t.at(-2)!=="."){if(t.length>2){const T=t.lastIndexOf("/");T===-1?(t="",i=0):(t=t.slice(0,T),i=t.length-1-t.lastIndexOf("/")),a=E,s=0;continue}else if(t.length!==0){t="",i=0,a=E,s=0;continue}}e&&(t+=t.length>0?"/..":"..",i=2)}else t.length>0?t+="/"+n.slice(a+1,E):t=n.slice(a+1,E),i=E-a-1;a=E,s=0}else p==="."&&s!==-1?++s:s=-1}return t}function Bt(n){if(!n.length)return".";const e=n[0]==="/",t=n.at(-1)==="/";return n=qt(n,!e),n.length?(t&&(n+="/"),e?`/${n}`:n):e?"/":t?"./":"."}function _e(...n){if(n.length===0)return".";let e;for(let t=0;t<n.length;++t){const i=n[t];i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Bt(e)}const bt=n=>{if(typeof n=="number")return n;n=n.toLowerCase();let e=parseInt(n);return n.endsWith("k")&&(e*=1024),n.endsWith("m")&&(e*=1024*1024),n.endsWith("g")&&(e*=1024*1024*1024),e},Wt=n=>{if(typeof n=="boolean")return n;if(n=n.trim().toLowerCase(),n==="true"||n==="yes"||n==="on")return!0;if(n==="false"||n==="no"||n==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${n}`)},lr={core:{filemode:Wt,bare:Wt,logallrefupdates:Wt,symlinks:Wt,ignorecase:Wt,bigFileThreshold:bt}},Ot=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,Ft=/^[A-Za-z0-9-.]+$/,or=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,pr=/^[A-Za-z][A-Za-z-]*$/,Gt=/^(.*?)( *[#;].*)$/,tr=n=>{const e=Ot.exec(n);if(e!=null){const[t,i]=e.slice(1);return[t,i]}return null},O=n=>{const e=or.exec(n);if(e!=null){const[t,i="true"]=e.slice(1),a=h(i),s=U(a);return[t,s]}return null},h=n=>{const e=Gt.exec(n);if(e==null)return n;const[t,i]=e.slice(1);return v(t)&&v(i)?`${t}${i}`:t},v=n=>(n.match(/(?:^|[^\\])"/g)||[]).length%2!==0,U=n=>n.split("").reduce((e,t,i,a)=>{const s=t==='"'&&a[i-1]!=="\\",p=t==="\\"&&a[i+1]==='"';return s||p?e:e+t},""),b=n=>n!=null?n.toLowerCase():null,L=(n,e,t)=>[b(n),e,b(t)].filter(i=>i!=null).join("."),J=n=>{const e=n.split("."),t=e.shift(),i=e.pop(),a=e.length?e.join("."):void 0;return{section:t,subsection:a,name:i,path:L(t,a,i),sectionPath:L(t,a,null),isSection:!!t}},De=(n,e)=>n.reduce((t,i,a)=>e(i)?a:t,-1);class Z{constructor(e){let t=null,i=null;this.parsedConfig=e?e.split(`
`).map(a=>{let s=null,p=null;const E=a.trim(),T=tr(E),C=T!=null;if(C)[t,i]=T;else{const N=O(E);N!=null&&([s,p]=N)}const I=L(t,i,s);return{line:a,isSection:C,section:t,subsection:i,name:s,value:p,path:I}}):[]}static from(e){return new Z(e)}async get(e,t=!1){const i=J(e).path,a=this.parsedConfig.filter(s=>s.path===i).map(({section:s,name:p,value:E})=>{const T=lr[s]&&lr[s][p];return T?T(E):E});return t?a:a.pop()}async getall(e){return this.get(e,!0)}async getSubsections(e){return this.parsedConfig.filter(t=>t.isSection&&t.section===e).map(t=>t.subsection)}async deleteSection(e,t){this.parsedConfig=this.parsedConfig.filter(i=>!(i.section===e&&i.subsection===t))}async append(e,t){return this.set(e,t,!0)}async set(e,t,i=!1){const{section:a,subsection:s,name:p,path:E,sectionPath:T,isSection:C}=J(e),I=De(this.parsedConfig,N=>N.path===E);if(t==null)I!==-1&&this.parsedConfig.splice(I,1);else if(I!==-1){const N=this.parsedConfig[I],M=Object.assign({},N,{name:p,value:t,modified:!0});i?this.parsedConfig.splice(I+1,0,M):this.parsedConfig[I]=M}else{const N=this.parsedConfig.findIndex(Y=>Y.path===T),M={section:a,subsection:s,name:p,value:t,modified:!0,path:E};if(Ft.test(a)&&pr.test(p))if(N>=0)this.parsedConfig.splice(N+1,0,M);else{const Y={isSection:C,section:a,subsection:s,modified:!0,path:T};this.parsedConfig.push(Y,M)}}}toString(){return this.parsedConfig.map(({line:e,section:t,subsection:i,name:a,value:s,modified:p=!1})=>p?a!=null&&s!=null?typeof s=="string"&&/[#;]/.test(s)?`	${a} = "${s}"`:`	${a} = ${s}`:i!=null?`[${t} "${i}"]`:`[${t}]`:e).join(`
`)}}class W{static async get({fs:e,gitdir:t}){const i=await e.read(`${t}/config`,{encoding:"utf8"});return Z.from(i)}static async save({fs:e,gitdir:t,config:i}){await e.write(`${t}/config`,i.toString(),{encoding:"utf8"})}}const S=n=>[`${n}`,`refs/${n}`,`refs/tags/${n}`,`refs/heads/${n}`,`refs/remotes/${n}`,`refs/remotes/${n}/HEAD`],ke=["config","description","index","shallow","commondir"];let dt;async function c(n,e){return dt===void 0&&(dt=new u),dt.acquire(n,e)}class G{static async updateRemoteRefs({fs:e,gitdir:t,remote:i,refs:a,symrefs:s,tags:p,refspecs:E=void 0,prune:T=!1,pruneTags:C=!1}){for(const xe of a.values())if(!xe.match(/[0-9a-f]{40}/))throw new kt(xe);const I=await W.get({fs:e,gitdir:t});if(!E){if(E=await I.getall(`remote.${i}.fetch`),E.length===0)throw new qe(i);E.unshift(`+HEAD:refs/remotes/${i}/HEAD`)}const N=vt.from(E),M=new Map;if(C){const xe=await G.listRefs({fs:e,gitdir:t,filepath:"refs/tags"});await G.deleteRefs({fs:e,gitdir:t,refs:xe.map(Oe=>`refs/tags/${Oe}`)})}if(p){for(const xe of a.keys())if(xe.startsWith("refs/tags")&&!xe.endsWith("^{}")&&!await G.exists({fs:e,gitdir:t,ref:xe})){const Oe=a.get(xe);M.set(xe,Oe)}}const Y=N.translate([...a.keys()]);for(const[xe,Oe]of Y){const $e=a.get(xe);M.set(Oe,$e)}const he=N.translate([...s.keys()]);for(const[xe,Oe]of he){const $e=s.get(xe),Ye=N.translateOne($e);Ye&&M.set(Oe,`ref: ${Ye}`)}const Ie=[];if(T){for(const xe of N.localNamespaces()){const Oe=(await G.listRefs({fs:e,gitdir:t,filepath:xe})).map($e=>`${xe}/${$e}`);for(const $e of Oe)M.has($e)||Ie.push($e)}Ie.length>0&&await G.deleteRefs({fs:e,gitdir:t,refs:Ie})}for(const[xe,Oe]of M)await c(xe,async()=>e.write(_e(t,xe),`${Oe.trim()}
`,"utf8"));return{pruned:Ie}}static async writeRef({fs:e,gitdir:t,ref:i,value:a}){if(!a.match(/[0-9a-f]{40}/))throw new kt(a);await c(i,async()=>e.write(_e(t,i),`${a.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:e,gitdir:t,ref:i,value:a}){await c(i,async()=>e.write(_e(t,i),`ref: ${a.trim()}
`,"utf8"))}static async deleteRef({fs:e,gitdir:t,ref:i}){return G.deleteRefs({fs:e,gitdir:t,refs:[i]})}static async deleteRefs({fs:e,gitdir:t,refs:i}){await Promise.all(i.map(E=>e.rm(_e(t,E))));let a=await c("packed-refs",async()=>e.read(`${t}/packed-refs`,{encoding:"utf8"}));const s=It.from(a),p=s.refs.size;for(const E of i)s.refs.has(E)&&s.delete(E);s.refs.size<p&&(a=s.toString(),await c("packed-refs",async()=>e.write(`${t}/packed-refs`,a,{encoding:"utf8"})))}static async resolve({fs:e,gitdir:t,ref:i,depth:a=void 0}){if(a!==void 0&&(a--,a===-1))return i;if(i.startsWith("ref: "))return i=i.slice(5),G.resolve({fs:e,gitdir:t,ref:i,depth:a});if(i.length===40&&/[0-9a-f]{40}/.test(i))return i;const s=await G.packedRefs({fs:e,gitdir:t}),p=S(i).filter(E=>!ke.includes(E));for(const E of p){const T=await c(E,async()=>await e.read(`${t}/${E}`,{encoding:"utf8"})||s.get(E));if(T)return G.resolve({fs:e,gitdir:t,ref:T.trim(),depth:a})}throw new ct(i)}static async exists({fs:e,gitdir:t,ref:i}){try{return await G.expand({fs:e,gitdir:t,ref:i}),!0}catch{return!1}}static async expand({fs:e,gitdir:t,ref:i}){if(i.length===40&&/[0-9a-f]{40}/.test(i))return i;const a=await G.packedRefs({fs:e,gitdir:t}),s=S(i);for(const p of s)if(await c(p,async()=>e.exists(`${t}/${p}`))||a.has(p))return p;throw new ct(i)}static async expandAgainstMap({ref:e,map:t}){const i=S(e);for(const a of i)if(await t.has(a))return a;throw new ct(e)}static resolveAgainstMap({ref:e,fullref:t=e,depth:i=void 0,map:a}){if(i!==void 0&&(i--,i===-1))return{fullref:t,oid:e};if(e.startsWith("ref: "))return e=e.slice(5),G.resolveAgainstMap({ref:e,fullref:t,depth:i,map:a});if(e.length===40&&/[0-9a-f]{40}/.test(e))return{fullref:t,oid:e};const s=S(e);for(const p of s){const E=a.get(p);if(E)return G.resolveAgainstMap({ref:E.trim(),fullref:p,depth:i,map:a})}throw new ct(e)}static async packedRefs({fs:e,gitdir:t}){const i=await c("packed-refs",async()=>e.read(`${t}/packed-refs`,{encoding:"utf8"}));return It.from(i).refs}static async listRefs({fs:e,gitdir:t,filepath:i}){const a=G.packedRefs({fs:e,gitdir:t});let s=null;try{s=await e.readdirDeep(`${t}/${i}`),s=s.map(p=>p.replace(`${t}/${i}/`,""))}catch{s=[]}for(let p of(await a).keys())p.startsWith(i)&&(p=p.replace(i+"/",""),s.includes(p)||s.push(p));return s.sort(Ht),s}static async listBranches({fs:e,gitdir:t,remote:i}){return i?G.listRefs({fs:e,gitdir:t,filepath:`refs/remotes/${i}`}):G.listRefs({fs:e,gitdir:t,filepath:"refs/heads"})}static async listTags({fs:e,gitdir:t}){return(await G.listRefs({fs:e,gitdir:t,filepath:"refs/tags"})).filter(a=>!a.endsWith("^{}"))}}function Ee(n,e){return V(P(n),P(e))}function P(n){return n.mode==="040000"?n.path+"/":n.path}function X(n){switch(n){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new B(`Unexpected GitTree entry mode: ${n}`)}function be(n){const e=[];let t=0;for(;t<n.length;){const i=n.indexOf(32,t);if(i===-1)throw new B(`GitTree: Error parsing buffer at byte location ${t}: Could not find the next space character.`);const a=n.indexOf(0,t);if(a===-1)throw new B(`GitTree: Error parsing buffer at byte location ${t}: Could not find the next null character.`);let s=n.slice(t,i).toString("utf8");s==="40000"&&(s="040000");const p=X(s),E=n.slice(i+1,a).toString("utf8");if(E.includes("\\")||E.includes("/"))throw new z(E);const T=n.slice(a+1,a+21).toString("hex");t=a+21,e.push({mode:s,path:E,oid:T,type:p})}return e}function ut(n){if(typeof n=="number"&&(n=n.toString(8)),n.match(/^0?4.*/))return"040000";if(n.match(/^1006.*/))return"100644";if(n.match(/^1007.*/))return"100755";if(n.match(/^120.*/))return"120000";if(n.match(/^160.*/))return"160000";throw new B(`Could not understand file mode: ${n}`)}function Qe(n){return!n.oid&&n.sha&&(n.oid=n.sha),n.mode=ut(n.mode),n.type||(n.type=X(n.mode)),n}class Ge{constructor(e){if(Buffer.isBuffer(e))this._entries=be(e);else if(Array.isArray(e))this._entries=e.map(Qe);else throw new B("invalid type passed to GitTree constructor");this._entries.sort(we)}static from(e){return new Ge(e)}render(){return this._entries.map(e=>`${e.mode} ${e.type} ${e.oid}    ${e.path}`).join(`
`)}toObject(){const e=[...this._entries];return e.sort(Ee),Buffer.concat(e.map(t=>{const i=Buffer.from(t.mode.replace(/^0/,"")),a=Buffer.from(" "),s=Buffer.from(t.path,"utf8"),p=Buffer.from([0]),E=Buffer.from(t.oid,"hex");return Buffer.concat([i,a,s,p,E])}))}entries(){return this._entries}*[Symbol.iterator](){for(const e of this._entries)yield e}}class yt{static wrap({type:e,object:t}){const i=`${e} ${t.length}\0`,a=i.length,s=a+t.length,p=new Uint8Array(s);for(let E=0;E<a;E++)p[E]=i.charCodeAt(E);return p.set(t,a),p}static unwrap(e){const t=e.indexOf(32),i=e.indexOf(0),a=e.slice(0,t).toString("utf8"),s=e.slice(t+1,i).toString("utf8"),p=e.length-(i+1);if(parseInt(s)!==p)throw new B(`Length mismatch: expected ${s} bytes but got ${p} instead.`);return{type:a,object:Buffer.from(e.slice(i+1))}}}async function Sr({fs:n,gitdir:e,oid:t}){const i=`objects/${t.slice(0,2)}/${t.slice(2)}`,a=await n.read(`${e}/${i}`);return a?{object:a,format:"deflated",source:i}:null}function zt(n,e){const t=new j(n),i=lt(t);if(i!==e.byteLength)throw new B(`applyDelta expected source buffer to be ${i} bytes but the provided buffer was ${e.length} bytes`);const a=lt(t);let s;const p=fr(t,e);if(p.byteLength===a)s=p;else{s=Buffer.alloc(a);const E=new j(s);for(E.copy(p);!t.eof();)E.copy(fr(t,e));const T=E.tell();if(a!==T)throw new B(`applyDelta expected target buffer to be ${a} bytes but the resulting buffer was ${T} bytes`)}return s}function lt(n){let e=0,t=0,i=null;do i=n.readUInt8(),e|=(i&127)<<t,t+=7;while(i&128);return e}function Rt(n,e,t){let i=0,a=0;for(;t--;)e&1&&(i|=n.readUInt8()<<a),e>>=1,a+=8;return i}function fr(n,e){const t=n.readUInt8(),i=128,a=15,s=112;if(t&i){const p=Rt(n,t&a,4);let E=Rt(n,(t&s)>>4,3);return E===0&&(E=65536),e.slice(p,p+E)}else return n.slice(t)}function hr(n){let e=[n];return{next(){return Promise.resolve({done:e.length===0,value:e.pop()})},return(){return e=[],{}},[Symbol.asyncIterator](){return this}}}function qr(n){return n[Symbol.asyncIterator]?n[Symbol.asyncIterator]():n[Symbol.iterator]?n[Symbol.iterator]():n.next?n:hr(n)}class Ur{constructor(e){if(typeof Buffer>"u")throw new Error("Missing Buffer dependency");this.stream=qr(e),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(e){if(!this.eof())return this.started||await this._init(),this.cursor+e>this.buffer.length&&(this._trim(),await this._accumulate(e)),this._moveCursor(e),this.buffer.slice(this.undoCursor,this.cursor)}async skip(e){this.eof()||(this.started||await this._init(),this.cursor+e>this.buffer.length&&(this._trim(),await this._accumulate(e)),this._moveCursor(e))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:e,value:t}=await this.stream.next();return e&&(this._ended=!0,!t)?Buffer.alloc(0):(t&&(t=Buffer.from(t)),t)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(e){this.undoCursor=this.cursor,this.cursor+=e,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(e){if(this._ended)return;const t=[this.buffer];for(;this.cursor+e>rr(t);){const i=await this._next();if(this._ended)break;t.push(i)}this.buffer=Buffer.concat(t)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function rr(n){return n.reduce((e,t)=>e+t.length,0)}async function sr(n,e){const t=new Ur(n);let i=await t.read(4);if(i=i.toString("utf8"),i!=="PACK")throw new B(`Invalid PACK header '${i}'`);let a=await t.read(4);if(a=a.readUInt32BE(0),a!==2)throw new B(`Invalid packfile version: ${a}`);let s=await t.read(4);if(s=s.readUInt32BE(0),!(s<1))for(;!t.eof()&&s--;){const p=t.tell(),{type:E,length:T,ofs:C,reference:I}=await Xt(t),N=new k.Inflate;for(;!N.result;){const M=await t.chunk();if(!M)break;if(N.push(M,!1),N.err)throw new B(`Pako error: ${N.msg}`);if(N.result){if(N.result.length!==T)throw new B("Inflated object size is different from that stated in packfile.");await t.undo(),await t.read(M.length-N.strm.avail_in);const Y=t.tell();await e({data:N.result,type:E,num:s,offset:p,end:Y,reference:I,ofs:C})}}}}async function Xt(n){let e=await n.byte();const t=e>>4&7;let i=e&15;if(e&128){let p=4;do e=await n.byte(),i|=(e&127)<<p,p+=7;while(e&128)}let a,s;if(t===6){let p=0;a=0;const E=[];do e=await n.byte(),a|=(e&127)<<p,p+=7,E.push(e);while(e&128);s=Buffer.from(E)}return t===7&&(s=await n.read(20)),{type:t,length:i,ofs:a,reference:s}}async function dr(n){return k.inflate(n)}function xr(n){const e=[];let t=0,i=0;do{t=n.readUInt8();const a=t&127;e.push(a),i=t&128}while(i);return e.reduce((a,s)=>a+1<<7|s,-1)}function pi(n,e){let t=e,i=4,a=null;do a=n.readUInt8(),t|=(a&127)<<i,i+=7;while(a&128);return t}class Tr{constructor(e){Object.assign(this,e),this.offsetCache={}}static async fromIdx({idx:e,getExternalRefDelta:t}){const i=new j(e);if(i.slice(4).toString("hex")!=="ff744f63")return;const s=i.readUInt32BE();if(s!==2)throw new B(`Unable to read version ${s} packfile IDX. (Only version 2 supported)`);if(e.byteLength>2147483648)throw new B("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");i.seek(i.tell()+1020);const p=i.readUInt32BE(),E=[];for(let I=0;I<p;I++){const N=i.slice(20).toString("hex");E[I]=N}i.seek(i.tell()+4*p);const T=new Map;for(let I=0;I<p;I++)T.set(E[I],i.readUInt32BE());const C=i.slice(20).toString("hex");return new Tr({hashes:E,crcs:{},offsets:T,packfileSha:C,getExternalRefDelta:t})}static async fromPack({pack:e,getExternalRefDelta:t,onProgress:i}){const a={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},s={},p=e.slice(-20).toString("hex"),E=[],T={},C=new Map;let I=null,N=null;await sr([e],async({data:xe,type:Oe,reference:$e,offset:Ye,num:rt})=>{I===null&&(I=rt);const ot=Math.floor((I-rt)*100/I);ot!==N&&i&&await i({phase:"Receiving objects",loaded:I-rt,total:I}),N=ot,Oe=a[Oe],["commit","tree","blob","tag"].includes(Oe)?s[Ye]={type:Oe,offset:Ye}:Oe==="ofs-delta"?s[Ye]={type:Oe,offset:Ye}:Oe==="ref-delta"&&(s[Ye]={type:Oe,offset:Ye})});const M=Object.keys(s).map(Number);for(const[xe,Oe]of M.entries()){const $e=xe+1===M.length?e.byteLength-20:M[xe+1],Ye=s[Oe],rt=m.buf(e.slice(Oe,$e))>>>0;Ye.end=$e,Ye.crc=rt}const Y=new Tr({pack:Promise.resolve(e),packfileSha:p,crcs:T,hashes:E,offsets:C,getExternalRefDelta:t});N=null;let he=0;const Ie=[0,0,0,0,0,0,0,0,0,0,0,0];for(let xe in s){xe=Number(xe);const Oe=Math.floor(he*100/I);Oe!==N&&i&&await i({phase:"Resolving deltas",loaded:he,total:I}),he++,N=Oe;const $e=s[xe];if(!$e.oid)try{Y.readDepth=0,Y.externalReadDepth=0;const{type:Ye,object:rt}=await Y.readSlice({start:xe});Ie[Y.readDepth]+=1;const ot=await le(yt.wrap({type:Ye,object:rt}));$e.oid=ot,E.push(ot),C.set(ot,xe),T[ot]=$e.crc}catch{continue}}return E.sort(),Y}async toBuffer(){const e=[],t=(C,I)=>{e.push(Buffer.from(C,I))};t("ff744f63","hex"),t("00000002","hex");const i=new j(Buffer.alloc(256*4));for(let C=0;C<256;C++){let I=0;for(const N of this.hashes)parseInt(N.slice(0,2),16)<=C&&I++;i.writeUInt32BE(I)}e.push(i.buffer);for(const C of this.hashes)t(C,"hex");const a=new j(Buffer.alloc(this.hashes.length*4));for(const C of this.hashes)a.writeUInt32BE(this.crcs[C]);e.push(a.buffer);const s=new j(Buffer.alloc(this.hashes.length*4));for(const C of this.hashes)s.writeUInt32BE(this.offsets.get(C));e.push(s.buffer),t(this.packfileSha,"hex");const p=Buffer.concat(e),E=await le(p),T=Buffer.alloc(20);return T.write(E,"hex"),Buffer.concat([p,T])}async load({pack:e}){this.pack=e}async unload(){this.pack=null}async read({oid:e}){if(!this.offsets.get(e)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(e);throw new B(`Could not read object ${e} from packfile`)}const t=this.offsets.get(e);return this.readSlice({start:t})}async readSlice({start:e}){if(this.offsetCache[e])return Object.assign({},this.offsetCache[e]);this.readDepth++;const t={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new B("Tried to read from a GitPackIndex with no packfile loaded into memory");const i=(await this.pack).slice(e),a=new j(i),s=a.readUInt8(),p=s&112;let E=t[p];if(E===void 0)throw new B("Unrecognized type: 0b"+p.toString(2));const T=s&15;let C=T;s&128&&(C=pi(a,T));let N=null,M=null;if(E==="ofs_delta"){const he=xr(a),Ie=e-he;({object:N,type:E}=await this.readSlice({start:Ie}))}if(E==="ref_delta"){const he=a.slice(20).toString("hex");({object:N,type:E}=await this.read({oid:he}))}const Y=i.slice(a.tell());if(M=Buffer.from(await dr(Y)),M.byteLength!==C)throw new B(`Packfile told us object would have length ${C} but it had length ${M.byteLength}`);return N&&(M=Buffer.from(zt(M,N))),this.readDepth>3&&(this.offsetCache[e]={type:E,object:M}),{type:E,format:"content",object:M}}}const Jn=Symbol("PackfileCache");async function xn({fs:n,filename:e,getExternalRefDelta:t,emitter:i,emitterPrefix:a}){const s=await n.read(e);return Tr.fromIdx({idx:s,getExternalRefDelta:t})}function mi({fs:n,cache:e,filename:t,getExternalRefDelta:i,emitter:a,emitterPrefix:s}){e[Jn]||(e[Jn]=new Map);let p=e[Jn].get(t);return p||(p=xn({fs:n,filename:t,getExternalRefDelta:i,emitter:a,emitterPrefix:s}),e[Jn].set(t,p)),p}async function Mi({fs:n,cache:e,gitdir:t,oid:i,format:a="content",getExternalRefDelta:s}){let p=await n.readdir(_e(t,"objects/pack"));p=p.filter(E=>E.endsWith(".idx"));for(const E of p){const T=`${t}/objects/pack/${E}`,C=await mi({fs:n,cache:e,filename:T,getExternalRefDelta:s});if(C.error)throw new B(C.error);if(C.offsets.has(i)){if(!C.pack){const N=T.replace(/idx$/,"pack");C.pack=n.read(N)}const I=await C.read({oid:i,getExternalRefDelta:s});return I.format="content",I.source=`objects/pack/${E.replace(/idx$/,"pack")}`,I}}return null}async function _t({fs:n,cache:e,gitdir:t,oid:i,format:a="content"}){const s=I=>_t({fs:n,cache:e,gitdir:t,oid:I});let p;if(i==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(p={format:"wrapped",object:Buffer.from("tree 0\0")}),p||(p=await Sr({fs:n,gitdir:t,oid:i})),!p){if(p=await Mi({fs:n,cache:e,gitdir:t,oid:i,getExternalRefDelta:s}),!p)throw new ct(i);return p}if(a==="deflated"||(p.format==="deflated"&&(p.object=Buffer.from(await dr(p.object)),p.format="wrapped"),a==="wrapped"))return p;const E=await le(p.object);if(E!==i)throw new B(`SHA check failed! Expected ${i}, computed ${E}`);const{object:T,type:C}=yt.unwrap(p.object);if(p.type=C,p.object=T,p.format="content",a==="content")return p;throw new B(`invalid requested format "${a}"`)}class wr extends F{constructor(e,t,i=!0){super(`Failed to create ${e} at ${t} because it already exists.${i?` (Hint: use 'force: true' parameter to overwrite existing ${e}.)`:""}`),this.code=this.name=wr.code,this.data={noun:e,where:t,canForce:i}}}wr.code="AlreadyExistsError";class Or extends F{constructor(e,t,i){super(`Found multiple ${e} matching "${t}" (${i.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=Or.code,this.data={nouns:e,short:t,matches:i}}}Or.code="AmbiguousError";class Fn extends F{constructor(e){super(`Your local changes to the following files would be overwritten by checkout: ${e.join(", ")}`),this.code=this.name=Fn.code,this.data={filepaths:e}}}Fn.code="CheckoutConflictError";class Lr extends F{constructor(e,t){super(`Cannot cherry-pick merge commit ${e}. Merge commits have ${t} parents and require specifying which parent to use as the base.`),this.code=this.name=Lr.code,this.data={oid:e,parentCount:t}}}Lr.code="CherryPickMergeCommitError";class ln extends F{constructor(e){super(`Cannot cherry-pick root commit ${e}. Root commits have no parents.`),this.code=this.name=ln.code,this.data={oid:e}}}ln.code="CherryPickRootCommitError";class En extends F{constructor(e,t){super(`Failed to checkout "${e}" because commit ${t} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=En.code,this.data={ref:e,oid:t}}}En.code="CommitNotFetchedError";class An extends F{constructor(){super("Empty response from git server."),this.code=this.name=An.code,this.data={}}}An.code="EmptyServerResponseError";class Dr extends F{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=Dr.code,this.data={}}}Dr.code="FastForwardError";class Dn extends F{constructor(e,t){super(`One or more branches were not updated: ${e}`),this.code=this.name=Dn.code,this.data={prettyDetails:e,result:t}}}Dn.code="GitPushError";class en extends F{constructor(e,t,i){super(`HTTP Error: ${e} ${t}`),this.code=this.name=en.code,this.data={statusCode:e,statusMessage:t,response:i}}}en.code="HttpError";class tn extends F{constructor(e){let t="invalid filepath";e==="leading-slash"||e==="trailing-slash"?t='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':e==="directory"&&(t='"filepath" should not be a directory.'),super(t),this.code=this.name=tn.code,this.data={reason:e}}}tn.code="InvalidFilepathError";class xt extends F{constructor(e,t){super(`"${e}" would be an invalid git reference. (Hint: a valid alternative would be "${t}".)`),this.code=this.name=xt.code,this.data={ref:e,suggestion:t}}}xt.code="InvalidRefNameError";class Nn extends F{constructor(e){super(`Maximum search depth of ${e} exceeded.`),this.code=this.name=Nn.code,this.data={depth:e}}}Nn.code="MaxDepthError";class kn extends F{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=kn.code,this.data={}}}kn.code="MergeNotSupportedError";class zr extends F{constructor(e,t,i,a){super(`Automatic merge failed with one or more merge conflicts in the following files: ${e.toString()}. Fix conflicts then commit the result.`),this.code=this.name=zr.code,this.data={filepaths:e,bothModified:t,deleteByUs:i,deleteByTheirs:a}}}zr.code="MergeConflictError";class cr extends F{constructor(e){super(`No name was provided for ${e} in the argument or in the .git/config file.`),this.code=this.name=cr.code,this.data={role:e}}}cr.code="MissingNameError";class Er extends F{constructor(e){super(`The function requires a "${e}" parameter but none was provided.`),this.code=this.name=Er.code,this.data={parameter:e}}}Er.code="MissingParameterError";class jn extends F{constructor(e){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=jn.code,this.data={errors:e},this.errors=e}}jn.code="MultipleGitError";class fn extends F{constructor(e,t){super(`Expected "${e}" but received "${t}".`),this.code=this.name=fn.code,this.data={expected:e,actual:t}}}fn.code="ParseError";class Dt extends F{constructor(e){let t="";e==="not-fast-forward"?t=" because it was not a simple fast-forward":e==="tag-exists"&&(t=" because tag already exists"),super(`Push rejected${t}. Use "force: true" to override.`),this.code=this.name=Dt.code,this.data={reason:e}}}Dt.code="PushRejectedError";class $r extends F{constructor(e,t){super(`Remote does not support the "${e}" so the "${t}" parameter cannot be used.`),this.code=this.name=$r.code,this.data={capability:e,parameter:t}}}$r.code="RemoteCapabilityError";class rn extends F{constructor(e,t){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${e}`),this.code=this.name=rn.code,this.data={preview:e,response:t}}}rn.code="SmartHttpError";class Hr extends F{constructor(e,t,i){super(`Git remote "${e}" uses an unrecognized transport protocol: "${t}"`),this.code=this.name=Hr.code,this.data={url:e,transport:t,suggestion:i}}}Hr.code="UnknownTransportError";class Sn extends F{constructor(e){super(`Cannot parse remote URL: "${e}"`),this.code=this.name=Sn.code,this.data={url:e}}}Sn.code="UrlParseError";class hn extends F{constructor(){super("The operation was canceled."),this.code=this.name=hn.code,this.data={}}}hn.code="UserCanceledError";class dn extends F{constructor(e){super(`Could not merge index: Entry for '${e}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=dn.code,this.data={filepath:e}}}dn.code="IndexResetError";class Mn extends F{constructor(e){super(`"${e}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=Mn.code,this.data={ref:e}}}Mn.code="NoCommitError";var Qn=Object.freeze({__proto__:null,AlreadyExistsError:wr,AmbiguousError:Or,CheckoutConflictError:Fn,CherryPickMergeCommitError:Lr,CherryPickRootCommitError:ln,CommitNotFetchedError:En,EmptyServerResponseError:An,FastForwardError:Dr,GitPushError:Dn,HttpError:en,InternalError:B,InvalidFilepathError:tn,InvalidOidError:kt,InvalidRefNameError:xt,MaxDepthError:Nn,MergeNotSupportedError:kn,MergeConflictError:zr,MissingNameError:cr,MissingParameterError:Er,MultipleGitError:jn,NoRefspecError:qe,NotFoundError:ct,ObjectTypeError:ht,ParseError:fn,PushRejectedError:Dt,RemoteCapabilityError:$r,SmartHttpError:rn,UnknownTransportError:Hr,UnsafeFilepathError:z,UrlParseError:Sn,UserCanceledError:hn,UnmergedPathsError:D,IndexResetError:dn,NoCommitError:Mn});function wi({name:n,email:e,timestamp:t,timezoneOffset:i}){return i=Os(i),`${n} <${e}> ${t} ${i}`}function Os(n){const e=Ct(ba(n));n=Math.abs(n);const t=Math.floor(n/60);n-=t*60;let i=String(t),a=String(n);return i.length<2&&(i="0"+i),a.length<2&&(a="0"+a),(e===-1?"-":"+")+i+a}function Ct(n){return Math.sign(n)||(Object.is(n,-0)?-1:1)}function ba(n){return n===0?n:-n}function nn(n){return n=n.replace(/\r/g,""),n=n.replace(/^\n+/,""),n=n.replace(/\n+$/,"")+`
`,n}function gi(n){const[,e,t,i,a]=n.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:e,email:t,timestamp:Number(i),timezoneOffset:Pr(a)}}function Pr(n){let[,e,t,i]=n.match(/(\+|-)(\d\d)(\d\d)/);return i=(e==="+"?1:-1)*(Number(t)*60+Number(i)),qn(i)}function qn(n){return n===0?n:-n}class mr{constructor(e){if(typeof e=="string")this._tag=e;else if(Buffer.isBuffer(e))this._tag=e.toString("utf8");else if(typeof e=="object")this._tag=mr.render(e);else throw new B("invalid type passed to GitAnnotatedTag constructor")}static from(e){return new mr(e)}static render(e){return`object ${e.object}
type ${e.type}
tag ${e.tag}
tagger ${wi(e.tagger)}

${e.message}
${e.gpgsig?e.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const e=this.withoutSignature();return e.slice(e.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const e=this.justHeaders().split(`
`),t=[];for(const a of e)a[0]===" "?t[t.length-1]+=`
`+a.slice(1):t.push(a);const i={};for(const a of t){const s=a.slice(0,a.indexOf(" ")),p=a.slice(a.indexOf(" ")+1);Array.isArray(i[s])?i[s].push(p):i[s]=p}return i.tagger&&(i.tagger=gi(i.tagger)),i.committer&&(i.committer=gi(i.committer)),i}withoutSignature(){const e=nn(this._tag);return e.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?e:e.slice(0,e.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const e=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return nn(e)}payload(){return this.withoutSignature()+`
`}toObject(){return Buffer.from(this._tag,"utf8")}static async sign(e,t,i){const a=e.payload();let{signature:s}=await t({payload:a,secretKey:i});s=nn(s);const p=a+s;return mr.from(p)}}function Gr(n){return n.trim().split(`
`).map(e=>" "+e).join(`
`)+`
`}function _a(n){return n.split(`
`).map(e=>e.replace(/^ /,"")).join(`
`)}class Zt{constructor(e){if(typeof e=="string")this._commit=e;else if(Buffer.isBuffer(e))this._commit=e.toString("utf8");else if(typeof e=="object")this._commit=Zt.render(e);else throw new B("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:e,signature:t}){const i=Zt.justHeaders(e),a=Zt.justMessage(e),s=nn(i+`
gpgsig`+Gr(t)+`
`+a);return new Zt(s)}static from(e){return new Zt(e)}toObject(){return Buffer.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Zt.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(e){return nn(e.slice(e.indexOf(`

`)+2))}static justHeaders(e){return e.slice(0,e.indexOf(`

`))}parseHeaders(){const e=Zt.justHeaders(this._commit).split(`
`),t=[];for(const a of e)a[0]===" "?t[t.length-1]+=`
`+a.slice(1):t.push(a);const i={parent:[]};for(const a of t){const s=a.slice(0,a.indexOf(" ")),p=a.slice(a.indexOf(" ")+1);Array.isArray(i[s])?i[s].push(p):i[s]=p}return i.author&&(i.author=gi(i.author)),i.committer&&(i.committer=gi(i.committer)),i}static renderHeaders(e){let t="";if(e.tree?t+=`tree ${e.tree}
`:t+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,e.parent){if(e.parent.length===void 0)throw new B("commit 'parent' property should be an array");for(const s of e.parent)t+=`parent ${s}
`}const i=e.author;t+=`author ${wi(i)}
`;const a=e.committer||e.author;return t+=`committer ${wi(a)}
`,e.gpgsig&&(t+="gpgsig"+Gr(e.gpgsig)),t}static render(e){return Zt.renderHeaders(e)+`
`+nn(e.message)}render(){return this._commit}withoutSignature(){const e=nn(this._commit);if(e.indexOf(`
gpgsig`)===-1)return e;const t=e.slice(0,e.indexOf(`
gpgsig`)),i=e.slice(e.indexOf(`-----END PGP SIGNATURE-----
`)+28);return nn(t+`
`+i)}isolateSignature(){const e=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return _a(e)}static async sign(e,t,i){const a=e.withoutSignature(),s=Zt.justMessage(e._commit);let{signature:p}=await t({payload:a,secretKey:i});p=nn(p);const T=Zt.justHeaders(e._commit)+`
gpgsig`+Gr(p)+`
`+s;return Zt.from(T)}}async function Jt({fs:n,cache:e,gitdir:t,oid:i}){if(i==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Ge.from([]),oid:i};const{type:a,object:s}=await _t({fs:n,cache:e,gitdir:t,oid:i});if(a==="tag")return i=mr.from(s).parse().object,Jt({fs:n,cache:e,gitdir:t,oid:i});if(a==="commit")return i=Zt.from(s).parse().tree,Jt({fs:n,cache:e,gitdir:t,oid:i});if(a!=="tree")throw new ht(i,a,"tree");return{tree:Ge.from(s),oid:i}}class Kr{constructor({fs:e,gitdir:t,ref:i,cache:a}){this.fs=e,this.cache=a,this.gitdir=t,this.mapPromise=(async()=>{const p=new Map;let E;try{E=await G.resolve({fs:e,gitdir:t,ref:i})}catch(C){C instanceof ct&&(E="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const T=await Jt({fs:e,cache:this.cache,gitdir:t,oid:E});return T.type="tree",T.mode="40000",p.set(".",T),p})();const s=this;this.ConstructEntry=class{constructor(E){this._fullpath=E,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(e){const t=e._fullpath,{fs:i,cache:a,gitdir:s}=this,p=await this.mapPromise,E=p.get(t);if(!E)throw new Error(`No obj for ${t}`);const T=E.oid;if(!T)throw new Error(`No oid for obj ${JSON.stringify(E)}`);if(E.type!=="tree")return null;const{type:C,object:I}=await _t({fs:i,cache:a,gitdir:s,oid:T});if(C!==E.type)throw new ht(T,C,E.type);const N=Ge.from(I);for(const M of N)p.set(_e(t,M.path),M);return N.entries().map(M=>_e(t,M.path))}async type(e){if(e._type===!1){const t=await this.mapPromise,{type:i}=t.get(e._fullpath);e._type=i}return e._type}async mode(e){if(e._mode===!1){const t=await this.mapPromise,{mode:i}=t.get(e._fullpath);e._mode=ie(parseInt(i,8))}return e._mode}async stat(e){}async content(e){if(e._content===!1){const t=await this.mapPromise,{fs:i,cache:a,gitdir:s}=this,E=t.get(e._fullpath).oid,{type:T,object:C}=await _t({fs:i,cache:a,gitdir:s,oid:E});T!=="blob"?e._content=void 0:e._content=new Uint8Array(C)}return e._content}async oid(e){if(e._oid===!1){const i=(await this.mapPromise).get(e._fullpath);e._oid=i.oid}return e._oid}}function gr({ref:n="HEAD"}={}){const e=Object.create(null);return Object.defineProperty(e,Mt,{value:function({fs:t,gitdir:i,cache:a}){return new Kr({fs:t,gitdir:i,ref:n,cache:a})}}),Object.freeze(e),e}class ei{constructor({fs:e,dir:t,gitdir:i,cache:a}){this.fs=e,this.cache=a,this.dir=t,this.gitdir=i,this.config=null;const s=this;this.ConstructEntry=class{constructor(E){this._fullpath=E,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(e){const t=e._fullpath,{fs:i,dir:a}=this,s=await i.readdir(_e(a,t));return s===null?null:s.map(p=>_e(t,p))}async type(e){return e._type===!1&&await e.stat(),e._type}async mode(e){return e._mode===!1&&await e.stat(),e._mode}async stat(e){if(e._stat===!1){const{fs:t,dir:i}=this;let a=await t.lstat(`${i}/${e._fullpath}`);if(!a)throw new Error(`ENOENT: no such file or directory, lstat '${e._fullpath}'`);let s=a.isDirectory()?"tree":"blob";s==="blob"&&!a.isFile()&&!a.isSymbolicLink()&&(s="special"),e._type=s,a=Q(a),e._mode=a.mode,a.size===-1&&e._actualSize&&(a.size=e._actualSize),e._stat=a}return e._stat}async content(e){if(e._content===!1){const{fs:t,dir:i,gitdir:a}=this;if(await e.type()==="tree")e._content=void 0;else{let s;if(await e.mode()>>12===10)s=await t.readlink(`${i}/${e._fullpath}`);else{const E=await(await this._getGitConfig(t,a)).get("core.autocrlf");s=await t.read(`${i}/${e._fullpath}`,{autocrlf:E})}e._actualSize=s.length,e._stat&&e._stat.size===-1&&(e._stat.size=e._actualSize),e._content=new Uint8Array(s)}}return e._content}async oid(e){if(e._oid===!1){const t=this,{fs:i,gitdir:a,cache:s}=this;let p;await Ue.acquire({fs:i,gitdir:a,cache:s},async function(E){const T=E.entriesMap.get(e._fullpath),C=await e.stat(),N=await(await t._getGitConfig(i,a)).get("core.filemode"),M=typeof process<"u"?process.platform!=="win32":!0;if(!T||Se(C,T,N,M)){const Y=await e.content();Y===void 0?p=void 0:(p=await le(yt.wrap({type:"blob",object:Y})),T&&p===T.oid&&(!N||C.mode===T.mode)&&Se(C,T,N,M)&&E.insert({filepath:e._fullpath,stats:C,oid:p}))}else p=T.oid}),e._oid=p}return e._oid}async _getGitConfig(e,t){return this.config?this.config:(this.config=await W.get({fs:e,gitdir:t}),this.config)}}function pn(){const n=Object.create(null);return Object.defineProperty(n,Mt,{value:function({fs:e,dir:t,gitdir:i,cache:a}){return new ei({fs:e,dir:t,gitdir:i,cache:a})}}),Object.freeze(n),n}function mn(n,e){const t=e-n;return Array.from({length:t},(i,a)=>n+a)}const xa=typeof Array.prototype.flat>"u"?n=>n.reduce((e,t)=>e.concat(t),[]):n=>n.flat();class Wr{constructor(){this.value=null}consider(e){e!=null&&(this.value===null?this.value=e:e<this.value&&(this.value=e))}reset(){this.value=null}}function*qi(n){const e=new Wr;let t;const i=[],a=n.length;for(let s=0;s<a;s++)i[s]=n[s].next().value,i[s]!==void 0&&e.consider(i[s]);if(e.value!==null)for(;;){const s=[];t=e.value,e.reset();for(let p=0;p<a;p++)i[p]!==void 0&&i[p]===t?(s[p]=i[p],i[p]=n[p].next().value):s[p]=null,i[p]!==void 0&&e.consider(i[p]);if(yield s,e.value===null)return}}async function an({fs:n,cache:e,dir:t,gitdir:i,trees:a,map:s=async(T,C)=>C,reduce:p=async(T,C)=>{const I=xa(C);return T!==void 0&&I.unshift(T),I},iterate:E=(T,C)=>Promise.all([...C].map(T))}){const T=a.map(Y=>Y[Mt]({fs:n,dir:t,gitdir:i,cache:e})),C=new Array(T.length).fill("."),I=mn(0,T.length),N=async Y=>{I.forEach(xe=>{const Oe=Y[xe];Y[xe]=Oe&&new T[xe].ConstructEntry(Oe)});const Ie=(await Promise.all(I.map(xe=>{const Oe=Y[xe];return Oe?T[xe].readdir(Oe):[]}))).map(xe=>(xe===null?[]:xe)[Symbol.iterator]());return{entries:Y,children:qi(Ie)}},M=async Y=>{const{entries:he,children:Ie}=await N(Y),xe=he.find($e=>$e&&$e._fullpath)._fullpath,Oe=await s(xe,he);if(Oe!==null){let $e=await E(M,Ie);return $e=$e.filter(Ye=>Ye!==void 0),p(Oe,$e)}};return M(C)}async function ti(n,e){const t=await n.readdir(e);t==null?await n.rm(e):t.length?await Promise.all(t.map(i=>{const a=_e(e,i);return n.lstat(a).then(s=>{if(s)return s.isDirectory()?ti(n,a):n.rm(a)})})).then(()=>n.rmdir(e)):await n.rmdir(e)}function ri(n){return Ui(n)&&Li(n.then)&&Li(n.catch)}function Ui(n){return n&&typeof n=="object"}function Li(n){return typeof n=="function"}function Ea(n){return ri((t=>{try{return t.readFile().catch(i=>i)}catch(i){return i}})(n))}const Un=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function Aa(n,e){if(Ea(e))for(const t of Un)n[`_${t}`]=e[t].bind(e);else for(const t of Un)n[`_${t}`]=_(e[t].bind(e));Ea(e)?(e.cp&&(n._cp=e.cp.bind(e)),e.rm?n._rm=e.rm.bind(e):e.rmdir.length>1?n._rm=e.rmdir.bind(e):n._rm=ti.bind(null,n)):(e.cp&&(n._cp=_(e.cp.bind(e))),e.rm?n._rm=_(e.rm.bind(e)):e.rmdir.length>2?n._rm=_(e.rmdir.bind(e)):n._rm=ti.bind(null,n))}class at{constructor(e){if(typeof e._original_unwrapped_fs<"u")return e;const t=Object.getOwnPropertyDescriptor(e,"promises");t&&t.enumerable?Aa(this,e.promises):Aa(this,e),this._original_unwrapped_fs=e}async exists(e,t={}){try{return await this._stat(e),!0}catch(i){if(i.code==="ENOENT"||i.code==="ENOTDIR"||(i.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',i),i}}async read(e,t={}){try{let i=await this._readFile(e,t);if(t.autocrlf==="true")try{i=new TextDecoder("utf8",{fatal:!0}).decode(i),i=i.replace(/\r\n/g,`
`),i=new TextEncoder().encode(i)}catch{}return typeof i!="string"&&(i=Buffer.from(i)),i}catch{return null}}async write(e,t,i={}){try{await this._writeFile(e,t,i)}catch{await this.mkdir(pt(e)),await this._writeFile(e,t,i)}}async mkdir(e,t=!1){try{await this._mkdir(e)}catch(i){if(i===null||i.code==="EEXIST")return;if(t)throw i;if(i.code==="ENOENT"){const a=pt(e);if(a==="."||a==="/"||a===e)throw i;await this.mkdir(a),await this.mkdir(e,!0)}}}async rm(e){try{await this._unlink(e)}catch(t){if(t.code!=="ENOENT")throw t}}async rmdir(e,t){try{t&&t.recursive?await this._rm(e,t):await this._rmdir(e)}catch(i){if(i.code!=="ENOENT")throw i}}async readdir(e){try{const t=await this._readdir(e);return t.sort(V),t}catch(t){return t.code==="ENOTDIR"?null:[]}}async readdirDeep(e){const t=await this._readdir(e);return(await Promise.all(t.map(async a=>{const s=e+"/"+a;return(await this._stat(s)).isDirectory()?this.readdirDeep(s):s}))).reduce((a,s)=>a.concat(s),[])}async lstat(e){try{return await this._lstat(e)}catch(t){if(t.code==="ENOENT"||(t.code||"").includes("ENS"))return null;throw t}}async readlink(e,t={encoding:"buffer"}){try{const i=await this._readlink(e,t);return Buffer.isBuffer(i)?i:Buffer.from(i)}catch(i){if(i.code==="ENOENT"||(i.code||"").includes("ENS"))return null;throw i}}async writelink(e,t){return this._symlink(t.toString("utf8"),e)}}function se(n,e){if(e===void 0)throw new Er(n)}async function it({fsp:n,dotgit:e}){se("fsp",n),se("dotgit",e);const t=await n._stat(e).catch(()=>({isFile:()=>!1,isDirectory:()=>!1}));return t.isDirectory()?e:t.isFile()?n._readFile(e,"utf8").then(i=>i.trimRight().substr(8)).then(i=>_e(pt(e),i)):e}async function Ln(n,e){return!n&&!e?!1:n&&!e||!n&&e?!0:!(await n.type()==="tree"&&await e.type()==="tree"||await n.type()===await e.type()&&await n.mode()===await e.mode()&&await n.oid()===await e.oid())}async function ka({fs:n,dir:e,gitdir:t=_e(e,".git"),commit:i="HEAD",cache:a={}}){try{se("fs",n),se("dir",e),se("gitdir",t);const s=new at(n),p=[gr({ref:i}),pn(),Et()];let E=[];const T=await it({fsp:s,dotgit:t});await Ue.acquire({fs:s,gitdir:T,cache:a},async function(I){E=I.unmergedPaths});const C=await an({fs:s,cache:a,dir:e,gitdir:T,trees:p,map:async function(I,[N,M,Y]){const he=!await Ln(M,Y),Ie=E.includes(I),xe=!await Ln(Y,N);if(he||Ie)return N?{path:I,mode:await N.mode(),oid:await N.oid(),type:await N.type(),content:await N.content()}:void 0;if(xe)return!1;throw new dn(I)}});await Ue.acquire({fs:s,gitdir:T,cache:a},async function(I){for(const N of C)if(N!==!1){if(!N){await s.rmdir(`${e}/${N.path}`,{recursive:!0}),I.delete({filepath:N.path});continue}if(N.type==="blob"){const M=new TextDecoder().decode(N.content);await s.write(`${e}/${N.path}`,M,{mode:N.mode}),I.insert({filepath:N.path,oid:N.oid,stage:0})}}})}catch(s){throw s.caller="git.abortMerge",s}}class zn{static async isIgnored({fs:e,dir:t,gitdir:i=_e(t,".git"),filepath:a}){if(mt(a)===".git")return!0;if(a===".")return!1;let s="";const p=_e(i,"info","exclude");await e.exists(p)&&(s=await e.read(p,"utf8"));const E=[{gitignore:_e(t,".gitignore"),filepath:a}],T=a.split("/").filter(Boolean);for(let I=1;I<T.length;I++){const N=T.slice(0,I).join("/"),M=T.slice(I).join("/");E.push({gitignore:_e(t,N,".gitignore"),filepath:M})}let C=!1;for(const I of E){let N;try{N=await e.read(I.gitignore,"utf8")}catch(he){if(he.code==="NOENT")continue}const M=A().add(s);M.add(N);const Y=pt(I.filepath);if(Y!=="."&&M.ignores(Y))return!0;C?C=!M.test(I.filepath).unignored:C=M.test(I.filepath).ignored}return C}}async function Ps({fs:n,gitdir:e,object:t,format:i,oid:a}){const s=`objects/${a.slice(0,2)}/${a.slice(2)}`,p=`${e}/${s}`;await n.exists(p)||await n.write(p,t)}let ni=null;async function yi(n){return ni===null&&(ni=vi()),ni?Sa(n):k.deflate(n)}async function Sa(n){const e=new CompressionStream("deflate"),t=new Blob([n]).stream().pipeThrough(e);return new Uint8Array(await new Response(t).arrayBuffer())}function vi(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function yr({fs:n,gitdir:e,type:t,object:i,format:a="content",oid:s=void 0,dryRun:p=!1}){return a!=="deflated"&&(a!=="wrapped"&&(i=yt.wrap({type:t,object:i})),s=await le(i),i=Buffer.from(await yi(i))),p||await Ps({fs:n,gitdir:e,object:i,format:"deflated",oid:s}),s}function ii(n){let e;for(;~(e=n.indexOf(92));)n[e]=47;return n}async function zi({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i,cache:a={},force:s=!1,parallel:p=!0}){try{se("fs",n),se("dir",e),se("gitdir",t),se("filepath",i);const E=new at(n),T=await it({fsp:E,dotgit:t});await Ue.acquire({fs:E,gitdir:T,cache:a},async C=>{const N=await(await W.get({fs:E,gitdir:T})).get("core.autocrlf");return Hi({dir:e,gitdir:T,fs:E,filepath:i,index:C,force:s,parallel:p,autocrlf:N})})}catch(E){throw E.caller="git.add",E}}async function Hi({dir:n,gitdir:e,fs:t,filepath:i,index:a,force:s,parallel:p,autocrlf:E}){i=Array.isArray(i)?i:[i];const T=i.map(async M=>{if(!s&&await zn.isIgnored({fs:t,dir:n,gitdir:e,filepath:M}))return;const Y=await t.lstat(_e(n,M));if(!Y)throw new ct(M);if(Y.isDirectory()){const he=await t.readdir(_e(n,M));if(p){const Ie=he.map(xe=>Hi({dir:n,gitdir:e,fs:t,filepath:[_e(M,xe)],index:a,force:s,parallel:p,autocrlf:E}));await Promise.all(Ie)}else for(const Ie of he)await Hi({dir:n,gitdir:e,fs:t,filepath:[_e(M,Ie)],index:a,force:s,parallel:p,autocrlf:E})}else{const he=Y.isSymbolicLink()?await t.readlink(_e(n,M)).then(ii):await t.read(_e(n,M),{autocrlf:E});if(he===null)throw new ct(M);const Ie=await yr({fs:t,gitdir:e,type:"blob",object:he});a.insert({filepath:M,stats:Y,oid:Ie})}}),C=await Promise.allSettled(T),I=C.filter(M=>M.status==="rejected").map(M=>M.reason);if(I.length>1)throw new jn(I);if(I.length===1)throw I[0];return C.filter(M=>M.status==="fulfilled"&&M.value).map(M=>M.value)}async function Zr({fs:n,gitdir:e,path:t}){return(await W.get({fs:n,gitdir:e})).get(t)}function bi(n,...e){for(const t of e)if(t)for(const i of Object.keys(t)){const a=t[i];a!==void 0&&(n[i]=a)}return n}async function Vr({fs:n,gitdir:e,author:t,commit:i}){const a=Math.floor(Date.now()/1e3),s={name:await Zr({fs:n,gitdir:e,path:"user.name"}),email:await Zr({fs:n,gitdir:e,path:"user.email"})||"",timestamp:a,timezoneOffset:new Date(a*1e3).getTimezoneOffset()},p=bi({},s,i?i.author:void 0,t);if(p.name!==void 0)return p}async function on({fs:n,gitdir:e,author:t,committer:i,commit:a}){const s=Math.floor(Date.now()/1e3),p={name:await Zr({fs:n,gitdir:e,path:"user.name"}),email:await Zr({fs:n,gitdir:e,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},E=bi({},p,a?a.committer:void 0,t,i);if(E.name!==void 0)return E}async function _i({fs:n,cache:e,gitdir:t,oid:i}){const{type:a,object:s}=await _t({fs:n,cache:e,gitdir:t,oid:i});if(a==="tag")return i=mr.from(s).parse().object,_i({fs:n,cache:e,gitdir:t,oid:i});if(a!=="commit")throw new ht(i,a,"commit");return{commit:Zt.from(s),oid:i}}async function Vt({fs:n,cache:e,gitdir:t,oid:i}){const{commit:a,oid:s}=await _i({fs:n,cache:e,gitdir:t,oid:i});return{oid:s,commit:a.parse(),payload:a.withoutSignature()}}async function sn({fs:n,cache:e,onSign:t,gitdir:i,message:a,author:s,committer:p,signingKey:E,amend:T=!1,dryRun:C=!1,noUpdateBranch:I=!1,ref:N,parent:M,tree:Y}){let he=!1,Ie=!1;N||(Ie=!(await n.read(`${i}/HEAD`,{encoding:"utf8"})).startsWith("ref:"),N=await G.resolve({fs:n,gitdir:i,ref:"HEAD",depth:2}));let xe,Oe;try{xe=await G.resolve({fs:n,gitdir:i,ref:N}),Oe=await Vt({fs:n,gitdir:i,oid:xe,cache:{}})}catch{he=!0}if(T&&he)throw new Mn(N);const $e=T?await Vr({fs:n,gitdir:i,author:s,commit:Oe.commit}):await Vr({fs:n,gitdir:i,author:s});if(!$e)throw new cr("author");const Ye=T?await on({fs:n,gitdir:i,author:$e,committer:p,commit:Oe.commit}):await on({fs:n,gitdir:i,author:$e,committer:p});if(!Ye)throw new cr("committer");return Ue.acquire({fs:n,gitdir:i,cache:e,allowUnmerged:!1},async function(rt){const st=gt(rt.entries).get(".");if(Y||(Y=await Hn({fs:n,gitdir:i,inode:st,dryRun:C})),M?M=await Promise.all(M.map(Xe=>G.resolve({fs:n,gitdir:i,ref:Xe}))):T?M=Oe.commit.parent:M=xe?[xe]:[],!a)if(T)a=Oe.commit.message;else throw new Er("message");let He=Zt.from({tree:Y,parent:M,author:$e,committer:Ye,message:a});E&&(He=await Zt.sign(He,t,E));const Ke=await yr({fs:n,gitdir:i,type:"commit",object:He.toObject(),dryRun:C});return!I&&!C&&await G.writeRef({fs:n,gitdir:i,ref:Ie?"HEAD":N,value:Ke}),Ke})}async function Hn({fs:n,gitdir:e,inode:t,dryRun:i}){const a=t.children;for(const T of a)T.type==="tree"&&(T.metadata.mode="040000",T.metadata.oid=await Hn({fs:n,gitdir:e,inode:T,dryRun:i}));const s=a.map(T=>({mode:T.metadata.mode,path:T.basename,oid:T.metadata.oid,type:T.type})),p=Ge.from(s);return await yr({fs:n,gitdir:e,type:"tree",object:p.toObject(),dryRun:i})}async function Gn({fs:n,cache:e,gitdir:t,oid:i,filepath:a}){if(a.startsWith("/"))throw new tn("leading-slash");if(a.endsWith("/"))throw new tn("trailing-slash");const s=i,p=await Jt({fs:n,cache:e,gitdir:t,oid:i}),E=p.tree;if(a==="")i=p.oid;else{const T=a.split("/");i=await ai({fs:n,cache:e,gitdir:t,tree:E,pathArray:T,oid:s,filepath:a})}return i}async function ai({fs:n,cache:e,gitdir:t,tree:i,pathArray:a,oid:s,filepath:p}){const E=a.shift();for(const T of i)if(T.path===E){if(a.length===0)return T.oid;{const{type:C,object:I}=await _t({fs:n,cache:e,gitdir:t,oid:T.oid});if(C!=="tree")throw new ht(s,C,"tree",p);return i=Ge.from(I),ai({fs:n,cache:e,gitdir:t,tree:i,pathArray:a,oid:s,filepath:p})}}throw new ct(`file or directory found at "${s}:${p}"`)}async function Rn({fs:n,cache:e,gitdir:t,oid:i,filepath:a=void 0}){a!==void 0&&(i=await Gn({fs:n,cache:e,gitdir:t,oid:i,filepath:a}));const{tree:s,oid:p}=await Jt({fs:n,cache:e,gitdir:t,oid:i});return{oid:p,tree:s.entries()}}async function Kn({fs:n,gitdir:e,tree:t}){const i=Ge.from(t).toObject();return await yr({fs:n,gitdir:e,type:"tree",object:i,format:"content"})}async function xi({fs:n,cache:e,onSign:t,gitdir:i,ref:a,oid:s,note:p,force:E,author:T,committer:C,signingKey:I}){let N;try{N=await G.resolve({gitdir:i,fs:n,ref:a})}catch(Oe){if(!(Oe instanceof ct))throw Oe}let Y=(await Rn({fs:n,cache:e,gitdir:i,oid:N||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(E)Y=Y.filter(Oe=>Oe.path!==s);else for(const Oe of Y)if(Oe.path===s)throw new wr("note",s);typeof p=="string"&&(p=Buffer.from(p,"utf8"));const he=await yr({fs:n,gitdir:i,type:"blob",object:p,format:"content"});Y.push({mode:"100644",path:s,oid:he,type:"blob"});const Ie=await Kn({fs:n,gitdir:i,tree:Y});return await sn({fs:n,cache:e,onSign:t,gitdir:i,ref:a,tree:Ie,parent:N&&[N],message:`Note added by 'isomorphic-git addNote'
`,author:T,committer:C,signingKey:I})}async function Ei({fs:n,onSign:e,dir:t,gitdir:i=_e(t,".git"),ref:a="refs/notes/commits",oid:s,note:p,force:E,author:T,committer:C,signingKey:I,cache:N={}}){try{se("fs",n),se("gitdir",i),se("oid",s),se("note",p),I&&se("onSign",e);const M=new at(n),Y=await Vr({fs:M,gitdir:i,author:T});if(!Y)throw new cr("author");const he=await on({fs:M,gitdir:i,author:Y,committer:C});if(!he)throw new cr("committer");const Ie=await it({fsp:M,dotgit:i});return await xi({fs:M,cache:N,onSign:e,gitdir:Ie,ref:a,oid:s,note:p,force:E,author:Y,committer:he,signingKey:I})}catch(M){throw M.caller="git.addNote",M}}const In=/(^|[/.])([/.]|$)|^@$|@{|[\x00-\x20\x7f~^:?*[\\]|\.lock(\/|$)/;function Tn(n,e){if(typeof n!="string")throw new TypeError("Reference name must be a string");return!In.test(n)&&!0}async function Ai({fs:n,gitdir:e,remote:t,url:i,force:a}){if(!Tn(t))throw new xt(t,d.clean(t));const s=await W.get({fs:n,gitdir:e});if(!a&&(await s.getSubsections("remote")).includes(t)&&i!==await s.get(`remote.${t}.url`))throw new wr("remote",t);await s.set(`remote.${t}.url`,i),await s.set(`remote.${t}.fetch`,`+refs/heads/*:refs/remotes/${t}/*`),await W.save({fs:n,gitdir:e,config:s})}async function oi({fs:n,dir:e,gitdir:t=_e(e,".git"),remote:i,url:a,force:s=!1}){try{se("fs",n),se("gitdir",t),se("remote",i),se("url",a);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Ai({fs:p,gitdir:E,remote:i,url:a,force:s})}catch(p){throw p.caller="git.addRemote",p}}async function Gi({fs:n,cache:e,onSign:t,gitdir:i,ref:a,tagger:s,message:p=a,gpgsig:E,object:T,signingKey:C,force:I=!1}){if(a=a.startsWith("refs/tags/")?a:`refs/tags/${a}`,!I&&await G.exists({fs:n,gitdir:i,ref:a}))throw new wr("tag",a);const N=await G.resolve({fs:n,gitdir:i,ref:T||"HEAD"}),{type:M}=await _t({fs:n,cache:e,gitdir:i,oid:N});let Y=mr.from({object:N,type:M,tag:a.replace("refs/tags/",""),tagger:s,message:p,gpgsig:E});C&&(Y=await mr.sign(Y,t,C));const he=await yr({fs:n,gitdir:i,type:"tag",object:Y.toObject()});await G.writeRef({fs:n,gitdir:i,ref:a,value:he})}async function Ki({fs:n,onSign:e,dir:t,gitdir:i=_e(t,".git"),ref:a,tagger:s,message:p=a,gpgsig:E,object:T,signingKey:C,force:I=!1,cache:N={}}){try{se("fs",n),se("gitdir",i),se("ref",a),C&&se("onSign",e);const M=new at(n),Y=await it({fsp:M,dotgit:i}),he=await Vr({fs:M,gitdir:Y,author:s});if(!he)throw new cr("tagger");return await Gi({fs:M,cache:N,onSign:e,gitdir:Y,ref:a,tagger:he,message:p,gpgsig:E,object:T,signingKey:C,force:I})}catch(M){throw M.caller="git.annotatedTag",M}}async function Bs({fs:n,gitdir:e,ref:t,object:i,checkout:a=!1,force:s=!1}){if(!Tn(t))throw new xt(t,d.clean(t));const p=`refs/heads/${t}`;if(!s&&await G.exists({fs:n,gitdir:e,ref:p}))throw new wr("branch",t,!1);let E;try{E=await G.resolve({fs:n,gitdir:e,ref:i||"HEAD"})}catch{}E&&await G.writeRef({fs:n,gitdir:e,ref:p,value:E}),a&&await G.writeSymbolicRef({fs:n,gitdir:e,ref:"HEAD",value:p})}async function ki({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,object:a,checkout:s=!1,force:p=!1}){try{se("fs",n),se("gitdir",t),se("ref",i);const E=new at(n),T=await it({fsp:E,dotgit:t});return await Bs({fs:E,gitdir:T,ref:i,object:a,checkout:s,force:p})}catch(E){throw E.caller="git.branch",E}}const si=(n,e)=>n==="."||e==null||e.length===0||e==="."?!0:e.length>=n.length?e.startsWith(n):n.startsWith(e);async function Wi({fs:n,cache:e,onProgress:t,onPostCheckout:i,dir:a,gitdir:s,remote:p,ref:E,filepaths:T,noCheckout:C,noUpdateHead:I,dryRun:N,force:M,track:Y=!0,nonBlocking:he=!1,batchSize:Ie=100}){let xe;if(i)try{xe=await G.resolve({fs:n,gitdir:s,ref:"HEAD"})}catch{xe="0000000000000000000000000000000000000000"}let Oe;try{Oe=await G.resolve({fs:n,gitdir:s,ref:E})}catch($e){if(E==="HEAD")throw $e;const Ye=`${p}/${E}`;if(Oe=await G.resolve({fs:n,gitdir:s,ref:Ye}),Y){const rt=await W.get({fs:n,gitdir:s});await rt.set(`branch.${E}.remote`,p),await rt.set(`branch.${E}.merge`,`refs/heads/${E}`),await W.save({fs:n,gitdir:s,config:rt})}await G.writeRef({fs:n,gitdir:s,ref:`refs/heads/${E}`,value:Oe})}if(!C){let $e;try{$e=await Zi({fs:n,cache:e,onProgress:t,dir:a,gitdir:s,ref:E,force:M,filepaths:T})}catch(He){throw He instanceof ct&&He.data.what===Oe?new En(E,Oe):He}const Ye=$e.filter(([He])=>He==="conflict").map(([He,Ke])=>Ke);if(Ye.length>0)throw new Fn(Ye);const rt=$e.filter(([He])=>He==="error").map(([He,Ke])=>Ke);if(rt.length>0)throw new B(rt.join(", "));if(N){i&&await i({previousHead:xe,newHead:Oe,type:T!=null&&T.length>0?"file":"branch"});return}let ot=0;const st=$e.length;if(await Ue.acquire({fs:n,gitdir:s,cache:e},async function(He){await Promise.all($e.filter(([Ke])=>Ke==="delete"||Ke==="delete-index").map(async function([Ke,Xe]){const At=`${a}/${Xe}`;Ke==="delete"&&await n.rm(At),He.delete({filepath:Xe}),t&&await t({phase:"Updating workdir",loaded:++ot,total:st})}))}),await Ue.acquire({fs:n,gitdir:s,cache:e},async function(He){for(const[Ke,Xe]of $e)if(Ke==="rmdir"||Ke==="rmdir-index"){const At=`${a}/${Xe}`;try{Ke==="rmdir"&&await n.rmdir(At),He.delete({filepath:Xe}),t&&await t({phase:"Updating workdir",loaded:++ot,total:st})}catch(Nt){if(Nt.code==="ENOTEMPTY")console.log(`Did not delete ${Xe} because directory is not empty`);else throw Nt}}}),await Promise.all($e.filter(([He])=>He==="mkdir"||He==="mkdir-index").map(async function([He,Ke]){const Xe=`${a}/${Ke}`;await n.mkdir(Xe),t&&await t({phase:"Updating workdir",loaded:++ot,total:st})})),he){const He=$e.filter(([Xe])=>Xe==="create"||Xe==="create-index"||Xe==="update"||Xe==="mkdir-index"),Ke=await Yi("Update Working Dir",He.map(([Xe,At,Nt,vr,Ut])=>()=>Cs({fs:n,cache:e,gitdir:s,dir:a},[Xe,At,Nt,vr,Ut])),t,Ie);await Ue.acquire({fs:n,gitdir:s,cache:e,allowUnmerged:!0},async function(Xe){await Yi("Update Index",Ke.map(([At,Nt,vr])=>()=>Vi({index:Xe,fullpath:At,oid:Nt,stats:vr})),t,Ie)})}else await Ue.acquire({fs:n,gitdir:s,cache:e,allowUnmerged:!0},async function(He){await Promise.all($e.filter(([Ke])=>Ke==="create"||Ke==="create-index"||Ke==="update"||Ke==="mkdir-index").map(async function([Ke,Xe,At,Nt,vr]){const Ut=`${a}/${Xe}`;try{if(Ke!=="create-index"&&Ke!=="mkdir-index"){const{object:Ar}=await _t({fs:n,cache:e,gitdir:s,oid:At});if(vr&&await n.rm(Ut),Nt===33188)await n.write(Ut,Ar);else if(Nt===33261)await n.write(Ut,Ar,{mode:511});else if(Nt===40960)await n.writelink(Ut,Ar);else throw new B(`Invalid mode 0o${Nt.toString(8)} detected in blob ${At}`)}const br=await n.lstat(Ut);Nt===33261&&(br.mode=493),Ke==="mkdir-index"&&(br.mode=57344),He.insert({filepath:Xe,stats:br,oid:At}),t&&await t({phase:"Updating workdir",loaded:++ot,total:st})}catch(br){console.log(br)}}))});i&&await i({previousHead:xe,newHead:Oe,type:T!=null&&T.length>0?"file":"branch"})}if(!I){const $e=await G.expand({fs:n,gitdir:s,ref:E});$e.startsWith("refs/heads")?await G.writeSymbolicRef({fs:n,gitdir:s,ref:"HEAD",value:$e}):await G.writeRef({fs:n,gitdir:s,ref:"HEAD",value:Oe})}}async function Zi({fs:n,cache:e,onProgress:t,dir:i,gitdir:a,ref:s,force:p,filepaths:E}){let T=0;return an({fs:n,cache:e,dir:i,gitdir:a,trees:[gr({ref:s}),pn(),Et()],map:async function(C,[I,N,M]){if(C===".")return;if(E&&!E.some(he=>si(C,he)))return null;switch(t&&await t({phase:"Analyzing workdir",loaded:++T}),[!!M,!!I,!!N].map(Number).join("")){case"000":return;case"001":return p&&E&&E.includes(C)?["delete",C]:void 0;case"010":switch(await I.type()){case"tree":return["mkdir",C];case"blob":return["create",C,await I.oid(),await I.mode()];case"commit":return["mkdir-index",C,await I.oid(),await I.mode()];default:return["error",`new entry Unhandled type ${await I.type()}`]}case"011":switch(`${await I.type()}-${await N.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",C];case"blob-blob":return await I.oid()!==await N.oid()?p?["update",C,await I.oid(),await I.mode(),await I.mode()!==await N.mode()]:["conflict",C]:await I.mode()!==await N.mode()?p?["update",C,await I.oid(),await I.mode(),!0]:["conflict",C]:["create-index",C,await I.oid(),await I.mode()];case"commit-tree":return;case"commit-blob":return["conflict",C];default:return["error",`new entry Unhandled type ${I.type}`]}case"100":return["delete-index",C];case"101":switch(await M.type()){case"tree":return["rmdir-index",C];case"blob":return await M.oid()!==await N.oid()?p?["delete",C]:["conflict",C]:["delete",C];case"commit":return["rmdir-index",C];default:return["error",`delete entry Unhandled type ${await M.type()}`]}case"110":case"111":switch(`${await M.type()}-${await I.type()}`){case"tree-tree":return;case"blob-blob":{if(await M.oid()===await I.oid()&&await M.mode()===await I.mode()&&!p)return;if(N){if(await N.oid()!==await M.oid()&&await N.oid()!==await I.oid())return p?["update",C,await I.oid(),await I.mode(),await I.mode()!==await N.mode()]:["conflict",C]}else if(p)return["update",C,await I.oid(),await I.mode(),await I.mode()!==await M.mode()];return await I.mode()!==await M.mode()?["update",C,await I.oid(),await I.mode(),!0]:await I.oid()!==await M.oid()?["update",C,await I.oid(),await I.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",C,await I.oid()];case"blob-tree":return["update-blob-to-tree",C];case"commit-commit":return["mkdir-index",C,await I.oid(),await I.mode()];default:return["error",`update entry Unhandled type ${await M.type()}-${await I.type()}`]}}},reduce:async function(C,I){return I=xa(I),C?C&&C[0]==="rmdir"?(I.push(C),I):(I.unshift(C),I):I}})}async function Vi({index:n,fullpath:e,stats:t,oid:i}){try{n.insert({filepath:e,stats:t,oid:i})}catch(a){console.warn(`Error inserting ${e} into index:`,a)}}async function Cs({fs:n,cache:e,gitdir:t,dir:i},[a,s,p,E,T]){const C=`${i}/${s}`;if(a!=="create-index"&&a!=="mkdir-index"){const{object:N}=await _t({fs:n,cache:e,gitdir:t,oid:p});if(T&&await n.rm(C),E===33188)await n.write(C,N);else if(E===33261)await n.write(C,N,{mode:511});else if(E===40960)await n.writelink(C,N);else throw new B(`Invalid mode 0o${E.toString(8)} detected in blob ${p}`)}const I=await n.lstat(C);return E===33261&&(I.mode=493),a==="mkdir-index"&&(I.mode=57344),[s,p,I]}async function Yi(n,e,t,i){const a=[];try{for(let s=0;s<e.length;s+=i){const p=e.slice(s,s+i).map(T=>T());(await Promise.allSettled(p)).forEach(T=>{T.status==="fulfilled"&&a.push(T.value)}),t&&await t({phase:"Updating workdir",loaded:s+p.length,total:e.length})}return a}catch(s){console.error(`Error during ${n}: ${s}`)}return a}async function Xi({fs:n,onProgress:e,onPostCheckout:t,dir:i,gitdir:a=_e(i,".git"),remote:s="origin",ref:p,filepaths:E,noCheckout:T=!1,noUpdateHead:C=p===void 0,dryRun:I=!1,force:N=!1,track:M=!0,cache:Y={},nonBlocking:he=!1,batchSize:Ie=100}){try{se("fs",n),se("dir",i),se("gitdir",a);const xe=p||"HEAD",Oe=new at(n),$e=await it({fsp:Oe,dotgit:a});return await Wi({fs:Oe,cache:Y,onProgress:e,onPostCheckout:t,dir:i,gitdir:$e,remote:s,ref:xe,filepaths:E,noCheckout:T,noUpdateHead:C,dryRun:I,force:N,track:M,nonBlocking:he,batchSize:Ie})}catch(xe){throw xe.caller="git.checkout",xe}}const Si=/^.*(\r?\n|$)/gm;function Ra({branches:n,contents:e}){const t=n[1],i=n[2],a=e[0],s=e[1],p=e[2],E=s.match(Si),T=a.match(Si),C=p.match(Si),I=y(E,T,C),N=7;let M="",Y=!0;for(const he of I)he.ok&&(M+=he.ok.join("")),he.conflict&&(Y=!1,M+=`${"<".repeat(N)} ${t}
`,M+=he.conflict.a.join(""),M+=`${"=".repeat(N)}
`,M+=he.conflict.b.join(""),M+=`${">".repeat(N)} ${i}
`);return{cleanMerge:Y,mergedText:M}}async function Ia({fs:n,cache:e,dir:t,gitdir:i=_e(t,".git"),index:a,ourOid:s,baseOid:p,theirOid:E,ourName:T="ours",baseName:C="base",theirName:I="theirs",dryRun:N=!1,abortOnConflict:M=!0,mergeDriver:Y}){const he=gr({ref:s}),Ie=gr({ref:p}),xe=gr({ref:E}),Oe=[],$e=[],Ye=[],rt=[],ot=await an({fs:n,cache:e,dir:t,gitdir:i,trees:[he,Ie,xe],map:async function(st,[He,Ke,Xe]){const At=mt(st),Nt=await Ln(He,Ke),vr=await Ln(Xe,Ke);switch(`${Nt}-${vr}`){case"false-false":return{mode:await Ke.mode(),path:At,oid:await Ke.oid(),type:await Ke.type()};case"false-true":return!Xe&&await He.type()==="tree"?{mode:await He.mode(),path:At,oid:await He.oid(),type:await He.type()}:Xe?{mode:await Xe.mode(),path:At,oid:await Xe.oid(),type:await Xe.type()}:void 0;case"true-false":return!He&&await Xe.type()==="tree"?{mode:await Xe.mode(),path:At,oid:await Xe.oid(),type:await Xe.type()}:He?{mode:await He.mode(),path:At,oid:await He.oid(),type:await He.type()}:void 0;case"true-true":{if(He&&Xe&&await He.type()==="tree"&&await Xe.type()==="tree")return{mode:await He.mode(),path:At,oid:await He.oid(),type:"tree"};if(He&&Xe&&await He.type()==="blob"&&await Xe.type()==="blob")return Ta({fs:n,gitdir:i,path:At,ours:He,base:Ke,theirs:Xe,ourName:T,baseName:C,theirName:I,mergeDriver:Y}).then(async Ut=>{if(Ut.cleanMerge)M||a.insert({filepath:st,oid:Ut.mergeResult.oid,stage:0});else if(Oe.push(st),$e.push(st),!M){let br="";Ke&&await Ke.type()==="blob"&&(br=await Ke.oid());const Ar=await He.oid(),ui=await Xe.oid();a.delete({filepath:st}),br&&a.insert({filepath:st,oid:br,stage:1}),a.insert({filepath:st,oid:Ar,stage:2}),a.insert({filepath:st,oid:ui,stage:3})}return Ut.mergeResult});if(Ke&&!He&&Xe&&await Ke.type()==="blob"&&await Xe.type()==="blob"){if(Oe.push(st),Ye.push(st),!M){const Ut=await Ke.oid(),br=await Xe.oid();a.delete({filepath:st}),a.insert({filepath:st,oid:Ut,stage:1}),a.insert({filepath:st,oid:br,stage:3})}return{mode:await Xe.mode(),oid:await Xe.oid(),type:"blob",path:At}}if(Ke&&He&&!Xe&&await Ke.type()==="blob"&&await He.type()==="blob"){if(Oe.push(st),rt.push(st),!M){const Ut=await Ke.oid(),br=await He.oid();a.delete({filepath:st}),a.insert({filepath:st,oid:Ut,stage:1}),a.insert({filepath:st,oid:br,stage:2})}return{mode:await He.mode(),oid:await He.oid(),type:"blob",path:At}}if(Ke&&!He&&!Xe&&(await Ke.type()==="blob"||await Ke.type()==="tree"))return;throw new kn}}},reduce:Oe.length!==0&&(!t||M)?void 0:async(st,He)=>{const Ke=He.filter(Boolean);if(st&&!(st&&st.type==="tree"&&Ke.length===0&&st.path!==".")){if(Ke.length>0||st.path==="."&&Ke.length===0){const At=new Ge(Ke).toObject(),Nt=await yr({fs:n,gitdir:i,type:"tree",object:At,dryRun:N});st.oid=Nt}return st}}});return Oe.length!==0?(t&&!M&&await an({fs:n,cache:e,dir:t,gitdir:i,trees:[gr({ref:ot.oid})],map:async function(st,[He]){const Ke=`${t}/${st}`;if(await He.type()==="blob"){const Xe=await He.mode(),At=new TextDecoder().decode(await He.content());await n.write(Ke,At,{mode:Xe})}return!0}}),new zr(Oe,$e,Ye,rt)):ot.oid}async function Ta({fs:n,gitdir:e,path:t,ours:i,base:a,theirs:s,ourName:p,theirName:E,baseName:T,dryRun:C,mergeDriver:I=Ra}){const N="blob";let M="100755",Y="",he="";a&&await a.type()==="blob"&&(M=await a.mode(),Y=await a.oid(),he=Buffer.from(await a.content()).toString("utf8"));const Ie=M===await i.mode()?await s.mode():await i.mode();if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:Ie,path:t,oid:await i.oid(),type:N}};if(await i.oid()===Y)return{cleanMerge:!0,mergeResult:{mode:Ie,path:t,oid:await s.oid(),type:N}};if(await s.oid()===Y)return{cleanMerge:!0,mergeResult:{mode:Ie,path:t,oid:await i.oid(),type:N}};const xe=Buffer.from(await i.content()).toString("utf8"),Oe=Buffer.from(await s.content()).toString("utf8"),{mergedText:$e,cleanMerge:Ye}=await I({branches:[T,p,E],contents:[he,xe,Oe],path:t}),rt=await yr({fs:n,gitdir:e,type:"blob",object:Buffer.from($e,"utf8"),dryRun:C});return{cleanMerge:Ye,mergeResult:{mode:Ie,path:t,oid:rt,type:N}}}const Ji={stage:Et,workdir:pn};let Ri;async function On(n,e){return Ri===void 0&&(Ri=new u),Ri.acquire(n,e)}async function $s(n,e,t,i,a=null){const s=_e(t,i),p=await n.lstat(s);if(!p)throw new ct(s);if(p.isDirectory())throw new B(`${s}: file expected, but found directory`);const E=a?await Sr({fs:n,gitdir:e,oid:a}):void 0;let T=E?a:void 0;return E||await On({fs:n,gitdir:e,currentFilepath:s},async()=>{const C=p.isSymbolicLink()?await n.readlink(s).then(ii):await n.read(s);if(C===null)throw new ct(s);T=await yr({fs:n,gitdir:e,type:"blob",object:C})}),T}async function Fs({fs:n,dir:e,gitdir:t,entries:i}){async function a(s){if(s.type==="tree"){if(!s.oid){const p=await Promise.all(s.children.map(a));s.oid=await Kn({fs:n,gitdir:t,tree:p}),s.mode=16384}}else s.type==="blob"&&(s.oid=await $s(n,t,e,s.path,s.oid),s.mode=33188);return s.path=s.path.split("/").pop(),s}return Promise.all(i.map(a))}async function Oa({fs:n,dir:e,gitdir:t,treePair:i}){const a=i[1]==="stage",s=i.map(Y=>typeof Y=="string"?Ji[Y]():Y),p=[],I=await an({fs:n,cache:{},dir:e,gitdir:t,trees:s,map:async(Y,[he,Ie])=>{if(!(Y==="."||await zn.isIgnored({fs:n,dir:e,gitdir:t,filepath:Y}))&&Ie)return(!he||await he.oid()!==await Ie.oid()&&await Ie.oid()!==void 0)&&p.push([he,Ie]),{mode:await Ie.mode(),path:Y,oid:await Ie.oid(),type:await Ie.type()}},reduce:async(Y,he)=>(he=he.filter(Boolean),Y?(Y.children=he,Y):he.length>0?he:void 0),iterate:async(Y,he)=>{const Ie=[];for(const xe of he){const[Oe,$e]=xe;a?$e&&(await n.exists(`${e}/${$e.toString()}`)?Ie.push(xe):p.push([null,$e])):Oe&&($e?Ie.push(xe):p.push([Oe,null]))}return Ie.length?Promise.all(Ie.map(Y)):[]}});if(p.length===0||I.length===0)return null;const M=(await Fs({fs:n,dir:e,gitdir:t,entries:I})).filter(Boolean).map(Y=>({mode:Y.mode,path:Y.path,oid:Y.oid,type:Y.type}));return Kn({fs:n,gitdir:t,tree:M})}async function ci({fs:n,dir:e,gitdir:t,stashCommit:i,parentCommit:a,wasStaged:s}){const p=[],E=[],T=await an({fs:n,cache:{},dir:e,gitdir:t,trees:[gr({ref:a}),gr({ref:i})],map:async(C,[I,N])=>{if(C==="."||await zn.isIgnored({fs:n,dir:e,gitdir:t,filepath:C}))return;const M=N?await N.type():await I.type();if(M!=="tree"&&M!=="blob")return;if(!N&&I){const he=M==="tree"?"rmdir":"rm";return M==="tree"&&p.push(C),M==="blob"&&s&&E.push({filepath:C,oid:await I.oid()}),{method:he,filepath:C}}const Y=await N.oid();if(!I||await I.oid()!==Y)return M==="tree"?{method:"mkdir",filepath:C}:(s&&E.push({filepath:C,oid:Y,stats:await n.lstat(_e(e,C))}),{method:"write",filepath:C,oid:Y})}});await On({fs:n,gitdir:t,dirRemoved:p,ops:T},async()=>{for(const C of T){const I=_e(e,C.filepath);switch(C.method){case"rmdir":await n.rmdir(I);break;case"mkdir":await n.mkdir(I);break;case"rm":await n.rm(I);break;case"write":if(!p.some(N=>I.startsWith(N))){const{object:N}=await _t({fs:n,cache:{},gitdir:t,oid:C.oid});await n.exists(I)&&await n.rm(I),await n.write(I,N)}break}}}),await Ue.acquire({fs:n,gitdir:t,cache:{}},async C=>{E.forEach(({filepath:I,stats:N,oid:M})=>{C.insert({filepath:I,stats:N,oid:M})})})}async function Yr({fs:n,cache:e,dir:t,gitdir:i,oid:a,dryRun:s=!1,noUpdateBranch:p=!1,abortOnConflict:E=!0,committer:T,mergeDriver:C}){const{commit:I,oid:N}=await Vt({fs:n,cache:e,gitdir:i,oid:a});if(I.parent.length>1)throw new Lr(N,I.parent.length);if(I.parent.length===0)throw new ln(N);const M=await G.resolve({fs:n,gitdir:i,ref:"HEAD"}),{commit:Y}=await Vt({fs:n,cache:e,gitdir:i,oid:M}),he=I.parent[0],{commit:Ie}=await Vt({fs:n,cache:e,gitdir:i,oid:he}),xe=await Ue.acquire({fs:n,gitdir:i,cache:e,allowUnmerged:!1},async $e=>Ia({fs:n,cache:e,dir:t,gitdir:i,index:$e,ourOid:Y.tree,baseOid:Ie.tree,theirOid:I.tree,ourName:"HEAD",baseName:`parent of ${N.slice(0,7)}`,theirName:N.slice(0,7),dryRun:s,abortOnConflict:E,mergeDriver:C}));if(xe instanceof zr)throw xe;const Oe=await sn({fs:n,cache:e,gitdir:i,message:I.message,tree:xe,parent:[M],author:I.author,committer:T,dryRun:s,noUpdateBranch:p});return t&&!s&&!p&&await ci({fs:n,dir:t,gitdir:i,stashCommit:Oe,parentCommit:M,wasStaged:!0}),Oe}async function nr({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,cache:a={},committer:s,dryRun:p=!1,noUpdateBranch:E=!1,abortOnConflict:T=!0,mergeDriver:C}){try{se("fs",n),se("gitdir",t),se("oid",i);const I=new at(n),N=await it({fsp:I,dotgit:t}),{commit:M}=await Vt({fs:I,cache:a,gitdir:N,oid:i});if(M.parent&&M.parent.length>1)return await Yr({fs:I,cache:a,dir:e,gitdir:N,oid:i,dryRun:p,noUpdateBranch:E,abortOnConflict:T,committer:void 0,mergeDriver:C});const Y=await on({fs:I,gitdir:N,committer:s});if(!Y)throw new cr("committer");return await Yr({fs:I,cache:a,dir:e,gitdir:N,oid:i,dryRun:p,noUpdateBranch:E,abortOnConflict:T,committer:Y,mergeDriver:C})}catch(I){throw I.caller="git.cherryPick",I}}const Ii=/^refs\/(heads\/|tags\/|remotes\/)?(.*)/;function Fr(n){const e=Ii.exec(n);return e?e[1]==="remotes/"&&n.endsWith("/HEAD")?e[2].slice(0,-5):e[2]:n}async function wn({fs:n,gitdir:e,fullname:t=!1,test:i=!1}){const a=await G.resolve({fs:n,gitdir:e,ref:"HEAD",depth:2});if(i)try{await G.resolve({fs:n,gitdir:e,ref:a})}catch{return}if(a.startsWith("refs/"))return t?a:Fr(a)}function Qi(n){return n=n.replace(/^git@([^:]+):/,"https://$1/"),n=n.replace(/^ssh:\/\//,"https://"),n}function ea({username:n="",password:e=""}){return`Basic ${Buffer.from(`${n}:${e}`).toString("base64")}`}async function Nr(n,e){const t=qr(n);for(;;){const{value:i,done:a}=await t.next();if(i&&await e(i),a)break}t.return&&t.return()}async function Wn(n){let e=0;const t=[];await Nr(n,s=>{t.push(s),e+=s.byteLength});const i=new Uint8Array(e);let a=0;for(const s of t)i.set(s,a),a+=s.byteLength;return i}function Pn(n){let e=n.match(/^https?:\/\/([^/]+)@/);if(e==null)return{url:n,auth:{}};e=e[1];const[t,i]=e.split(":");return n=n.replace(`${e}@`,""),{url:n,auth:{username:t,password:i}}}function Xr(n,e){const t=e.toString(16);return"0".repeat(n-t.length)+t}class ir{static flush(){return Buffer.from("0000","utf8")}static delim(){return Buffer.from("0001","utf8")}static encode(e){typeof e=="string"&&(e=Buffer.from(e));const t=e.length+4,i=Xr(4,t);return Buffer.concat([Buffer.from(i,"utf8"),e])}static streamReader(e){const t=new Ur(e);return async function(){try{let a=await t.read(4);if(a==null)return!0;if(a=parseInt(a.toString("utf8"),16),a===0||a===1)return null;const s=await t.read(a-4);return s??!0}catch(a){return e.error=a,!0}}}}async function r(n){const e={};let t;for(;t=await n(),t!==!0;){if(t===null)continue;t=t.toString("utf8").replace(/\n$/,"");const i=t.indexOf("=");if(i>-1){const a=t.slice(0,i),s=t.slice(i+1);e[a]=s}else e[t]=!0}return{protocolVersion:2,capabilities2:e}}async function o(n,{service:e}){const t=new Set,i=new Map,a=new Map,s=ir.streamReader(n);let p=await s();for(;p===null;)p=await s();if(p===!0)throw new An;if(p.includes("version 2"))return r(s);if(p.toString("utf8").replace(/\n$/,"")!==`# service=${e}`)throw new fn(`# service=${e}\\n`,p.toString("utf8"));let E=await s();for(;E===null;)E=await s();if(E===!0)return{capabilities:t,refs:i,symrefs:a};if(E=E.toString("utf8"),E.includes("version 2"))return r(s);const[T,C]=l(E,"\0","\\x00");if(C.split(" ").map(I=>t.add(I)),T!=="0000000000000000000000000000000000000000 capabilities^{}"){const[I,N]=l(T," "," ");for(i.set(N,I);;){const M=await s();if(M===!0)break;if(M!==null){const[Y,he]=l(M.toString("utf8")," "," ");i.set(he,Y)}}}for(const I of t)if(I.startsWith("symref=")){const N=I.match(/symref=([^:]+):(.*)/);N.length===3&&a.set(N[1],N[2])}return{protocolVersion:1,capabilities:t,refs:i,symrefs:a}}function l(n,e,t){const i=n.trim().split(e);if(i.length!==2)throw new fn(`Two strings separated by '${t}'`,n.toString("utf8"));return i}const g=(n,e)=>n.endsWith("?")?`${n}${e}`:`${n}/${e.replace(/^https?:\/\//,"")}`,x=(n,e)=>{(e.username||e.password)&&(n.Authorization=ea(e)),e.headers&&Object.assign(n,e.headers)},R=async n=>{try{const e=Buffer.from(await Wn(n.body)),t=e.toString("utf8");return{preview:t.length<256?t:t.slice(0,256)+"...",response:t,data:e}}catch{return{}}};class ${static async capabilities(){return["discover","connect"]}static async discover({http:e,onProgress:t,onAuth:i,onAuthSuccess:a,onAuthFailure:s,corsProxy:p,service:E,url:T,headers:C,protocolVersion:I}){let{url:N,auth:M}=Pn(T);const Y=p?g(p,N):N;(M.username||M.password)&&(C.Authorization=ea(M)),I===2&&(C["Git-Protocol"]="version=2");let he,Ie,xe=!1;do if(he=await e.request({onProgress:t,method:"GET",url:`${Y}/info/refs?service=${E}`,headers:C}),Ie=!1,he.statusCode===401||he.statusCode===203){const Oe=xe?s:i;if(Oe){if(M=await Oe(N,{...M,headers:{...C}}),M&&M.cancel)throw new hn;M&&(x(C,M),xe=!0,Ie=!0)}}else he.statusCode===200&&xe&&a&&await a(N,M);while(Ie);if(he.statusCode!==200){const{response:Oe}=await R(he);throw new en(he.statusCode,he.statusMessage,Oe)}if(he.headers["content-type"]===`application/x-${E}-advertisement`){const Oe=await o(he.body,{service:E});return Oe.auth=M,Oe}else{const{preview:Oe,response:$e,data:Ye}=await R(he);try{const rt=await o([Ye],{service:E});return rt.auth=M,rt}catch{throw new rn(Oe,$e)}}}static async connect({http:e,onProgress:t,corsProxy:i,service:a,url:s,auth:p,body:E,headers:T}){const C=Pn(s);C&&(s=C.url),i&&(s=g(i,s)),T["content-type"]=`application/x-${a}-request`,T.accept=`application/x-${a}-result`,x(T,p);const I=await e.request({onProgress:t,method:"POST",url:`${s}/${a}`,body:E,headers:T});if(I.statusCode!==200){const{response:N}=R(I);throw new en(I.statusCode,I.statusMessage,N)}return I}}class q{static getRemoteHelperFor({url:e}){const t=new Map;t.set("http",$),t.set("https",$);const i=ae({url:e});if(!i)throw new Sn(e);if(t.has(i.transport))return t.get(i.transport);throw new Hr(e,i.transport,i.transport==="ssh"?Qi(e):void 0)}}function ae({url:n}){if(n.startsWith("git@"))return{transport:"ssh",address:n};const e=n.match(/(\w+)(:\/\/|::)(.*)/);if(e!==null){if(e[2]==="://")return{transport:e[1],address:e[0]};if(e[2]==="::")return{transport:e[1],address:e[3]}}}let de=null;class re{static async read({fs:e,gitdir:t}){de===null&&(de=new u);const i=_e(t,"shallow"),a=new Set;return await de.acquire(i,async function(){const s=await e.read(i,{encoding:"utf8"});if(s===null||s.trim()==="")return a;s.trim().split(`
`).map(p=>a.add(p))}),a}static async write({fs:e,gitdir:t,oids:i}){de===null&&(de=new u);const a=_e(t,"shallow");if(i.size>0){const s=[...i].join(`
`)+`
`;await de.acquire(a,async function(){await e.write(a,s,{encoding:"utf8"})})}else await de.acquire(a,async function(){await e.rm(a)})}}async function ee({fs:n,gitdir:e,oid:t}){const i=`objects/${t.slice(0,2)}/${t.slice(2)}`;return n.exists(`${e}/${i}`)}async function ce({fs:n,cache:e,gitdir:t,oid:i,getExternalRefDelta:a}){let s=await n.readdir(_e(t,"objects/pack"));s=s.filter(p=>p.endsWith(".idx"));for(const p of s){const E=`${t}/objects/pack/${p}`,T=await mi({fs:n,cache:e,filename:E,getExternalRefDelta:a});if(T.error)throw new B(T.error);if(T.offsets.has(i))return!0}return!1}async function ue({fs:n,cache:e,gitdir:t,oid:i,format:a="content"}){const s=E=>_t({fs:n,cache:e,gitdir:t,oid:E});let p=await ee({fs:n,gitdir:t,oid:i});return p||(p=await ce({fs:n,cache:e,gitdir:t,oid:i,getExternalRefDelta:s})),p}function oe(n){const a="5041434b"+"00000002"+"00000000";return n.slice(0,12).toString("hex")===a}function ne(n,e){const t=n.map(i=>i.split("=",1)[0]);return e.filter(i=>{const a=i.split("=",1)[0];return t.includes(a)})}const ye={name:"isomorphic-git",version:"1.37.1",agent:"git/isomorphic-git@1.37.1"};class ve{constructor(){this._queue=[]}write(e){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const t=this._waiting;this._waiting=null,t({value:e})}else this._queue.push(e)}end(){if(this._ended=!0,this._waiting){const e=this._waiting;this._waiting=null,e({done:!0})}}destroy(e){this.error=e,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(e=>{this._waiting=e})}}function me(n){const e=n.indexOf("\r"),t=n.indexOf(`
`);return e===-1&&t===-1?-1:e===-1?t+1:t===-1?e+1:t===e+1?t+1:Math.min(e,t)+1}function Pe(n){const e=new ve;let t="";return(async()=>(await Nr(n,i=>{for(i=i.toString("utf8"),t+=i;;){const a=me(t);if(a===-1)break;e.write(t.slice(0,a)),t=t.slice(a)}}),t.length>0&&e.write(t),e.end()))(),e}class je{static demux(e){const t=ir.streamReader(e),i=new ve,a=new ve,s=new ve,p=async function(){const E=await t();if(E===null)return p();if(E===!0){i.end(),s.end(),e.error?a.destroy(e.error):a.end();return}switch(E[0]){case 1:{a.write(E.slice(1));break}case 2:{s.write(E.slice(1));break}case 3:{const T=E.slice(1);s.write(T),i.end(),s.end(),a.destroy(new Error(T.toString("utf8")));return}default:i.write(E)}p()};return p(),{packetlines:i,packfile:a,progress:s}}}async function Ze(n){const{packetlines:e,packfile:t,progress:i}=je.demux(n),a=[],s=[],p=[];let E=!1,T=!1;return new Promise((C,I)=>{Nr(e,N=>{const M=N.toString("utf8").trim();if(M.startsWith("shallow")){const Y=M.slice(-41).trim();Y.length!==40&&I(new kt(Y)),a.push(Y)}else if(M.startsWith("unshallow")){const Y=M.slice(-41).trim();Y.length!==40&&I(new kt(Y)),s.push(Y)}else if(M.startsWith("ACK")){const[,Y,he]=M.split(" ");p.push({oid:Y,status:he}),he||(T=!0)}else M.startsWith("NAK")?(E=!0,T=!0):(T=!0,E=!0);T&&(n.error?I(n.error):C({shallows:a,unshallows:s,acks:p,nak:E,packfile:t,progress:i}))}).finally(()=>{T||(n.error?I(n.error):C({shallows:a,unshallows:s,acks:p,nak:E,packfile:t,progress:i}))})})}function Ve({capabilities:n=[],wants:e=[],haves:t=[],shallows:i=[],depth:a=null,since:s=null,exclude:p=[]}){const E=[];e=[...new Set(e)];let T=` ${n.join(" ")}`;for(const C of e)E.push(ir.encode(`want ${C}${T}
`)),T="";for(const C of i)E.push(ir.encode(`shallow ${C}
`));a!==null&&E.push(ir.encode(`deepen ${a}
`)),s!==null&&E.push(ir.encode(`deepen-since ${Math.floor(s.valueOf()/1e3)}
`));for(const C of p)E.push(ir.encode(`deepen-not ${C}
`));E.push(ir.flush());for(const C of t)E.push(ir.encode(`have ${C}
`));return E.push(ir.encode(`done
`)),E}async function Me({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,gitdir:T,ref:C,remoteRef:I,remote:N,url:M,corsProxy:Y,depth:he=null,since:Ie=null,exclude:xe=[],relative:Oe=!1,tags:$e=!1,singleBranch:Ye=!1,headers:rt={},prune:ot=!1,pruneTags:st=!1}){const He=C||await wn({fs:n,gitdir:T,test:!0}),Ke=await W.get({fs:n,gitdir:T}),Xe=N||He&&await Ke.get(`branch.${He}.remote`)||"origin",At=M||await Ke.get(`remote.${Xe}.url`);if(typeof At>"u")throw new Er("remote OR url");const Nt=I||He&&await Ke.get(`branch.${He}.merge`)||C||"HEAD";Y===void 0&&(Y=await Ke.get("http.corsProxy"));const vr=q.getRemoteHelperFor({url:At}),Ut=await vr.discover({http:t,onAuth:s,onAuthSuccess:p,onAuthFailure:E,corsProxy:Y,service:"git-upload-pack",url:At,headers:rt,protocolVersion:1}),br=Ut.auth,Ar=Ut.refs;if(Ar.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(he!==null&&!Ut.capabilities.has("shallow"))throw new $r("shallow","depth");if(Ie!==null&&!Ut.capabilities.has("deepen-since"))throw new $r("deepen-since","since");if(xe.length>0&&!Ut.capabilities.has("deepen-not"))throw new $r("deepen-not","exclude");if(Oe===!0&&!Ut.capabilities.has("deepen-relative"))throw new $r("deepen-relative","relative");const{oid:ui,fullref:li}=G.resolveAgainstMap({ref:Nt,map:Ar});for(const Kt of Ar.keys())Kt===li||Kt==="HEAD"||Kt.startsWith("refs/heads/")||$e&&Kt.startsWith("refs/tags/")||Ar.delete(Kt);const Ti=ne([...Ut.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${ye.agent}`]);Oe&&Ti.push("deepen-relative");const Ms=Ye?[ui]:Ar.values(),qs=Ye?[He]:await G.listRefs({fs:n,gitdir:T,filepath:"refs"});let jr=[];for(let Kt of qs)try{Kt=await G.expand({fs:n,gitdir:T,ref:Kt});const kr=await G.resolve({fs:n,gitdir:T,ref:Kt});await ue({fs:n,cache:e,gitdir:T,oid:kr})&&jr.push(kr)}catch{}jr=[...new Set(jr)];const ur=await re.read({fs:n,gitdir:T}),yn=Ut.capabilities.has("shallow")?[...ur]:[],Rr=Ve({capabilities:Ti,wants:Ms,haves:jr,shallows:yn,depth:he,since:Ie,exclude:xe}),ra=Buffer.from(await Wn(Rr)),fi=await vr.connect({http:t,onProgress:i,corsProxy:Y,service:"git-upload-pack",url:At,auth:br,body:[ra],headers:rt}),_r=await Ze(fi.body);fi.headers&&(_r.headers=fi.headers);for(const Kt of _r.shallows)if(!ur.has(Kt))try{const{object:kr}=await _t({fs:n,cache:e,gitdir:T,oid:Kt}),Jr=new Zt(kr),vn=await Promise.all(Jr.headers().parent.map(ia=>ue({fs:n,cache:e,gitdir:T,oid:ia})));vn.length===0||vn.every(ia=>ia)||ur.add(Kt)}catch{ur.add(Kt)}for(const Kt of _r.unshallows)ur.delete(Kt);if(await re.write({fs:n,gitdir:T,oids:ur}),Ye){const Kt=new Map([[li,ui]]),kr=new Map;let Jr=10,vn=li;for(;Jr--;){const Ls=Ut.symrefs.get(vn);if(Ls===void 0)break;kr.set(vn,Ls),vn=Ls}const Us=Ar.get(vn);Us&&Kt.set(vn,Us);const{pruned:ia}=await G.updateRemoteRefs({fs:n,gitdir:T,remote:Xe,refs:Kt,symrefs:kr,tags:$e,prune:ot});ot&&(_r.pruned=ia)}else{const{pruned:Kt}=await G.updateRemoteRefs({fs:n,gitdir:T,remote:Xe,refs:Ar,symrefs:Ut.symrefs,tags:$e,prune:ot,pruneTags:st});ot&&(_r.pruned=Kt)}if(_r.HEAD=Ut.symrefs.get("HEAD"),_r.HEAD===void 0){const{oid:Kt}=G.resolveAgainstMap({ref:"HEAD",map:Ar});for(const[kr,Jr]of Ar.entries())if(kr!=="HEAD"&&Jr===Kt){_r.HEAD=kr;break}}const rp=li.startsWith("refs/tags")?"tag":"branch";if(_r.FETCH_HEAD={oid:ui,description:`${rp} '${Fr(li)}' of ${At}`},i||a){const Kt=Pe(_r.progress);Nr(Kt,async kr=>{if(a&&await a(kr),i){const Jr=kr.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Jr&&await i({phase:Jr[1].trim(),loaded:parseInt(Jr[2],10),total:parseInt(Jr[3],10)})}})}const Ba=Buffer.from(await Wn(_r.packfile));if(fi.body.error)throw fi.body.error;const Af=Ba.slice(-20).toString("hex"),na={defaultBranch:_r.HEAD,fetchHead:_r.FETCH_HEAD.oid,fetchHeadDescription:_r.FETCH_HEAD.description};if(_r.headers&&(na.headers=_r.headers),ot&&(na.pruned=_r.pruned),Af!==""&&!oe(Ba)){na.packfile=`objects/pack/pack-${Af}.pack`;const Kt=_e(T,na.packfile);await n.write(Kt,Ba);const kr=vn=>_t({fs:n,cache:e,gitdir:T,oid:vn}),Jr=await Tr.fromPack({pack:Ba,getExternalRefDelta:kr,onProgress:i});await n.write(Kt.replace(/\.pack$/,".idx"),await Jr.toBuffer())}return na}async function tt({fs:n,bare:e=!1,dir:t,gitdir:i=e?t:_e(t,".git"),defaultBranch:a="master"}){if(await n.exists(i+"/config"))return;let s=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];s=s.map(p=>i+"/"+p);for(const p of s)await n.mkdir(p);await n.write(i+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${e}
`+(e?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await n.write(i+"/HEAD",`ref: refs/heads/${a}
`)}async function et({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,onPostCheckout:T,dir:C,gitdir:I,url:N,corsProxy:M,ref:Y,remote:he,depth:Ie,since:xe,exclude:Oe,relative:$e,singleBranch:Ye,noCheckout:rt,noTags:ot,headers:st,nonBlocking:He,batchSize:Ke=100}){try{if(await tt({fs:n,gitdir:I}),await Ai({fs:n,gitdir:I,remote:he,url:N,force:!1}),M){const Nt=await W.get({fs:n,gitdir:I});await Nt.set("http.corsProxy",M),await W.save({fs:n,gitdir:I,config:Nt})}const{defaultBranch:Xe,fetchHead:At}=await Me({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,gitdir:I,ref:Y,remote:he,corsProxy:M,depth:Ie,since:xe,exclude:Oe,relative:$e,singleBranch:Ye,headers:st,tags:!ot});if(At===null)return;Y=Y||Xe,Y=Y.replace("refs/heads/",""),await Wi({fs:n,cache:e,onProgress:i,onPostCheckout:T,dir:C,gitdir:I,ref:Y,remote:he,noCheckout:rt,nonBlocking:He,batchSize:Ke})}catch(Xe){throw await n.rmdir(I,{recursive:!0,maxRetries:10}).catch(()=>{}),Xe}}async function ze({fs:n,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,onPostCheckout:E,dir:T,gitdir:C=_e(T,".git"),url:I,corsProxy:N=void 0,ref:M=void 0,remote:Y="origin",depth:he=void 0,since:Ie=void 0,exclude:xe=[],relative:Oe=!1,singleBranch:$e=!1,noCheckout:Ye=!1,noTags:rt=!1,headers:ot={},cache:st={},nonBlocking:He=!1,batchSize:Ke=100}){try{se("fs",n),se("http",e),se("gitdir",C),Ye||se("dir",T),se("url",I);const Xe=new at(n),At=await it({fsp:Xe,dotgit:C});return await et({fs:Xe,cache:st,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,onPostCheckout:E,dir:T,gitdir:At,url:I,corsProxy:N,ref:M,remote:Y,depth:he,since:Ie,exclude:xe,relative:Oe,singleBranch:$e,noCheckout:Ye,noTags:rt,headers:ot,nonBlocking:He,batchSize:Ke})}catch(Xe){throw Xe.caller="git.clone",Xe}}async function nt({fs:n,onSign:e,dir:t,gitdir:i=_e(t,".git"),message:a,author:s,committer:p,signingKey:E,amend:T=!1,dryRun:C=!1,noUpdateBranch:I=!1,ref:N,parent:M,tree:Y,cache:he={}}){try{se("fs",n),T||se("message",a),E&&se("onSign",e);const Ie=new at(n),xe=await it({fsp:Ie,dotgit:i});return await sn({fs:Ie,cache:he,onSign:e,gitdir:xe,message:a,author:s,committer:p,signingKey:E,amend:T,dryRun:C,noUpdateBranch:I,ref:N,parent:M,tree:Y})}catch(Ie){throw Ie.caller="git.commit",Ie}}async function Tt({fs:n,dir:e,gitdir:t=_e(e,".git"),fullname:i=!1,test:a=!1}){try{se("fs",n),se("gitdir",t);const s=new at(n),p=await it({fsp:s,dotgit:t});return await wn({fs:s,gitdir:p,fullname:i,test:a})}catch(s){throw s.caller="git.currentBranch",s}}async function $t({fs:n,gitdir:e,ref:t}){if(t=t.startsWith("refs/heads/")?t:`refs/heads/${t}`,!await G.exists({fs:n,gitdir:e,ref:t}))throw new ct(t);const a=await G.expand({fs:n,gitdir:e,ref:t}),s=await wn({fs:n,gitdir:e,fullname:!0});if(a===s){const T=await G.resolve({fs:n,gitdir:e,ref:a});await G.writeRef({fs:n,gitdir:e,ref:"HEAD",value:T})}await G.deleteRef({fs:n,gitdir:e,ref:a});const p=Fr(t),E=await W.get({fs:n,gitdir:e});await E.deleteSection("branch",p),await W.save({fs:n,gitdir:e,config:E})}async function wt({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i}){try{se("fs",n),se("ref",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await $t({fs:a,gitdir:s,ref:i})}catch(a){throw a.caller="git.deleteBranch",a}}async function St({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i}){try{se("fs",n),se("ref",i);const a=new at(n),s=await it({fsp:a,dotgit:t});await G.deleteRef({fs:a,gitdir:s,ref:i})}catch(a){throw a.caller="git.deleteRef",a}}async function Qt({fs:n,gitdir:e,remote:t}){const i=await W.get({fs:n,gitdir:e});await i.deleteSection("remote",t),await W.save({fs:n,gitdir:e,config:i})}async function Br({fs:n,dir:e,gitdir:t=_e(e,".git"),remote:i}){try{se("fs",n),se("remote",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await Qt({fs:a,gitdir:s,remote:i})}catch(a){throw a.caller="git.deleteRemote",a}}async function ar({fs:n,gitdir:e,ref:t}){t=t.startsWith("refs/tags/")?t:`refs/tags/${t}`,await G.deleteRef({fs:n,gitdir:e,ref:t})}async function gn({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i}){try{se("fs",n),se("ref",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await ar({fs:a,gitdir:s,ref:i})}catch(a){throw a.caller="git.deleteTag",a}}async function ta({fs:n,gitdir:e,oid:t}){const i=t.slice(0,2);return(await n.readdir(`${e}/objects/${i}`)).map(s=>`${i}${s}`).filter(s=>s.startsWith(t))}async function kd({fs:n,cache:e,gitdir:t,oid:i,getExternalRefDelta:a}){const s=[];let p=await n.readdir(_e(t,"objects/pack"));p=p.filter(E=>E.endsWith(".idx"));for(const E of p){const T=`${t}/objects/pack/${E}`,C=await mi({fs:n,cache:e,filename:T,getExternalRefDelta:a});if(C.error)throw new B(C.error);for(const I of C.offsets.keys())I.startsWith(i)&&s.push(I)}return s}async function Sd({fs:n,cache:e,gitdir:t,oid:i}){const a=E=>_t({fs:n,cache:e,gitdir:t,oid:E}),s=await ta({fs:n,gitdir:t,oid:i}),p=await kd({fs:n,cache:e,gitdir:t,oid:i,getExternalRefDelta:a});for(const E of p)s.indexOf(E)===-1&&s.push(E);if(s.length===1)return s[0];throw s.length>1?new Or("oids",i,s):new ct(`an object matching "${i}"`)}async function ul({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Sd({fs:s,cache:a,gitdir:p,oid:i})}catch(s){throw s.caller="git.expandOid",s}}async function ll({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i}){try{se("fs",n),se("gitdir",t),se("ref",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await G.expand({fs:a,gitdir:s,ref:i})}catch(a){throw a.caller="git.expandRef",a}}async function Ds({fs:n,cache:e,gitdir:t,oids:i}){const a={},s=i.length;let p=i.map((E,T)=>({index:T,oid:E}));for(;p.length;){const E=new Set;for(const{oid:C,index:I}of p)a[C]||(a[C]=new Set),a[C].add(I),a[C].size===s&&E.add(C);if(E.size>0)return[...E];const T=new Map;for(const{oid:C,index:I}of p)try{const{object:N}=await _t({fs:n,cache:e,gitdir:t,oid:C}),M=Zt.from(N),{parent:Y}=M.parseHeaders();for(const he of Y)(!a[he]||!a[he].has(I))&&T.set(he+":"+I,{oid:he,index:I})}catch{}p=Array.from(T.values())}return[]}async function fl({fs:n,cache:e,dir:t,gitdir:i,ours:a,theirs:s,fastForward:p=!0,fastForwardOnly:E=!1,dryRun:T=!1,noUpdateBranch:C=!1,abortOnConflict:I=!0,message:N,author:M,committer:Y,signingKey:he,onSign:Ie,mergeDriver:xe,allowUnrelatedHistories:Oe=!1}){a===void 0&&(a=await wn({fs:n,gitdir:i,fullname:!0})),a=await G.expand({fs:n,gitdir:i,ref:a}),s=await G.expand({fs:n,gitdir:i,ref:s});const $e=await G.resolve({fs:n,gitdir:i,ref:a}),Ye=await G.resolve({fs:n,gitdir:i,ref:s}),rt=await Ds({fs:n,cache:e,gitdir:i,oids:[$e,Ye]});if(rt.length!==1)if(rt.length===0&&Oe)rt.push("4b825dc642cb6eb9a060e54bf8d69288fbee4904");else throw new kn;const ot=rt[0];if(ot===Ye)return{oid:$e,alreadyMerged:!0};if(p&&ot===$e)return!T&&!C&&await G.writeRef({fs:n,gitdir:i,ref:a,value:Ye}),{oid:Ye,fastForward:!0};{if(E)throw new Dr;const st=await Ue.acquire({fs:n,gitdir:i,cache:e,allowUnmerged:!1},async Ke=>Ia({fs:n,cache:e,dir:t,gitdir:i,index:Ke,ourOid:$e,theirOid:Ye,baseOid:ot,ourName:Fr(a),baseName:"base",theirName:Fr(s),dryRun:T,abortOnConflict:I,mergeDriver:xe}));if(st instanceof zr)throw st;return N||(N=`Merge branch '${Fr(s)}' into ${Fr(a)}`),{oid:await sn({fs:n,cache:e,gitdir:i,message:N,ref:a,tree:st,parent:[$e,Ye],author:M,committer:Y,signingKey:he,onSign:Ie,dryRun:T,noUpdateBranch:C}),tree:st,mergeCommit:!0}}}async function hl({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,dir:T,gitdir:C,ref:I,url:N,remote:M,remoteRef:Y,prune:he,pruneTags:Ie,fastForward:xe,fastForwardOnly:Oe,corsProxy:$e,singleBranch:Ye,headers:rt,author:ot,committer:st,signingKey:He}){try{if(!I){const At=await wn({fs:n,gitdir:C});if(!At)throw new Er("ref");I=At}const{fetchHead:Ke,fetchHeadDescription:Xe}=await Me({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,gitdir:C,corsProxy:$e,ref:I,url:N,remote:M,remoteRef:Y,singleBranch:Ye,headers:rt,prune:he,pruneTags:Ie});await fl({fs:n,cache:e,gitdir:C,ours:I,theirs:Ke,fastForward:xe,fastForwardOnly:Oe,message:`Merge ${Xe}`,author:ot,committer:st,signingKey:He,dryRun:!1,noUpdateBranch:!1}),await Wi({fs:n,cache:e,onProgress:i,dir:T,gitdir:C,ref:I,remote:M,noCheckout:!1})}catch(Ke){throw Ke.caller="git.pull",Ke}}async function dl({fs:n,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,dir:E,gitdir:T=_e(E,".git"),ref:C,url:I,remote:N,remoteRef:M,corsProxy:Y,singleBranch:he,headers:Ie={},cache:xe={}}){try{se("fs",n),se("http",e),se("gitdir",T);const Oe={name:"",email:"",timestamp:Date.now(),timezoneOffset:0},$e=new at(n),Ye=await it({fsp:$e,dotgit:T});return await hl({fs:$e,cache:xe,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,dir:E,gitdir:Ye,ref:C,url:I,remote:N,remoteRef:M,fastForwardOnly:!0,corsProxy:Y,singleBranch:he,headers:Ie,author:Oe,committer:Oe})}catch(Oe){throw Oe.caller="git.fastForward",Oe}}async function pl({fs:n,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,dir:E,gitdir:T=_e(E,".git"),ref:C,remote:I,remoteRef:N,url:M,corsProxy:Y,depth:he=null,since:Ie=null,exclude:xe=[],relative:Oe=!1,tags:$e=!1,singleBranch:Ye=!1,headers:rt={},prune:ot=!1,pruneTags:st=!1,cache:He={}}){try{se("fs",n),se("http",e),se("gitdir",T);const Ke=new at(n),Xe=await it({fsp:Ke,dotgit:T});return await Me({fs:Ke,cache:He,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,gitdir:Xe,ref:C,remote:I,remoteRef:N,url:M,corsProxy:Y,depth:he,since:Ie,exclude:xe,relative:Oe,tags:$e,singleBranch:Ye,headers:rt,prune:ot,pruneTags:st})}catch(Ke){throw Ke.caller="git.fetch",Ke}}async function ml({fs:n,dir:e,gitdir:t=_e(e,".git"),oids:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("oids",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Ds({fs:s,cache:a,gitdir:p,oids:i})}catch(s){throw s.caller="git.findMergeBase",s}}async function wl({fs:n,filepath:e}){if(await n.exists(_e(e,".git")))return e;{const t=pt(e);if(t===e)throw new ct(`git root for ${e}`);return wl({fs:n,filepath:t})}}async function gl({fs:n,filepath:e}){try{return se("fs",n),se("filepath",e),await wl({fs:new at(n),filepath:e})}catch(t){throw t.caller="git.findRoot",t}}async function yl({fs:n,dir:e,gitdir:t=_e(e,".git"),path:i}){try{se("fs",n),se("gitdir",t),se("path",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await Zr({fs:a,gitdir:s,path:i})}catch(a){throw a.caller="git.getConfig",a}}async function Rd({fs:n,gitdir:e,path:t}){return(await W.get({fs:n,gitdir:e})).getall(t)}async function vl({fs:n,dir:e,gitdir:t=_e(e,".git"),path:i}){try{se("fs",n),se("gitdir",t),se("path",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await Rd({fs:a,gitdir:s,path:i})}catch(a){throw a.caller="git.getConfigAll",a}}async function bl({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,url:s,headers:p={},forPush:E=!1}){try{se("http",n),se("url",s);const C=await q.getRemoteHelperFor({url:s}).discover({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,service:E?"git-receive-pack":"git-upload-pack",url:s,headers:p,protocolVersion:1}),I={capabilities:[...C.capabilities]};for(const[N,M]of C.refs){const Y=N.split("/"),he=Y.pop();let Ie=I;for(const xe of Y)Ie[xe]=Ie[xe]||{},Ie=Ie[xe];Ie[he]=M}for(const[N,M]of C.symrefs){const Y=N.split("/"),he=Y.pop();let Ie=I;for(const xe of Y)Ie[xe]=Ie[xe]||{},Ie=Ie[xe];Ie[he]=M}return I}catch(T){throw T.caller="git.getRemoteInfo",T}}function _l(n,e,t,i){const a=[];for(const[s,p]of n.refs){if(e&&!s.startsWith(e))continue;if(s.endsWith("^{}")){if(i){const T=s.replace("^{}",""),C=a[a.length-1],I=C.ref===T?C:a.find(N=>N.ref===T);if(I===void 0)throw new Error("I did not expect this to happen");I.peeled=p}continue}const E={ref:s,oid:p};t&&n.symrefs.has(s)&&(E.target=n.symrefs.get(s)),a.push(E)}return a}async function xl({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,url:s,headers:p={},forPush:E=!1,protocolVersion:T=2}){try{se("http",n),se("url",s);const I=await q.getRemoteHelperFor({url:s}).discover({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,service:E?"git-receive-pack":"git-upload-pack",url:s,headers:p,protocolVersion:T});if(I.protocolVersion===2)return{protocolVersion:I.protocolVersion,capabilities:I.capabilities2};const N={};for(const M of I.capabilities){const[Y,he]=M.split("=");he?N[Y]=he:N[Y]=!0}return{protocolVersion:1,capabilities:N,refs:_l(I,void 0,!0,!0)}}catch(C){throw C.caller="git.getRemoteInfo2",C}}async function Id({type:n,object:e,format:t="content",oid:i=void 0}){return t!=="deflated"&&(t!=="wrapped"&&(e=yt.wrap({type:n,object:e})),i=await le(e)),{oid:i,object:e}}async function El({object:n}){try{se("object",n),typeof n=="string"?n=Buffer.from(n,"utf8"):n instanceof Uint8Array||(n=new Uint8Array(n));const e="blob",{oid:t,object:i}=await Id({type:e,format:"content",object:n});return{oid:t,type:e,object:i,format:"wrapped"}}catch(e){throw e.caller="git.hashBlob",e}}async function Td({fs:n,cache:e,onProgress:t,dir:i,gitdir:a,filepath:s}){try{s=_e(i,s);const p=await n.read(s),E=C=>_t({fs:n,cache:e,gitdir:a,oid:C}),T=await Tr.fromPack({pack:p,getExternalRefDelta:E,onProgress:t});return await n.write(s.replace(/\.pack$/,".idx"),await T.toBuffer()),{oids:[...T.hashes]}}catch(p){throw p.caller="git.indexPack",p}}async function Al({fs:n,onProgress:e,dir:t,gitdir:i=_e(t,".git"),filepath:a,cache:s={}}){try{se("fs",n),se("dir",t),se("gitdir",t),se("filepath",a);const p=new at(n),E=await it({fsp:p,dotgit:i});return await Td({fs:p,cache:s,onProgress:e,dir:t,gitdir:E,filepath:a})}catch(p){throw p.caller="git.indexPack",p}}async function kl({fs:n,bare:e=!1,dir:t,gitdir:i=e?t:_e(t,".git"),defaultBranch:a="master"}){try{se("fs",n),se("gitdir",i),e||se("dir",t);const s=new at(n),p=await it({fsp:s,dotgit:i});return await tt({fs:s,bare:e,dir:t,gitdir:p,defaultBranch:a})}catch(s){throw s.caller="git.init",s}}async function Sl({fs:n,cache:e,gitdir:t,oid:i,ancestor:a,depth:s}){const p=await re.read({fs:n,gitdir:t});if(!i)throw new Er("oid");if(!a)throw new Er("ancestor");if(i===a)return!1;const E=[i],T=new Set;let C=0;for(;E.length;){if(C++===s)throw new Nn(s);const I=E.shift(),{type:N,object:M}=await _t({fs:n,cache:e,gitdir:t,oid:I});if(N!=="commit")throw new ht(I,N,"commit");const Y=Zt.from(M).parse();for(const he of Y.parent)if(he===a)return!0;if(!p.has(I))for(const he of Y.parent)T.has(he)||(E.push(he),T.add(he))}return!1}async function Rl({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,ancestor:a,depth:s=-1,cache:p={}}){try{se("fs",n),se("gitdir",t),se("oid",i),se("ancestor",a);const E=new at(n),T=await it({fsp:E,dotgit:t});return await Sl({fs:E,cache:p,gitdir:T,oid:i,ancestor:a,depth:s})}catch(E){throw E.caller="git.isDescendent",E}}async function Il({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i}){try{se("fs",n),se("dir",e),se("gitdir",t),se("filepath",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return zn.isIgnored({fs:a,dir:e,gitdir:s,filepath:i})}catch(a){throw a.caller="git.isIgnored",a}}async function Tl({fs:n,dir:e,gitdir:t=_e(e,".git"),remote:i}){try{se("fs",n),se("gitdir",t);const a=new at(n),s=await it({fsp:a,dotgit:t});return G.listBranches({fs:a,gitdir:s,remote:i})}catch(a){throw a.caller="git.listBranches",a}}async function Od({fs:n,gitdir:e,ref:t,cache:i}){if(t){const a=await G.resolve({gitdir:e,fs:n,ref:t}),s=[];return await Ol({fs:n,cache:i,gitdir:e,oid:a,filenames:s,prefix:""}),s}else return Ue.acquire({fs:n,gitdir:e,cache:i},async function(a){return a.entries.map(s=>s.path)})}async function Ol({fs:n,cache:e,gitdir:t,oid:i,filenames:a,prefix:s}){const{tree:p}=await Rn({fs:n,cache:e,gitdir:t,oid:i});for(const E of p)E.type==="tree"?await Ol({fs:n,cache:e,gitdir:t,oid:E.oid,filenames:a,prefix:_e(s,E.path)}):a.push(_e(s,E.path))}async function Pl({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,cache:a={}}){try{se("fs",n),se("gitdir",t);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Od({fs:s,cache:a,gitdir:p,ref:i})}catch(s){throw s.caller="git.listFiles",s}}async function Pd({fs:n,cache:e,gitdir:t,ref:i}){let a;try{a=await G.resolve({gitdir:t,fs:n,ref:i})}catch(E){if(E instanceof ct)return[]}return(await Rn({fs:n,cache:e,gitdir:t,oid:a})).tree.map(E=>({target:E.path,note:E.oid}))}async function Bl({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i="refs/notes/commits",cache:a={}}){try{se("fs",n),se("gitdir",t),se("ref",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Pd({fs:s,cache:a,gitdir:p,ref:i})}catch(s){throw s.caller="git.listNotes",s}}async function Cl({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i}){try{se("fs",n),se("gitdir",t);const a=new at(n),s=await it({fsp:a,dotgit:t});return G.listRefs({fs:a,gitdir:s,filepath:i})}catch(a){throw a.caller="git.listRefs",a}}async function Bd({fs:n,gitdir:e}){const t=await W.get({fs:n,gitdir:e}),i=await t.getSubsections("remote");return Promise.all(i.map(async s=>{const p=await t.get(`remote.${s}.url`);return{remote:s,url:p}}))}async function $l({fs:n,dir:e,gitdir:t=_e(e,".git")}){try{se("fs",n),se("gitdir",t);const i=new at(n),a=await it({fsp:i,dotgit:t});return await Bd({fs:i,gitdir:a})}catch(i){throw i.caller="git.listRemotes",i}}async function Cd(n){const e=ir.streamReader(n),t=[];let i;for(;i=await e(),i!==!0;){if(i===null)continue;i=i.toString("utf8").replace(/\n$/,"");const[a,s,...p]=i.split(" "),E={ref:s,oid:a};for(const T of p){const[C,I]=T.split(":");C==="symref-target"?E.target=I:C==="peeled"&&(E.peeled=I)}t.push(E)}return t}async function $d({prefix:n,symrefs:e,peelTags:t}){const i=[];return i.push(ir.encode(`command=ls-refs
`)),i.push(ir.encode(`agent=${ye.agent}
`)),(t||e||n)&&i.push(ir.delim()),t&&i.push(ir.encode("peel")),e&&i.push(ir.encode("symrefs")),n&&i.push(ir.encode(`ref-prefix ${n}`)),i.push(ir.flush()),i}async function Fl({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,url:s,headers:p={},forPush:E=!1,protocolVersion:T=2,prefix:C,symrefs:I,peelTags:N}){try{se("http",n),se("url",s);const M=await $.discover({http:n,onAuth:e,onAuthSuccess:t,onAuthFailure:i,corsProxy:a,service:E?"git-receive-pack":"git-upload-pack",url:s,headers:p,protocolVersion:T});if(M.protocolVersion===1)return _l(M,C,I,N);const Y=await $d({prefix:C,symrefs:I,peelTags:N}),he=await $.connect({http:n,auth:M.auth,headers:p,corsProxy:a,service:E?"git-receive-pack":"git-upload-pack",url:s,body:Y});return Cd(he.body)}catch(M){throw M.caller="git.listServerRefs",M}}async function Dl({fs:n,dir:e,gitdir:t=_e(e,".git")}){try{se("fs",n),se("gitdir",t);const i=new at(n),a=await it({fsp:i,dotgit:t});return G.listTags({fs:i,gitdir:a})}catch(i){throw i.caller="git.listTags",i}}function Fd(n,e){return n.committer.timestamp-e.committer.timestamp}const Dd="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Nl({fs:n,cache:e,gitdir:t,oid:i,fileId:a}){if(a===Dd)return;const s=i;let p;const E=await Jt({fs:n,cache:e,gitdir:t,oid:i}),T=E.tree;return a===E.oid?p=E.path:(p=await jl({fs:n,cache:e,gitdir:t,tree:T,fileId:a,oid:s}),Array.isArray(p)&&(p.length===0?p=void 0:p.length===1&&(p=p[0]))),p}async function jl({fs:n,cache:e,gitdir:t,tree:i,fileId:a,oid:s,filepaths:p=[],parentPath:E=""}){const T=i.entries().map(function(C){let I;return C.oid===a?(I=_e(E,C.path),p.push(I)):C.type==="tree"&&(I=_t({fs:n,cache:e,gitdir:t,oid:C.oid}).then(function({object:N}){return jl({fs:n,cache:e,gitdir:t,tree:Ge.from(N),fileId:a,oid:s,filepaths:p,parentPath:_e(E,C.path)})})),I});return await Promise.all(T),p}async function Nd({fs:n,cache:e,gitdir:t,filepath:i,ref:a,depth:s,since:p,force:E,follow:T}){const C=typeof p>"u"?void 0:Math.floor(p.valueOf()/1e3),I=[],N=await re.read({fs:n,gitdir:t}),M=await G.resolve({fs:n,gitdir:t,ref:a}),Y=[await Vt({fs:n,cache:e,gitdir:t,oid:M})];let he,Ie,xe;function Oe($e){xe&&i&&I.push($e)}for(;Y.length>0;){const $e=Y.pop();if(C!==void 0&&$e.commit.committer.timestamp<=C)break;if(i){let Ye;try{Ye=await Gn({fs:n,cache:e,gitdir:t,oid:$e.commit.tree,filepath:i}),Ie&&he!==Ye&&I.push(Ie),he=Ye,Ie=$e,xe=!0}catch(rt){if(rt instanceof ct){let ot=T&&he;if(ot&&(ot=await Nl({fs:n,cache:e,gitdir:t,oid:$e.commit.tree,fileId:he}),ot))if(Array.isArray(ot)){if(Ie){const st=await Nl({fs:n,cache:e,gitdir:t,oid:Ie.commit.tree,fileId:he});if(Array.isArray(st))if(ot=ot.filter(He=>st.indexOf(He)===-1),ot.length===1)ot=ot[0],i=ot,Ie&&I.push(Ie);else{ot=!1,Ie&&I.push(Ie);break}}}else i=ot,Ie&&I.push(Ie);if(!ot){if(xe&&he&&(I.push(Ie),!E))break;if(!E&&!T)throw rt}Ie=$e,xe=!1}else throw rt}}else I.push($e);if(s!==void 0&&I.length===s){Oe($e);break}if(!N.has($e.oid))for(const Ye of $e.commit.parent){const rt=await Vt({fs:n,cache:e,gitdir:t,oid:Ye});Y.map(ot=>ot.oid).includes(rt.oid)||Y.push(rt)}Y.length===0&&Oe($e),Y.sort((Ye,rt)=>Fd(Ye.commit,rt.commit))}return I}async function Ml({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i,ref:a="HEAD",depth:s,since:p,force:E,follow:T,cache:C={}}){try{se("fs",n),se("gitdir",t),se("ref",a);const I=new at(n),N=await it({fsp:I,dotgit:t});return await Nd({fs:I,cache:C,gitdir:N,filepath:i,ref:a,depth:s,since:p,force:E,follow:T})}catch(I){throw I.caller="git.log",I}}async function ql({fs:n,onSign:e,dir:t,gitdir:i=_e(t,".git"),ours:a,theirs:s,fastForward:p=!0,fastForwardOnly:E=!1,dryRun:T=!1,noUpdateBranch:C=!1,abortOnConflict:I=!0,message:N,author:M,committer:Y,signingKey:he,cache:Ie={},mergeDriver:xe,allowUnrelatedHistories:Oe=!1}){try{se("fs",n),he&&se("onSign",e);const $e=new at(n),Ye=await it({fsp:$e,dotgit:i}),rt=await Vr({fs:$e,gitdir:Ye,author:M});if(!rt&&(!E||!p))throw new cr("author");const ot=await on({fs:$e,gitdir:Ye,author:rt,committer:Y});if(!ot&&(!E||!p))throw new cr("committer");return await fl({fs:$e,cache:Ie,dir:t,gitdir:Ye,ours:a,theirs:s,fastForward:p,fastForwardOnly:E,dryRun:T,noUpdateBranch:C,abortOnConflict:I,message:N,author:rt,committer:ot,signingKey:he,onSign:e,mergeDriver:xe,allowUnrelatedHistories:Oe})}catch($e){throw $e.caller="git.merge",$e}}const jd={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function Ul({fs:n,cache:e,dir:t,gitdir:i=_e(t,".git"),oids:a}){const s=new w,p=[];function E(I,N){const M=Buffer.from(I,N);p.push(M),s.update(M)}async function T({stype:I,object:N}){const M=jd[I];let Y=N.length,he=Y>15?128:0;const Ie=Y&15;Y=Y>>>4;let xe=(he|M|Ie).toString(16);for(E(xe,"hex");he;)he=Y>127?128:0,xe=he|Y&127,E(Xr(2,xe),"hex"),Y=Y>>>7;E(Buffer.from(await yi(N)))}E("PACK"),E("00000002","hex"),E(Xr(8,a.length),"hex");for(const I of a){const{type:N,object:M}=await _t({fs:n,cache:e,gitdir:i,oid:I});await T({object:M,stype:N})}const C=s.digest();return p.push(C),p}async function Md({fs:n,cache:e,gitdir:t,oids:i,write:a}){const s=await Ul({fs:n,cache:e,gitdir:t,oids:i}),p=Buffer.from(await Wn(s)),T=`pack-${p.slice(-20).toString("hex")}.pack`;return a?(await n.write(_e(t,`objects/pack/${T}`),p),{filename:T}):{filename:T,packfile:new Uint8Array(p)}}async function Ll({fs:n,dir:e,gitdir:t=_e(e,".git"),oids:i,write:a=!1,cache:s={}}){try{se("fs",n),se("gitdir",t),se("oids",i);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Md({fs:p,cache:s,gitdir:E,oids:i,write:a})}catch(p){throw p.caller="git.packObjects",p}}async function zl({fs:n,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,dir:E,gitdir:T=_e(E,".git"),ref:C,url:I,remote:N,remoteRef:M,prune:Y=!1,pruneTags:he=!1,fastForward:Ie=!0,fastForwardOnly:xe=!1,corsProxy:Oe,singleBranch:$e,headers:Ye={},author:rt,committer:ot,signingKey:st,cache:He={}}){try{se("fs",n),se("gitdir",T);const Ke=new at(n),Xe=await it({fsp:Ke,dotgit:T}),At=await Vr({fs:Ke,gitdir:Xe,author:rt});if(!At)throw new cr("author");const Nt=await on({fs:Ke,gitdir:Xe,author:At,committer:ot});if(!Nt)throw new cr("committer");return await hl({fs:Ke,cache:He,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,dir:E,gitdir:Xe,ref:C,url:I,remote:N,remoteRef:M,fastForward:Ie,fastForwardOnly:xe,corsProxy:Oe,singleBranch:$e,headers:Ye,author:At,committer:Nt,signingKey:st,prune:Y,pruneTags:he})}catch(Ke){throw Ke.caller="git.pull",Ke}}async function qd({fs:n,cache:e,dir:t,gitdir:i=_e(t,".git"),start:a,finish:s}){const p=await re.read({fs:n,gitdir:i}),E=new Set,T=new Set;for(const N of a)E.add(await G.resolve({fs:n,gitdir:i,ref:N}));for(const N of s)try{const M=await G.resolve({fs:n,gitdir:i,ref:N});T.add(M)}catch{}const C=new Set;async function I(N){C.add(N);const{type:M,object:Y}=await _t({fs:n,cache:e,gitdir:i,oid:N});if(M==="tag"){const Ie=mr.from(Y).headers().object;return I(Ie)}if(M!=="commit")throw new ht(N,M,"commit");if(!p.has(N)){const Ie=Zt.from(Y).headers().parent;for(N of Ie)!T.has(N)&&!C.has(N)&&await I(N)}}for(const N of E)await I(N);return C}async function Ns({fs:n,cache:e,dir:t,gitdir:i=_e(t,".git"),oids:a}){const s=new Set;async function p(E){if(s.has(E))return;s.add(E);const{type:T,object:C}=await _t({fs:n,cache:e,gitdir:i,oid:E});if(T==="tag"){const N=mr.from(C).headers().object;await p(N)}else if(T==="commit"){const N=Zt.from(C).headers().tree;await p(N)}else if(T==="tree"){const I=Ge.from(C);for(const N of I)N.type==="blob"&&s.add(N.oid),N.type==="tree"&&await p(N.oid)}}for(const E of a)await p(E);return s}async function Ud(n){const e={};let t="";const i=ir.streamReader(n);let a=await i();for(;a!==!0;)a!==null&&(t+=a.toString("utf8")+`
`),a=await i();const s=t.toString("utf8").split(`
`);if(a=s.shift(),!a.startsWith("unpack "))throw new fn('unpack ok" or "unpack [error message]',a);e.ok=a==="unpack ok",e.ok||(e.error=a.slice(7)),e.refs={};for(const p of s){if(p.trim()==="")continue;const E=p.slice(0,2),T=p.slice(3);let C=T.indexOf(" ");C===-1&&(C=T.length);const I=T.slice(0,C),N=T.slice(C+1);e.refs[I]={ok:E==="ok",error:N}}return e}async function Ld({capabilities:n=[],triplets:e=[]}){const t=[];let i=`\0 ${n.join(" ")}`;for(const a of e)t.push(ir.encode(`${a.oldoid} ${a.oid} ${a.fullRef}${i}
`)),i="";return t.push(ir.flush()),t}async function zd({fs:n,cache:e,http:t,onProgress:i,onMessage:a,onAuth:s,onAuthSuccess:p,onAuthFailure:E,onPrePush:T,gitdir:C,ref:I,remoteRef:N,remote:M,url:Y,force:he=!1,delete:Ie=!1,corsProxy:xe,headers:Oe={}}){const $e=I||await wn({fs:n,gitdir:C});if(typeof $e>"u")throw new Er("ref");const Ye=await W.get({fs:n,gitdir:C});M=M||await Ye.get(`branch.${$e}.pushRemote`)||await Ye.get("remote.pushDefault")||await Ye.get(`branch.${$e}.remote`)||"origin";const rt=Y||await Ye.get(`remote.${M}.pushurl`)||await Ye.get(`remote.${M}.url`);if(typeof rt>"u")throw new Er("remote OR url");const ot=N||await Ye.get(`branch.${$e}.merge`);if(typeof rt>"u")throw new Er("remoteRef");xe===void 0&&(xe=await Ye.get("http.corsProxy"));const st=await G.expand({fs:n,gitdir:C,ref:$e}),He=Ie?"0000000000000000000000000000000000000000":await G.resolve({fs:n,gitdir:C,ref:st}),Ke=q.getRemoteHelperFor({url:rt}),Xe=await Ke.discover({http:t,onAuth:s,onAuthSuccess:p,onAuthFailure:E,corsProxy:xe,service:"git-receive-pack",url:rt,headers:Oe,protocolVersion:1}),At=Xe.auth;let Nt;if(!ot)Nt=st;else try{Nt=await G.expandAgainstMap({ref:ot,map:Xe.refs})}catch(ur){if(ur instanceof ct)Nt=ot.startsWith("refs/")?ot:`refs/heads/${ot}`;else throw ur}const vr=Xe.refs.get(Nt)||"0000000000000000000000000000000000000000";if(T&&!await T({remote:M,url:rt,localRef:{ref:Ie?"(delete)":st,oid:He},remoteRef:{ref:Nt,oid:vr}}))throw new hn;const Ut=!Xe.capabilities.has("no-thin");let br=new Set;if(!Ie){const ur=[...Xe.refs.values()];let yn=new Set;if(vr!=="0000000000000000000000000000000000000000"){const Rr=await Ds({fs:n,cache:e,gitdir:C,oids:[He,vr]});for(const ra of Rr)ur.push(ra);Ut&&(yn=await Ns({fs:n,cache:e,gitdir:C,oids:Rr}))}if(!ur.includes(He)){const Rr=await qd({fs:n,cache:e,gitdir:C,start:[He],finish:ur});br=await Ns({fs:n,cache:e,gitdir:C,oids:Rr})}if(Ut){try{const Rr=await G.resolve({fs:n,gitdir:C,ref:`refs/remotes/${M}/HEAD`,depth:2}),{oid:ra}=await G.resolveAgainstMap({ref:Rr.replace(`refs/remotes/${M}/`,""),fullref:Rr,map:Xe.refs}),fi=[ra];for(const _r of await Ns({fs:n,cache:e,gitdir:C,oids:fi}))yn.add(_r)}catch{}for(const Rr of yn)br.delete(Rr)}if(He===vr&&(he=!0),!he){if(st.startsWith("refs/tags")&&vr!=="0000000000000000000000000000000000000000")throw new Dt("tag-exists");if(He!=="0000000000000000000000000000000000000000"&&vr!=="0000000000000000000000000000000000000000"&&!await Sl({fs:n,cache:e,gitdir:C,oid:He,ancestor:vr,depth:-1}))throw new Dt("not-fast-forward")}}const Ar=ne([...Xe.capabilities],["report-status","side-band-64k",`agent=${ye.agent}`]),ui=await Ld({capabilities:Ar,triplets:[{oldoid:vr,oid:He,fullRef:Nt}]}),li=Ie?[]:await Ul({fs:n,cache:e,gitdir:C,oids:[...br]}),Ti=await Ke.connect({http:t,onProgress:i,corsProxy:xe,service:"git-receive-pack",url:rt,auth:At,headers:Oe,body:[...ui,...li]}),{packfile:Ms,progress:qs}=await je.demux(Ti.body);if(a){const ur=Pe(qs);Nr(ur,async yn=>{await a(yn)})}const jr=await Ud(Ms);if(Ti.headers&&(jr.headers=Ti.headers),M&&jr.ok&&jr.refs[Nt].ok&&!st.startsWith("refs/tags")){const ur=`refs/remotes/${M}/${Nt.replace("refs/heads","")}`;Ie?await G.deleteRef({fs:n,gitdir:C,ref:ur}):await G.writeRef({fs:n,gitdir:C,ref:ur,value:He})}if(jr.ok&&Object.values(jr.refs).every(ur=>ur.ok))return jr;{const ur=Object.entries(jr.refs).filter(([yn,Rr])=>!Rr.ok).map(([yn,Rr])=>`
  - ${yn}: ${Rr.error}`).join("");throw new Dn(ur,jr)}}async function Hl({fs:n,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,onPrePush:E,dir:T,gitdir:C=_e(T,".git"),ref:I,remoteRef:N,remote:M="origin",url:Y,force:he=!1,delete:Ie=!1,corsProxy:xe,headers:Oe={},cache:$e={}}){try{se("fs",n),se("http",e),se("gitdir",C);const Ye=new at(n),rt=await it({fsp:Ye,dotgit:C});return await zd({fs:Ye,cache:$e,http:e,onProgress:t,onMessage:i,onAuth:a,onAuthSuccess:s,onAuthFailure:p,onPrePush:E,gitdir:rt,ref:I,remoteRef:N,remote:M,url:Y,force:he,delete:Ie,corsProxy:xe,headers:Oe})}catch(Ye){throw Ye.caller="git.push",Ye}}async function Gl({fs:n,cache:e,gitdir:t,oid:i}){const{type:a,object:s}=await _t({fs:n,cache:e,gitdir:t,oid:i});if(a==="tag")return i=mr.from(s).parse().object,Gl({fs:n,cache:e,gitdir:t,oid:i});if(a!=="blob")throw new ht(i,a,"blob");return{oid:i,blob:new Uint8Array(s)}}async function Kl({fs:n,cache:e,gitdir:t,oid:i,filepath:a=void 0}){return a!==void 0&&(i=await Gn({fs:n,cache:e,gitdir:t,oid:i,filepath:a})),await Gl({fs:n,cache:e,gitdir:t,oid:i})}async function Wl({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,filepath:a,cache:s={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Kl({fs:p,cache:s,gitdir:E,oid:i,filepath:a})}catch(p){throw p.caller="git.readBlob",p}}async function js({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Vt({fs:s,cache:a,gitdir:p,oid:i})}catch(s){throw s.caller="git.readCommit",s}}async function Hd({fs:n,cache:e,gitdir:t,ref:i="refs/notes/commits",oid:a}){const s=await G.resolve({gitdir:t,fs:n,ref:i}),{blob:p}=await Kl({fs:n,cache:e,gitdir:t,oid:s,filepath:a});return p}async function Zl({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i="refs/notes/commits",oid:a,cache:s={}}){try{se("fs",n),se("gitdir",t),se("ref",i),se("oid",a);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Hd({fs:p,cache:s,gitdir:E,ref:i,oid:a})}catch(p){throw p.caller="git.readNote",p}}async function Vl({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,format:a="parsed",filepath:s=void 0,encoding:p=void 0,cache:E={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const T=new at(n),C=await it({fsp:T,dotgit:t});s!==void 0&&(i=await Gn({fs:T,cache:E,gitdir:C,oid:i,filepath:s}));const N=await _t({fs:T,cache:E,gitdir:C,oid:i,format:a==="parsed"?"content":a});if(N.oid=i,a==="parsed")switch(N.format="parsed",N.type){case"commit":N.object=Zt.from(N.object).parse();break;case"tree":N.object=Ge.from(N.object).entries();break;case"blob":p?N.object=N.object.toString(p):(N.object=new Uint8Array(N.object),N.format="content");break;case"tag":N.object=mr.from(N.object).parse();break;default:throw new ht(N.oid,N.type,"blob|commit|tag|tree")}else(N.format==="deflated"||N.format==="wrapped")&&(N.type=N.format);return N}catch(T){throw T.caller="git.readObject",T}}async function Gd({fs:n,cache:e,gitdir:t,oid:i}){const{type:a,object:s}=await _t({fs:n,cache:e,gitdir:t,oid:i,format:"content"});if(a!=="tag")throw new ht(i,a,"tag");const p=mr.from(s);return{oid:i,tag:p.parse(),payload:p.payload()}}async function Yl({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await Gd({fs:s,cache:a,gitdir:p,oid:i})}catch(s){throw s.caller="git.readTag",s}}async function Xl({fs:n,dir:e,gitdir:t=_e(e,".git"),oid:i,filepath:a=void 0,cache:s={}}){try{se("fs",n),se("gitdir",t),se("oid",i);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Rn({fs:p,cache:s,gitdir:E,oid:i,filepath:a})}catch(p){throw p.caller="git.readTree",p}}async function Jl({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("filepath",i);const s=new at(n),p=await it({fsp:s,dotgit:t});await Ue.acquire({fs:s,gitdir:p,cache:a},async function(E){E.delete({filepath:i})})}catch(s){throw s.caller="git.remove",s}}async function Kd({fs:n,cache:e,onSign:t,gitdir:i,ref:a="refs/notes/commits",oid:s,author:p,committer:E,signingKey:T}){let C;try{C=await G.resolve({gitdir:i,fs:n,ref:a})}catch(he){if(!(he instanceof ct))throw he}let N=(await Rn({fs:n,cache:e,gitdir:i,oid:C||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;N=N.filter(he=>he.path!==s);const M=await Kn({fs:n,gitdir:i,tree:N});return await sn({fs:n,cache:e,onSign:t,gitdir:i,ref:a,tree:M,parent:C&&[C],message:`Note removed by 'isomorphic-git removeNote'
`,author:p,committer:E,signingKey:T})}async function Ql({fs:n,onSign:e,dir:t,gitdir:i=_e(t,".git"),ref:a="refs/notes/commits",oid:s,author:p,committer:E,signingKey:T,cache:C={}}){try{se("fs",n),se("gitdir",i),se("oid",s);const I=new at(n),N=await it({fsp:I,dotgit:i}),M=await Vr({fs:I,gitdir:N,author:p});if(!M)throw new cr("author");const Y=await on({fs:I,gitdir:N,author:M,committer:E});if(!Y)throw new cr("committer");return await Kd({fs:I,cache:C,onSign:e,gitdir:N,ref:a,oid:s,author:M,committer:Y,signingKey:T})}catch(I){throw I.caller="git.removeNote",I}}async function Wd({fs:n,gitdir:e,oldref:t,ref:i,checkout:a=!1}){if(!Tn(i))throw new xt(i,d.clean(i));if(!Tn(t))throw new xt(t,d.clean(t));const s=`refs/heads/${t}`,p=`refs/heads/${i}`;if(await G.exists({fs:n,gitdir:e,ref:p}))throw new wr("branch",i,!1);const T=await G.resolve({fs:n,gitdir:e,ref:s,depth:1});await G.writeRef({fs:n,gitdir:e,ref:p,value:T}),await G.deleteRef({fs:n,gitdir:e,ref:s});const I=await wn({fs:n,gitdir:e,fullname:!0})===s;(a||I)&&await G.writeSymbolicRef({fs:n,gitdir:e,ref:"HEAD",value:p})}async function ef({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,oldref:a,checkout:s=!1}){try{se("fs",n),se("gitdir",t),se("ref",i),se("oldref",a);const p=new at(n),E=await it({fsp:p,dotgit:t});return await Wd({fs:p,gitdir:E,ref:i,oldref:a,checkout:s})}catch(p){throw p.caller="git.renameBranch",p}}async function tf({gitdir:n,type:e,object:t}){return le(yt.wrap({type:e,object:t}))}async function rf({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i,ref:a,cache:s={}}){try{se("fs",n),se("gitdir",t),se("filepath",i);const p=new at(n),E=await it({fsp:p,dotgit:t});let T,C;try{T=await G.resolve({fs:p,gitdir:E,ref:a||"HEAD"})}catch(M){if(a)throw M}if(T)try{T=await Gn({fs:p,cache:s,gitdir:E,oid:T,filepath:i})}catch{T=null}let I={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const N=e&&await p.read(_e(e,i));N&&(C=await tf({gitdir:E,type:"blob",object:N}),T===C&&(I=await p.lstat(_e(e,i)))),await Ue.acquire({fs:p,gitdir:E,cache:s},async function(M){M.delete({filepath:i}),T&&M.insert({filepath:i,stats:I,oid:T})})}catch(p){throw p.caller="git.reset",p}}async function nf({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,depth:a}){try{se("fs",n),se("gitdir",t),se("ref",i);const s=new at(n),p=await it({fsp:s,dotgit:t});return await G.resolve({fs:s,gitdir:p,ref:i,depth:a})}catch(s){throw s.caller="git.resolveRef",s}}async function af({fs:n,dir:e,gitdir:t=_e(e,".git"),path:i,value:a,append:s=!1}){try{se("fs",n),se("gitdir",t),se("path",i);const p=new at(n),E=await it({fsp:p,dotgit:t}),T=await W.get({fs:p,gitdir:E});s?await T.append(i,a):await T.set(i,a),await W.save({fs:p,gitdir:E,config:T})}catch(p){throw p.caller="git.setConfig",p}}async function of({fs:n,gitdir:e,commit:t}){const i=Zt.from(t).toObject();return await yr({fs:n,gitdir:e,type:"commit",object:i,format:"content"})}class Pa{static get timezoneOffsetForRefLogEntry(){const e=new Date().getTimezoneOffset(),t=Math.abs(Math.floor(e/60)),i=Math.abs(e%60).toString().padStart(2,"0");return`${e>0?"-":"+"}${t.toString().padStart(2,"0")}${i}`}static createStashReflogEntry(e,t,i){const a=e.name.replace(/\s/g,""),s="0000000000000000000000000000000000000000",p=Math.floor(Date.now()/1e3),E=Pa.timezoneOffsetForRefLogEntry;return`${s} ${t} ${a} ${e.email} ${p} ${E}	${i}
`}static getStashReflogEntry(e,t=!1){return e.split(`
`).filter(s=>s).reverse().map((s,p)=>t?`stash@{${p}}: ${s.split("	")[1]}`:s)}}class Bn{constructor({fs:e,dir:t,gitdir:i=_e(t,".git")}){Object.assign(this,{fs:e,dir:t,gitdir:i,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return _e(this.gitdir,Bn.refStash)}get refLogsStashPath(){return _e(this.gitdir,Bn.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Vr({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new cr("author");return this._author}async getStashSHA(e,t){return await this.fs.exists(this.refStashPath)?(t||await this.readStashReflogs({parsed:!1}))[e].split(" ")[1]:null}async writeStashCommit({message:e,tree:t,parent:i}){return of({fs:this.fs,gitdir:this.gitdir,commit:{message:e,tree:t,parent:i,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(e){const t=await this.readStashReflogs({parsed:!1});if(e!==0&&(e<0||e>t.length-1))throw new xt(`stash@${e}`,"number that is in range of [0, num of stash pushed]");const i=await this.getStashSHA(e,t);return i?Vt({fs:this.fs,cache:{},gitdir:this.gitdir,oid:i}):{}}async writeStashRef(e){return G.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Bn.refStash,value:e})}async writeStashReflogEntry({stashCommit:e,message:t}){const i=await this.getAuthor(),a=Pa.createStashReflogEntry(i,e,t),s=this.refLogsStashPath;await On({filepath:s,entry:a},async()=>{const p=await this.fs.exists(s)?await this.fs.read(s,"utf8"):"";await this.fs.write(s,p+a,"utf8")})}async readStashReflogs({parsed:e=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const t=await this.fs.read(this.refLogsStashPath,"utf8");return Pa.getStashReflogEntry(t,e)}}async function sf({fs:n,dir:e,gitdir:t,message:i=""}){const a=new Bn({fs:n,dir:e,gitdir:t});await a.getAuthor();const s=await wn({fs:n,gitdir:t,fullname:!1}),p=await G.resolve({fs:n,gitdir:t,ref:"HEAD"}),T=(await js({fs:n,dir:e,gitdir:t,oid:p})).commit.message,C=[p];let I=null,N=gr({ref:"HEAD"});const M=await Oa({fs:n,dir:e,gitdir:t,treePair:[gr({ref:"HEAD"}),"stage"]});if(M){const xe=await a.writeStashCommit({message:`stash-Index: WIP on ${s} - ${new Date().toISOString()}`,tree:M,parent:C});C.push(xe),I=M,N=Et()}const Y=await Oa({fs:n,dir:e,gitdir:t,treePair:[N,"workdir"]});if(Y){const xe=await a.writeStashCommit({message:`stash-WorkDir: WIP on ${s} - ${new Date().toISOString()}`,tree:Y,parent:[C[C.length-1]]});C.push(xe),I=Y}if(!I||!M&&!Y)throw new ct("changes, nothing to stash");const he=(i.trim()||`WIP on ${s}`)+`: ${p.substring(0,7)} ${T}`;return{stashCommit:await a.writeStashCommit({message:he,tree:I,parent:C}),stashMsg:he,branch:s,stashMgr:a}}async function Zd({fs:n,dir:e,gitdir:t,message:i=""}){const{stashCommit:a,stashMsg:s,branch:p,stashMgr:E}=await sf({fs:n,dir:e,gitdir:t,message:i});return await E.writeStashRef(a),await E.writeStashReflogEntry({stashCommit:a,message:s}),await Xi({fs:n,dir:e,gitdir:t,ref:p,track:!1,force:!0}),a}async function Vd({fs:n,dir:e,gitdir:t,message:i=""}){const{stashCommit:a}=await sf({fs:n,dir:e,gitdir:t,message:i});return a}async function cf({fs:n,dir:e,gitdir:t,refIdx:i=0}){const s=await new Bn({fs:n,dir:e,gitdir:t}).readStashCommit(i),{parent:p=null}=s.commit?s.commit:{};if(!(!p||!Array.isArray(p)))for(let E=0;E<p.length-1;E++){const C=(await Vt({fs:n,cache:{},gitdir:t,oid:p[E+1]})).commit.message.startsWith("stash-Index");await ci({fs:n,dir:e,gitdir:t,stashCommit:p[E+1],parentCommit:p[E],wasStaged:C})}}async function uf({fs:n,dir:e,gitdir:t,refIdx:i=0}){const a=new Bn({fs:n,dir:e,gitdir:t});if(!(await a.readStashCommit(i)).commit)return;const p=a.refStashPath;await On(p,async()=>{await n.exists(p)&&await n.rm(p)});const E=await a.readStashReflogs({parsed:!1});if(!E.length)return;E.splice(i,1);const T=a.refLogsStashPath;await On({reflogEntries:E,stashReflogPath:T,stashMgr:a},async()=>{if(E.length){await n.write(T,E.reverse().join(`
`)+`
`,"utf8");const C=E[E.length-1].split(" ")[1];await a.writeStashRef(C)}else await n.rm(T)})}async function Yd({fs:n,dir:e,gitdir:t}){return new Bn({fs:n,dir:e,gitdir:t}).readStashReflogs({parsed:!0})}async function Xd({fs:n,dir:e,gitdir:t}){const i=new Bn({fs:n,dir:e,gitdir:t}),a=[i.refStashPath,i.refLogsStashPath];await On(a,async()=>{await Promise.all(a.map(async s=>{if(await n.exists(s))return n.rm(s)}))})}async function Jd({fs:n,dir:e,gitdir:t,refIdx:i=0}){await cf({fs:n,dir:e,gitdir:t,refIdx:i}),await uf({fs:n,dir:e,gitdir:t,refIdx:i})}async function lf({fs:n,dir:e,gitdir:t=_e(e,".git"),op:i="push",message:a="",refIdx:s=0}){se("fs",n),se("dir",e),se("gitdir",t),se("op",i);const p={push:Zd,apply:cf,drop:uf,list:Yd,clear:Xd,pop:Jd,create:Vd},E=["apply","drop","pop"];try{const T=new at(n),C=await it({fsp:T,dotgit:t});["refs","logs","logs/refs"].map(M=>_e(C,M)).forEach(async M=>{await T.exists(M)||await T.mkdir(M)});const N=p[i];if(N){if(E.includes(i)&&s<0)throw new xt(`stash@${s}`,"number that is in range of [0, num of stash pushed]");return await N({fs:T,dir:e,gitdir:C,message:a,refIdx:s})}throw new Error(`To be implemented: ${i}`)}catch(T){throw T.caller="git.stash",T}}async function ff({fs:n,dir:e,gitdir:t=_e(e,".git"),filepath:i,cache:a={}}){try{se("fs",n),se("gitdir",t),se("filepath",i);const s=new at(n),p=await it({fsp:s,dotgit:t});if(await zn.isIgnored({fs:s,gitdir:p,dir:e,filepath:i}))return"ignored";const T=await Qd({fs:s,cache:a,gitdir:p}),C=await hf({fs:s,cache:a,gitdir:p,tree:T,path:i}),I=await Ue.acquire({fs:s,gitdir:p,cache:a},async function(xe){for(const Oe of xe)if(Oe.path===i)return Oe;return null}),N=await s.lstat(_e(e,i)),M=C!==null,Y=I!==null,he=N!==null,Ie=async()=>{if(Y&&!Se(I,N))return I.oid;{const xe=await s.read(_e(e,i)),Oe=await tf({gitdir:p,type:"blob",object:xe});return Y&&I.oid===Oe&&N.size!==-1&&Ue.acquire({fs:s,gitdir:p,cache:a},async function($e){$e.insert({filepath:i,stats:N,oid:Oe})}),Oe}};if(!M&&!he&&!Y)return"absent";if(!M&&!he&&Y)return"*absent";if(!M&&he&&!Y)return"*added";if(!M&&he&&Y)return await Ie()===I.oid?"added":"*added";if(M&&!he&&!Y)return"deleted";if(M&&!he&&Y)return C===I.oid,"*deleted";if(M&&he&&!Y)return await Ie()===C?"*undeleted":"*undeletemodified";if(M&&he&&Y){const xe=await Ie();return xe===C?xe===I.oid?"unmodified":"*unmodified":xe===I.oid?"modified":"*modified"}}catch(s){throw s.caller="git.status",s}}async function hf({fs:n,cache:e,gitdir:t,tree:i,path:a}){typeof a=="string"&&(a=a.split("/"));const s=a.shift();for(const p of i)if(p.path===s){if(a.length===0)return p.oid;const{type:E,object:T}=await _t({fs:n,cache:e,gitdir:t,oid:p.oid});if(E==="tree"){const C=Ge.from(T);return hf({fs:n,cache:e,gitdir:t,tree:C,path:a})}if(E==="blob")throw new ht(p.oid,E,"blob",a.join("/"))}return null}async function Qd({fs:n,cache:e,gitdir:t}){let i;try{i=await G.resolve({fs:n,gitdir:t,ref:"HEAD"})}catch(s){if(s instanceof ct)return[]}const{tree:a}=await Rn({fs:n,cache:e,gitdir:t,oid:i});return a}async function df({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i="HEAD",filepaths:a=["."],filter:s,cache:p={},ignored:E=!1}){try{se("fs",n),se("gitdir",t),se("ref",i);const T=new at(n),C=await it({fsp:T,dotgit:t});return await an({fs:T,cache:p,dir:e,gitdir:C,trees:[gr({ref:i}),pn(),Et()],map:async function(I,[N,M,Y]){if(!N&&!Y&&M&&!E&&await zn.isIgnored({fs:T,dir:e,filepath:I})||!a.some(He=>si(I,He)))return null;if(s&&!s(I))return;const[he,Ie,xe]=await Promise.all([N&&N.type(),M&&M.type(),Y&&Y.type()]),Oe=[he,Ie,xe].includes("blob");if((he==="tree"||he==="special")&&!Oe)return;if(he==="commit")return null;if((Ie==="tree"||Ie==="special")&&!Oe)return;if(xe==="commit")return null;if((xe==="tree"||xe==="special")&&!Oe)return;const $e=he==="blob"?await N.oid():void 0,Ye=xe==="blob"?await Y.oid():void 0;let rt;he!=="blob"&&Ie==="blob"&&xe!=="blob"?rt="42":Ie==="blob"&&(rt=await M.oid());const ot=[void 0,$e,rt,Ye],st=ot.map(He=>ot.indexOf(He));return st.shift(),[I,...st]}})}catch(T){throw T.caller="git.statusMatrix",T}}async function pf({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,object:a,force:s=!1}){try{se("fs",n),se("gitdir",t),se("ref",i);const p=new at(n);if(i===void 0)throw new Er("ref");i=i.startsWith("refs/tags/")?i:`refs/tags/${i}`;const E=await it({fsp:p,dotgit:t}),T=await G.resolve({fs:p,gitdir:E,ref:a||"HEAD"});if(!s&&await G.exists({fs:p,gitdir:E,ref:i}))throw new wr("tag",i);await G.writeRef({fs:p,gitdir:E,ref:i,value:T})}catch(p){throw p.caller="git.tag",p}}async function mf({fs:n,dir:e,gitdir:t=_e(e,".git"),cache:i={},filepath:a,oid:s,mode:p,add:E,remove:T,force:C}){try{se("fs",n),se("gitdir",t),se("filepath",a);const I=new at(n),N=await it({fsp:I,dotgit:t});if(T)return await Ue.acquire({fs:I,gitdir:N,cache:i},async function(Y){if(!C){const he=await I.lstat(_e(e,a));if(he){if(he.isDirectory())throw new tn("directory");return}}Y.has({filepath:a})&&Y.delete({filepath:a})});let M;if(!s){if(M=await I.lstat(_e(e,a)),!M)throw new ct(`file at "${a}" on disk and "remove" not set`);if(M.isDirectory())throw new tn("directory")}return await Ue.acquire({fs:I,gitdir:N,cache:i},async function(Y){if(!E&&!Y.has({filepath:a}))throw new ct(`file at "${a}" in index and "add" not set`);let he;if(s)he={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:p,uid:0,gid:0,size:0};else{he=M;const Ie=he.isSymbolicLink()?await I.readlink(_e(e,a)):await I.read(_e(e,a));s=await yr({fs:I,gitdir:N,type:"blob",format:"content",object:Ie})}return Y.insert({filepath:a,oid:s,stats:he}),s})}catch(I){throw I.caller="git.updateIndex",I}}function wf(){try{return ye.version}catch(n){throw n.caller="git.version",n}}async function gf({fs:n,dir:e,gitdir:t=_e(e,".git"),trees:i,map:a,reduce:s,iterate:p,cache:E={}}){try{se("fs",n),se("gitdir",t),se("trees",i);const T=new at(n),C=await it({fsp:T,dotgit:t});return await an({fs:T,cache:E,dir:e,gitdir:C,trees:i,map:a,reduce:s,iterate:p})}catch(T){throw T.caller="git.walk",T}}async function yf({fs:n,dir:e,gitdir:t=_e(e,".git"),blob:i}){try{se("fs",n),se("gitdir",t),se("blob",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await yr({fs:a,gitdir:s,type:"blob",object:i,format:"content"})}catch(a){throw a.caller="git.writeBlob",a}}async function vf({fs:n,dir:e,gitdir:t=_e(e,".git"),commit:i}){try{se("fs",n),se("gitdir",t),se("commit",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await of({fs:a,gitdir:s,commit:i})}catch(a){throw a.caller="git.writeCommit",a}}async function bf({fs:n,dir:e,gitdir:t=_e(e,".git"),type:i,object:a,format:s="parsed",oid:p,encoding:E=void 0}){try{const T=new at(n),C=await it({fsp:T,dotgit:t});if(s==="parsed"){switch(i){case"commit":a=Zt.from(a).toObject();break;case"tree":a=Ge.from(a).toObject();break;case"blob":a=Buffer.from(a,E);break;case"tag":a=mr.from(a).toObject();break;default:throw new ht(p||"",i,"blob|commit|tag|tree")}s="content"}return p=await yr({fs:T,gitdir:C,type:i,object:a,oid:p,format:s}),p}catch(T){throw T.caller="git.writeObject",T}}async function _f({fs:n,dir:e,gitdir:t=_e(e,".git"),ref:i,value:a,force:s=!1,symbolic:p=!1}){try{se("fs",n),se("gitdir",t),se("ref",i),se("value",a);const E=new at(n);if(!Tn(i,!0))throw new xt(i,d.clean(i));const T=await it({fsp:E,dotgit:t});if(!s&&await G.exists({fs:E,gitdir:T,ref:i}))throw new wr("ref",i);p?await G.writeSymbolicRef({fs:E,gitdir:T,ref:i,value:a}):(a=await G.resolve({fs:E,gitdir:T,ref:a}),await G.writeRef({fs:E,gitdir:T,ref:i,value:a}))}catch(E){throw E.caller="git.writeRef",E}}async function ep({fs:n,gitdir:e,tag:t}){const i=mr.from(t).toObject();return await yr({fs:n,gitdir:e,type:"tag",object:i,format:"content"})}async function xf({fs:n,dir:e,gitdir:t=_e(e,".git"),tag:i}){try{se("fs",n),se("gitdir",t),se("tag",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await ep({fs:a,gitdir:s,tag:i})}catch(a){throw a.caller="git.writeTag",a}}async function Ef({fs:n,dir:e,gitdir:t=_e(e,".git"),tree:i}){try{se("fs",n),se("gitdir",t),se("tree",i);const a=new at(n),s=await it({fsp:a,dotgit:t});return await Kn({fs:a,gitdir:s,tree:i})}catch(a){throw a.caller="git.writeTree",a}}var tp={Errors:Qn,STAGE:Et,TREE:gr,WORKDIR:pn,add:zi,abortMerge:ka,addNote:Ei,addRemote:oi,annotatedTag:Ki,branch:ki,cherryPick:nr,checkout:Xi,clone:ze,commit:nt,getConfig:yl,getConfigAll:vl,setConfig:af,currentBranch:Tt,deleteBranch:wt,deleteRef:St,deleteRemote:Br,deleteTag:gn,expandOid:ul,expandRef:ll,fastForward:dl,fetch:pl,findMergeBase:ml,findRoot:gl,getRemoteInfo:bl,getRemoteInfo2:xl,hashBlob:El,indexPack:Al,init:kl,isDescendent:Rl,isIgnored:Il,listBranches:Tl,listFiles:Pl,listNotes:Bl,listRefs:Cl,listRemotes:$l,listServerRefs:Fl,listTags:Dl,log:Ml,merge:ql,packObjects:Ll,pull:zl,push:Hl,readBlob:Wl,readCommit:js,readNote:Zl,readObject:Vl,readTag:Yl,readTree:Xl,remove:Jl,removeNote:Ql,renameBranch:ef,resetIndex:rf,updateIndex:mf,resolveRef:nf,status:ff,statusMatrix:df,tag:pf,version:wf,walk:gf,writeBlob:yf,writeCommit:vf,writeObject:bf,writeRef:_f,writeTag:xf,writeTree:Ef,stash:lf};return Je.Errors=Qn,Je.STAGE=Et,Je.TREE=gr,Je.WORKDIR=pn,Je.abortMerge=ka,Je.add=zi,Je.addNote=Ei,Je.addRemote=oi,Je.annotatedTag=Ki,Je.branch=ki,Je.checkout=Xi,Je.cherryPick=nr,Je.clone=ze,Je.commit=nt,Je.currentBranch=Tt,Je.default=tp,Je.deleteBranch=wt,Je.deleteRef=St,Je.deleteRemote=Br,Je.deleteTag=gn,Je.expandOid=ul,Je.expandRef=ll,Je.fastForward=dl,Je.fetch=pl,Je.findMergeBase=ml,Je.findRoot=gl,Je.getConfig=yl,Je.getConfigAll=vl,Je.getRemoteInfo=bl,Je.getRemoteInfo2=xl,Je.hashBlob=El,Je.indexPack=Al,Je.init=kl,Je.isDescendent=Rl,Je.isIgnored=Il,Je.listBranches=Tl,Je.listFiles=Pl,Je.listNotes=Bl,Je.listRefs=Cl,Je.listRemotes=$l,Je.listServerRefs=Fl,Je.listTags=Dl,Je.log=Ml,Je.merge=ql,Je.packObjects=Ll,Je.pull=zl,Je.push=Hl,Je.readBlob=Wl,Je.readCommit=js,Je.readNote=Zl,Je.readObject=Vl,Je.readTag=Yl,Je.readTree=Xl,Je.remove=Jl,Je.removeNote=Ql,Je.renameBranch=ef,Je.resetIndex=rf,Je.resolveRef=nf,Je.setConfig=af,Je.stash=lf,Je.status=ff,Je.statusMatrix=df,Je.tag=pf,Je.updateIndex=mf,Je.version=wf,Je.walk=gf,Je.writeBlob=yf,Je.writeCommit=vf,Je.writeObject=bf,Je.writeRef=_f,Je.writeTag=xf,Je.writeTree=Ef,Je}var $h=Ch();const Yt=Ca($h);var is,$u;function Fh(){if($u)return is;$u=1,is=f;function f(u){var w,m;if(typeof u!="function")throw new Error("expected a function but got "+u);return function(){return w||(w=!0,m=u.apply(this,arguments)),m}}return is}var as={},Fu;function Dh(){return Fu||(Fu=1,(function(f){function u(K,te){var Q;return K instanceof Buffer?Q=K:Q=Buffer.from(K.buffer,K.byteOffset,K.byteLength),Q.toString(te)}var w=function(K){return Buffer.from(K)};function m(K){for(var te=0,Q=Math.min(65536,K.length+1),ge=new Uint16Array(Q),Te=[],le=0;;){var H=te<K.length;if(!H||le>=Q-1){var fe=ge.subarray(0,le),Ae=fe;if(Te.push(String.fromCharCode.apply(null,Ae)),!H)return Te.join("");K=K.subarray(te),te=0,le=0}var pe=K[te++];if((pe&128)===0)ge[le++]=pe;else if((pe&224)===192){var Be=K[te++]&63;ge[le++]=(pe&31)<<6|Be}else if((pe&240)===224){var Be=K[te++]&63,Ce=K[te++]&63;ge[le++]=(pe&31)<<12|Be<<6|Ce}else if((pe&248)===240){var Be=K[te++]&63,Ce=K[te++]&63,Se=K[te++]&63,Le=(pe&7)<<18|Be<<12|Ce<<6|Se;Le>65535&&(Le-=65536,ge[le++]=Le>>>10&1023|55296,Le=56320|Le&1023),ge[le++]=Le}}}function k(K){for(var te=0,Q=K.length,ge=0,Te=Math.max(32,Q+(Q>>>1)+7),le=new Uint8Array(Te>>>3<<3);te<Q;){var H=K.charCodeAt(te++);if(H>=55296&&H<=56319){if(te<Q){var fe=K.charCodeAt(te);(fe&64512)===56320&&(++te,H=((H&1023)<<10)+(fe&1023)+65536)}if(H>=55296&&H<=56319)continue}if(ge+4>le.length){Te+=8,Te*=1+te/K.length*2,Te=Te>>>3<<3;var Ae=new Uint8Array(Te);Ae.set(le),le=Ae}if((H&4294967168)===0){le[ge++]=H;continue}else if((H&4294965248)===0)le[ge++]=H>>>6&31|192;else if((H&4294901760)===0)le[ge++]=H>>>12&15|224,le[ge++]=H>>>6&63|128;else if((H&4292870144)===0)le[ge++]=H>>>18&7|240,le[ge++]=H>>>12&63|128,le[ge++]=H>>>6&63|128;else continue;le[ge++]=H&63|128}return le.slice?le.slice(0,ge):le.subarray(0,ge)}var _="Failed to ",A=function(K,te,Q){if(K)throw new Error("".concat(_).concat(te,": the '").concat(Q,"' option is unsupported."))},d=typeof Buffer=="function"&&Buffer.from,y=d?w:k;function F(){this.encoding="utf-8"}F.prototype.encode=function(K,te){return A(te&&te.stream,"encode","stream"),y(K)};function D(K){var te;try{var Q=new Blob([K],{type:"text/plain;charset=UTF-8"});te=URL.createObjectURL(Q);var ge=new XMLHttpRequest;return ge.open("GET",te,!1),ge.send(),ge.responseText}finally{te&&URL.revokeObjectURL(te)}}var B=!d&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",z=["utf-8","utf8","unicode-1-1-utf-8"],j=m;d?j=u:B&&(j=function(K){try{return D(K)}catch{return m(K)}});var V="construct 'TextDecoder'",we="".concat(_," ").concat(V,": the ");function ie(K,te){A(te&&te.fatal,V,"fatal"),K=K||"utf-8";var Q;if(d?Q=Buffer.isEncoding(K):Q=z.indexOf(K.toLowerCase())!==-1,!Q)throw new RangeError("".concat(we," encoding label provided ('").concat(K,"') is invalid."));this.encoding=K,this.fatal=!1,this.ignoreBOM=!1}ie.prototype.decode=function(K,te){A(te&&te.stream,"decode","stream");var Q;return K instanceof Uint8Array?Q=K:K.buffer instanceof ArrayBuffer?Q=new Uint8Array(K.buffer):Q=new Uint8Array(K),j(Q,this.encoding)},f.TextEncoder=f.TextEncoder||F,f.TextDecoder=f.TextDecoder||ie})(typeof window<"u"?window:typeof Pi<"u"?Pi:as)),as}var os,Du;function Nh(){return Du||(Du=1,Dh(),os={encode:f=>new TextEncoder().encode(f),decode:f=>new TextDecoder().decode(f)}),os}var ss,Nu;function jh(){if(Nu)return ss;Nu=1,ss=f;function f(u,w,m){var k;return function(){if(!w)return u.apply(this,arguments);var _=this,A=arguments,d=m&&!k;if(clearTimeout(k),k=setTimeout(function(){if(k=null,!d)return u.apply(_,A)},w),d)return u.apply(this,arguments)}}return ss}var cs,ju;function us(){if(ju)return cs;ju=1;function f(d){if(d.length===0)return".";let y=m(d);return y=y.reduce(A,[]),w(...y)}function u(...d){let y="";for(let F of d)F.startsWith("/")?y=F:y=f(w(y,F));return y}function w(...d){if(d.length===0)return"";let y=d.join("/");return y=y.replace(/\/{2,}/g,"/"),y}function m(d){if(d.length===0)return[];if(d==="/")return["/"];let y=d.split("/");return y[y.length-1]===""&&y.pop(),d[0]==="/"?y[0]="/":y[0]!=="."&&y.unshift("."),y}function k(d){const y=d.lastIndexOf("/");if(y===-1)throw new Error(`Cannot get dirname of "${d}"`);return y===0?"/":d.slice(0,y)}function _(d){if(d==="/")throw new Error(`Cannot get basename of "${d}"`);const y=d.lastIndexOf("/");return y===-1?d:d.slice(y+1)}function A(d,y){if(d.length===0)return d.push(y),d;if(y===".")return d;if(y===".."){if(d.length===1){if(d[0]==="/")throw new Error("Unable to normalize path - traverses above root directory");if(d[0]===".")return d.push(y),d}return d[d.length-1]===".."?(d.push(".."),d):(d.pop(),d)}return d.push(y),d}return cs={join:w,normalize:f,split:m,basename:_,dirname:k,resolve:u},cs}var ls,Mu;function qu(){if(Mu)return ls;Mu=1;function f(d){return class extends Error{constructor(...y){super(...y),this.code=d,this.message?this.message=d+": "+this.message:this.message=d}}}const u=f("EEXIST"),w=f("ENOENT"),m=f("ENOTDIR"),k=f("ENOTEMPTY"),_=f("ETIMEDOUT"),A=f("EISDIR");return ls={EEXIST:u,ENOENT:w,ENOTDIR:m,ENOTEMPTY:k,ETIMEDOUT:_,EISDIR:A},ls}var fs,Uu;function Mh(){if(Uu)return fs;Uu=1;const f=us(),{EEXIST:u,ENOENT:w,ENOTDIR:m,ENOTEMPTY:k,EISDIR:_}=qu(),A=0;return fs=class{constructor(){}_makeRoot(y=new Map){return y.set(A,{mode:511,type:"dir",size:0,ino:0,mtimeMs:Date.now()}),y}activate(y=null){y===null?this._root=new Map([["/",this._makeRoot()]]):typeof y=="string"?this._root=new Map([["/",this._makeRoot(this.parse(y))]]):this._root=y}get activated(){return!!this._root}deactivate(){this._root=void 0}size(){return this._countInodes(this._root.get("/"))-1}_countInodes(y){let F=1;for(let[D,B]of y)D!==A&&(F+=this._countInodes(B));return F}autoinc(){return this._maxInode(this._root.get("/"))+1}_maxInode(y){let F=y.get(A).ino;for(let[D,B]of y)D!==A&&(F=Math.max(F,this._maxInode(B)));return F}print(y=this._root.get("/")){let F="";const D=(B,z)=>{for(let[j,V]of B){if(j===0)continue;let we=V.get(A),ie=we.mode.toString(8);F+=`${"	".repeat(z)}${j}	${ie}`,we.type==="file"?F+=`	${we.size}	${we.mtimeMs}
`:(F+=`
`,D(V,z+1))}};return D(y,0),F}parse(y){let F=0;function D(V){const we=++F,ie=V.length===1?"dir":"file";let[K,te,Q]=V;return K=parseInt(K,8),te=te?parseInt(te):0,Q=Q?parseInt(Q):Date.now(),new Map([[A,{mode:K,type:ie,size:te,mtimeMs:Q,ino:we}]])}let B=y.trim().split(`
`),z=this._makeRoot(),j=[{indent:-1,node:z},{indent:0,node:null}];for(let V of B){let ie=V.match(/^\t*/)[0].length;V=V.slice(ie);let[K,...te]=V.split("	"),Q=D(te);if(ie<=j[j.length-1].indent)for(;ie<=j[j.length-1].indent;)j.pop();j.push({indent:ie,node:Q}),j[j.length-2].node.set(K,Q)}return z}_lookup(y,F=!0){let D=this._root,B="/",z=f.split(y);for(let j=0;j<z.length;++j){let V=z[j];if(D=D.get(V),!D)throw new w(y);if(F||j<z.length-1){const we=D.get(A);if(we.type==="symlink"){let ie=f.resolve(B,we.target);D=this._lookup(ie)}B?B=f.join(B,V):B=V}}return D}mkdir(y,{mode:F}){if(y==="/")throw new u;let D=this._lookup(f.dirname(y)),B=f.basename(y);if(D.has(B))throw new u;let z=new Map,j={mode:F,type:"dir",size:0,mtimeMs:Date.now(),ino:this.autoinc()};z.set(A,j),D.set(B,z)}rmdir(y){let F=this._lookup(y);if(F.get(A).type!=="dir")throw new m;if(F.size>1)throw new k;let D=this._lookup(f.dirname(y)),B=f.basename(y);D.delete(B)}readdir(y){let F=this._lookup(y);if(F.get(A).type!=="dir")throw new m;return[...F.keys()].filter(D=>typeof D=="string")}writeStat(y,F,{mode:D}){let B,z;try{z=this.stat(y)}catch{}if(z!==void 0){if(z.type==="dir")throw new _;D==null&&(D=z.mode),B=z.ino}D==null&&(D=438),B==null&&(B=this.autoinc());let j=this._lookup(f.dirname(y)),V=f.basename(y),we={mode:D,type:"file",size:F,mtimeMs:Date.now(),ino:B},ie=new Map;return ie.set(A,we),j.set(V,ie),we}unlink(y){let F=this._lookup(f.dirname(y)),D=f.basename(y);F.delete(D)}rename(y,F){let D=f.basename(F),B=this._lookup(y);this._lookup(f.dirname(F)).set(D,B),this.unlink(y)}stat(y){return this._lookup(y).get(A)}lstat(y){return this._lookup(y,!1).get(A)}readlink(y){return this._lookup(y,!1).get(A).target}symlink(y,F){let D,B;try{let ie=this.stat(F);B===null&&(B=ie.mode),D=ie.ino}catch{}B==null&&(B=40960),D==null&&(D=this.autoinc());let z=this._lookup(f.dirname(F)),j=f.basename(F),V={mode:B,type:"symlink",target:y,size:0,mtimeMs:Date.now(),ino:D},we=new Map;return we.set(A,V),z.set(j,we),V}_du(y){let F=0;for(const[D,B]of y.entries())D===A?F+=B.size:F+=this._du(B);return F}du(y){let F=this._lookup(y);return this._du(F)}},fs}class Lu{constructor(u="keyval-store",w="keyval"){this.storeName=w,this._dbName=u,this._storeName=w,this._init()}_init(){this._dbp||(this._dbp=new Promise((u,w)=>{const m=indexedDB.open(this._dbName);m.onerror=()=>w(m.error),m.onsuccess=()=>u(m.result),m.onupgradeneeded=()=>{m.result.createObjectStore(this._storeName)}}))}_withIDBStore(u,w){return this._init(),this._dbp.then(m=>new Promise((k,_)=>{const A=m.transaction(this.storeName,u);A.oncomplete=()=>k(),A.onabort=A.onerror=()=>_(A.error),w(A.objectStore(this.storeName))}))}_close(){return this._init(),this._dbp.then(u=>{u.close(),this._dbp=void 0})}}let hs;function Xn(){return hs||(hs=new Lu),hs}function qh(f,u=Xn()){let w;return u._withIDBStore("readwrite",m=>{w=m.get(f)}).then(()=>w.result)}function Uh(f,u,w=Xn()){return w._withIDBStore("readwrite",m=>{m.put(u,f)})}function Lh(f,u,w=Xn()){return w._withIDBStore("readwrite",m=>{const k=m.get(f);k.onsuccess=()=>{m.put(u(k.result),f)}})}function zh(f,u=Xn()){return u._withIDBStore("readwrite",w=>{w.delete(f)})}function Hh(f=Xn()){return f._withIDBStore("readwrite",u=>{u.clear()})}function Gh(f=Xn()){const u=[];return f._withIDBStore("readwrite",w=>{(w.openKeyCursor||w.openCursor).call(w).onsuccess=function(){this.result&&(u.push(this.result.key),this.result.continue())}}).then(()=>u)}function Kh(f=Xn()){return f._close()}const zu=kf(Object.freeze(Object.defineProperty({__proto__:null,Store:Lu,clear:Hh,close:Kh,del:zh,get:qh,keys:Gh,set:Uh,update:Lh},Symbol.toStringTag,{value:"Module"})));var ds,Hu;function Wh(){if(Hu)return ds;Hu=1;const f=zu;return ds=class{constructor(w,m){this._database=w,this._storename=m,this._store=new f.Store(this._database,this._storename)}saveSuperblock(w){return f.set("!root",w,this._store)}loadSuperblock(){return f.get("!root",this._store)}readFile(w){return f.get(w,this._store)}writeFile(w,m){return f.set(w,m,this._store)}unlink(w){return f.del(w,this._store)}wipe(){return f.clear(this._store)}close(){return f.close(this._store)}},ds}var ps,Gu;function Zh(){return Gu||(Gu=1,ps=class{constructor(u){this._url=u}loadSuperblock(){return fetch(this._url+"/.superblock.txt").then(u=>u.ok?u.text():null)}async readFile(u){const w=await fetch(this._url+u);if(w.status===200)return w.arrayBuffer();throw new Error("ENOENT")}async sizeFile(u){const w=await fetch(this._url+u,{method:"HEAD"});if(w.status===200)return w.headers.get("content-length");throw new Error("ENOENT")}}),ps}var ms,Ku;function Vh(){if(Ku)return ms;Ku=1;const f=zu,u=w=>new Promise(m=>setTimeout(m,w));return ms=class{constructor(m,k){this._id=Math.random(),this._database=m,this._storename=k,this._store=new f.Store(this._database,this._storename),this._lock=null}async has({margin:m=2e3}={}){if(this._lock&&this._lock.holder===this._id){const k=Date.now();return this._lock.expires>k+m?!0:await this.renew()}else return!1}async renew({ttl:m=5e3}={}){let k;return await f.update("lock",_=>{const d=Date.now()+m;return k=_&&_.holder===this._id,this._lock=k?{holder:this._id,expires:d}:_,this._lock},this._store),k}async acquire({ttl:m=5e3}={}){let k,_,A;if(await f.update("lock",d=>{const y=Date.now(),F=y+m;return _=d&&d.expires<y,k=d===void 0||_,A=d&&d.holder===this._id,this._lock=k?{holder:this._id,expires:F}:d,this._lock},this._store),A)throw new Error("Mutex double-locked");return k}async wait({interval:m=100,limit:k=6e3,ttl:_}={}){for(;k--;){if(await this.acquire({ttl:_}))return!0;await u(m)}throw new Error("Mutex timeout")}async release({force:m=!1}={}){let k,_,A;if(await f.update("lock",d=>(k=m||d&&d.holder===this._id,_=d===void 0,A=d&&d.holder!==this._id,this._lock=k?void 0:d,this._lock),this._store),await f.close(this._store),!k&&!m){if(_)throw new Error("Mutex double-freed");if(A)throw new Error("Mutex lost ownership")}return k}},ms}var ws,Wu;function Yh(){return Wu||(Wu=1,ws=class{constructor(u){this._id=Math.random(),this._database=u,this._has=!1,this._release=null}async has(){return this._has}async acquire(){return new Promise(u=>{navigator.locks.request(this._database+"_lock",{ifAvailable:!0},w=>(this._has=!!w,u(!!w),new Promise(m=>{this._release=m})))})}async wait({timeout:u=6e5}={}){return new Promise((w,m)=>{const k=new AbortController;setTimeout(()=>{k.abort(),m(new Error("Mutex timeout"))},u),navigator.locks.request(this._database+"_lock",{signal:k.signal},_=>(this._has=!!_,w(!!_),new Promise(A=>{this._release=A})))})}async release({force:u=!1}={}){this._has=!1,this._release?this._release():u&&navigator.locks.request(this._database+"_lock",{steal:!0},w=>!0)}}),ws}var gs,Zu;function Xh(){if(Zu)return gs;Zu=1;const{encode:f,decode:u}=Nh(),w=jh(),m=Mh(),{ENOENT:k,ENOTEMPTY:_,ETIMEDOUT:A}=qu(),d=Wh(),y=Zh(),F=Vh(),D=Yh(),B=us();return gs=class{constructor(){this.saveSuperblock=w(()=>{this.flush()},500)}async init(j,{wipe:V,url:we,urlauto:ie,fileDbName:K=j,db:te=null,fileStoreName:Q=j+"_files",lockDbName:ge=j+"_lock",lockStoreName:Te=j+"_lock"}={}){this._name=j,this._idb=te||new d(K,Q),this._mutex=navigator.locks?new D(j):new F(ge,Te),this._cache=new m(j),this._opts={wipe:V,url:we},this._needsWipe=!!V,we&&(this._http=new y(we),this._urlauto=!!ie)}async activate(){if(this._cache.activated)return;this._needsWipe&&(this._needsWipe=!1,await this._idb.wipe(),await this._mutex.release({force:!0})),await this._mutex.has()||await this._mutex.wait();const j=await this._idb.loadSuperblock();if(j)this._cache.activate(j);else if(this._http){const V=await this._http.loadSuperblock();this._cache.activate(V),await this._saveSuperblock()}else this._cache.activate();if(!await this._mutex.has())throw new A}async deactivate(){await this._mutex.has()&&await this._saveSuperblock(),this._cache.deactivate();try{await this._mutex.release()}catch(j){console.log(j)}await this._idb.close()}async _saveSuperblock(){this._cache.activated&&(this._lastSavedAt=Date.now(),await this._idb.saveSuperblock(this._cache._root))}_writeStat(j,V,we){let ie=B.split(B.dirname(j)),K=ie.shift();for(let te of ie){K=B.join(K,te);try{this._cache.mkdir(K,{mode:511})}catch{}}return this._cache.writeStat(j,V,we)}async readFile(j,V){const we=typeof V=="string"?V:V&&V.encoding;if(we&&we!=="utf8")throw new Error('Only "utf8" encoding is supported in readFile');let ie=null,K=null;try{K=this._cache.stat(j),ie=await this._idb.readFile(K.ino)}catch(te){if(!this._urlauto)throw te}if(!ie&&this._http){let te=this._cache.lstat(j);for(;te.type==="symlink";)j=B.resolve(B.dirname(j),te.target),te=this._cache.lstat(j);ie=await this._http.readFile(j)}if(ie&&((!K||K.size!=ie.byteLength)&&(K=await this._writeStat(j,ie.byteLength,{mode:K?K.mode:438}),this.saveSuperblock()),we==="utf8"?ie=u(ie):ie.toString=()=>u(ie)),!K)throw new k(j);return ie}async writeFile(j,V,we){const{mode:ie,encoding:K="utf8"}=we;if(typeof V=="string"){if(K!=="utf8")throw new Error('Only "utf8" encoding is supported in writeFile');V=f(V)}const te=await this._cache.writeStat(j,V.byteLength,{mode:ie});await this._idb.writeFile(te.ino,V)}async unlink(j,V){const we=this._cache.lstat(j);this._cache.unlink(j),we.type!=="symlink"&&await this._idb.unlink(we.ino)}readdir(j,V){return this._cache.readdir(j)}mkdir(j,V){const{mode:we=511}=V;this._cache.mkdir(j,{mode:we})}rmdir(j,V){if(j==="/")throw new _;this._cache.rmdir(j)}rename(j,V){this._cache.rename(j,V)}stat(j,V){return this._cache.stat(j)}lstat(j,V){return this._cache.lstat(j)}readlink(j,V){return this._cache.readlink(j)}symlink(j,V){this._cache.symlink(j,V)}async backFile(j,V){let we=await this._http.sizeFile(j);await this._writeStat(j,we,V)}du(j){return this._cache.du(j)}flush(){return this._saveSuperblock()}},gs}var ys,Vu;function Jh(){return Vu||(Vu=1,ys=class{constructor(u){this.type=u.type,this.mode=u.mode,this.size=u.size,this.ino=u.ino,this.mtimeMs=u.mtimeMs,this.ctimeMs=u.ctimeMs||u.mtimeMs,this.uid=1,this.gid=1,this.dev=1}isFile(){return this.type==="file"}isDirectory(){return this.type==="dir"}isSymbolicLink(){return this.type==="symlink"}}),ys}var vs,Yu;function Qh(){if(Yu)return vs;Yu=1;const f=Xh(),u=Jh(),w=us();function m(A,d,...y){return A=w.normalize(A),(typeof d>"u"||typeof d=="function")&&(d={}),typeof d=="string"&&(d={encoding:d}),[A,d,...y]}function k(A,d,y,...F){return A=w.normalize(A),(typeof y>"u"||typeof y=="function")&&(y={}),typeof y=="string"&&(y={encoding:y}),[A,d,y,...F]}function _(A,d,...y){return[w.normalize(A),w.normalize(d),...y]}return vs=class{constructor(d,y={}){this.init=this.init.bind(this),this.readFile=this._wrap(this.readFile,m,!1),this.writeFile=this._wrap(this.writeFile,k,!0),this.unlink=this._wrap(this.unlink,m,!0),this.readdir=this._wrap(this.readdir,m,!1),this.mkdir=this._wrap(this.mkdir,m,!0),this.rmdir=this._wrap(this.rmdir,m,!0),this.rename=this._wrap(this.rename,_,!0),this.stat=this._wrap(this.stat,m,!1),this.lstat=this._wrap(this.lstat,m,!1),this.readlink=this._wrap(this.readlink,m,!1),this.symlink=this._wrap(this.symlink,_,!0),this.backFile=this._wrap(this.backFile,m,!0),this.du=this._wrap(this.du,m,!1),this._deactivationPromise=null,this._deactivationTimeout=null,this._activationPromise=null,this._operations=new Set,d&&this.init(d,y)}async init(...d){return this._initPromiseResolve&&await this._initPromise,this._initPromise=this._init(...d),this._initPromise}async _init(d,y={}){await this._gracefulShutdown(),this._activationPromise&&await this._deactivate(),this._backend&&this._backend.destroy&&await this._backend.destroy(),this._backend=y.backend||new f,this._backend.init&&await this._backend.init(d,y),this._initPromiseResolve&&(this._initPromiseResolve(),this._initPromiseResolve=null),y.defer||this.stat("/")}async _gracefulShutdown(){this._operations.size>0&&(this._isShuttingDown=!0,await new Promise(d=>this._gracefulShutdownResolve=d),this._isShuttingDown=!1,this._gracefulShutdownResolve=null)}_wrap(d,y,F){return async(...D)=>{D=y(...D);let B={name:d.name,args:D};this._operations.add(B);try{return await this._activate(),await d.apply(this,D)}finally{this._operations.delete(B),F&&this._backend.saveSuperblock(),this._operations.size===0&&(this._deactivationTimeout||clearTimeout(this._deactivationTimeout),this._deactivationTimeout=setTimeout(this._deactivate.bind(this),500))}}}async _activate(){this._initPromise||console.warn(new Error(`Attempted to use LightningFS ${this._name} before it was initialized.`)),await this._initPromise,this._deactivationTimeout&&(clearTimeout(this._deactivationTimeout),this._deactivationTimeout=null),this._deactivationPromise&&await this._deactivationPromise,this._deactivationPromise=null,this._activationPromise||(this._activationPromise=this._backend.activate?this._backend.activate():Promise.resolve()),await this._activationPromise}async _deactivate(){return this._activationPromise&&await this._activationPromise,this._deactivationPromise||(this._deactivationPromise=this._backend.deactivate?this._backend.deactivate():Promise.resolve()),this._activationPromise=null,this._gracefulShutdownResolve&&this._gracefulShutdownResolve(),this._deactivationPromise}async readFile(d,y){return this._backend.readFile(d,y)}async writeFile(d,y,F){return await this._backend.writeFile(d,y,F),null}async unlink(d,y){return await this._backend.unlink(d,y),null}async readdir(d,y){return this._backend.readdir(d,y)}async mkdir(d,y){return await this._backend.mkdir(d,y),null}async rmdir(d,y){return await this._backend.rmdir(d,y),null}async rename(d,y){return await this._backend.rename(d,y),null}async stat(d,y){const F=await this._backend.stat(d,y);return new u(F)}async lstat(d,y){const F=await this._backend.lstat(d,y);return new u(F)}async readlink(d,y){return this._backend.readlink(d,y)}async symlink(d,y){return await this._backend.symlink(d,y),null}async backFile(d,y){return await this._backend.backFile(d,y),null}async du(d){return this._backend.du(d)}async flush(){return this._backend.flush()}},vs}var bs,Xu;function ed(){if(Xu)return bs;Xu=1;const f=Fh(),u=Qh();function w(m,k){return typeof m=="function"&&(k=m),k=f(k),[(...A)=>k(null,...A),k]}return bs=class{constructor(...k){this.promises=new u(...k),this.init=this.init.bind(this),this.readFile=this.readFile.bind(this),this.writeFile=this.writeFile.bind(this),this.unlink=this.unlink.bind(this),this.readdir=this.readdir.bind(this),this.mkdir=this.mkdir.bind(this),this.rmdir=this.rmdir.bind(this),this.rename=this.rename.bind(this),this.stat=this.stat.bind(this),this.lstat=this.lstat.bind(this),this.readlink=this.readlink.bind(this),this.symlink=this.symlink.bind(this),this.backFile=this.backFile.bind(this),this.du=this.du.bind(this),this.flush=this.flush.bind(this)}init(k,_){return this.promises.init(k,_)}readFile(k,_,A){const[d,y]=w(_,A);this.promises.readFile(k,_).then(d).catch(y)}writeFile(k,_,A,d){const[y,F]=w(A,d);this.promises.writeFile(k,_,A).then(y).catch(F)}unlink(k,_,A){const[d,y]=w(_,A);this.promises.unlink(k,_).then(d).catch(y)}readdir(k,_,A){const[d,y]=w(_,A);this.promises.readdir(k,_).then(d).catch(y)}mkdir(k,_,A){const[d,y]=w(_,A);this.promises.mkdir(k,_).then(d).catch(y)}rmdir(k,_,A){const[d,y]=w(_,A);this.promises.rmdir(k,_).then(d).catch(y)}rename(k,_,A){const[d,y]=w(A);this.promises.rename(k,_).then(d).catch(y)}stat(k,_,A){const[d,y]=w(_,A);this.promises.stat(k).then(d).catch(y)}lstat(k,_,A){const[d,y]=w(_,A);this.promises.lstat(k).then(d).catch(y)}readlink(k,_,A){const[d,y]=w(_,A);this.promises.readlink(k).then(d).catch(y)}symlink(k,_,A){const[d,y]=w(A);this.promises.symlink(k,_).then(d).catch(y)}backFile(k,_,A){const[d,y]=w(_,A);this.promises.backFile(k,_).then(d).catch(y)}du(k,_){const[A,d]=w(_);this.promises.du(k).then(A).catch(d)}flush(k){const[_,A]=w(k);this.promises.flush().then(_).catch(A)}},bs}var td=ed();const rd=Ca(td),Di=new Map;function Ir(f){return Di.has(f)||Di.set(f,new rd(`contextgit-${f}`)),Di.get(f)}function nd(f){const u=Di.get(f);u&&(u.init(`contextgit-${f}`,{wipe:!0}),Di.delete(f)),indexedDB.deleteDatabase(`contextgit-${f}`)}function cn(){}cn.prototype={diff:function(u,w){var m,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_=k.callback;typeof k=="function"&&(_=k,k={});var A=this;function d(ge){return ge=A.postProcess(ge,k),_?(setTimeout(function(){_(ge)},0),!0):ge}u=this.castInput(u,k),w=this.castInput(w,k),u=this.removeEmpty(this.tokenize(u,k)),w=this.removeEmpty(this.tokenize(w,k));var y=w.length,F=u.length,D=1,B=y+F;k.maxEditLength!=null&&(B=Math.min(B,k.maxEditLength));var z=(m=k.timeout)!==null&&m!==void 0?m:1/0,j=Date.now()+z,V=[{oldPos:-1,lastComponent:void 0}],we=this.extractCommon(V[0],w,u,0,k);if(V[0].oldPos+1>=F&&we+1>=y)return d(Ju(A,V[0].lastComponent,w,u,A.useLongestToken));var ie=-1/0,K=1/0;function te(){for(var ge=Math.max(ie,-D);ge<=Math.min(K,D);ge+=2){var Te=void 0,le=V[ge-1],H=V[ge+1];le&&(V[ge-1]=void 0);var fe=!1;if(H){var Ae=H.oldPos-ge;fe=H&&0<=Ae&&Ae<y}var pe=le&&le.oldPos+1<F;if(!fe&&!pe){V[ge]=void 0;continue}if(!pe||fe&&le.oldPos<H.oldPos?Te=A.addToPath(H,!0,!1,0,k):Te=A.addToPath(le,!1,!0,1,k),we=A.extractCommon(Te,w,u,ge,k),Te.oldPos+1>=F&&we+1>=y)return d(Ju(A,Te.lastComponent,w,u,A.useLongestToken));V[ge]=Te,Te.oldPos+1>=F&&(K=Math.min(K,ge-1)),we+1>=y&&(ie=Math.max(ie,ge+1))}D++}if(_)(function ge(){setTimeout(function(){if(D>B||Date.now()>j)return _();te()||ge()},0)})();else for(;D<=B&&Date.now()<=j;){var Q=te();if(Q)return Q}},addToPath:function(u,w,m,k,_){var A=u.lastComponent;return A&&!_.oneChangePerToken&&A.added===w&&A.removed===m?{oldPos:u.oldPos+k,lastComponent:{count:A.count+1,added:w,removed:m,previousComponent:A.previousComponent}}:{oldPos:u.oldPos+k,lastComponent:{count:1,added:w,removed:m,previousComponent:A}}},extractCommon:function(u,w,m,k,_){for(var A=w.length,d=m.length,y=u.oldPos,F=y-k,D=0;F+1<A&&y+1<d&&this.equals(m[y+1],w[F+1],_);)F++,y++,D++,_.oneChangePerToken&&(u.lastComponent={count:1,previousComponent:u.lastComponent,added:!1,removed:!1});return D&&!_.oneChangePerToken&&(u.lastComponent={count:D,previousComponent:u.lastComponent,added:!1,removed:!1}),u.oldPos=y,F},equals:function(u,w,m){return m.comparator?m.comparator(u,w):u===w||m.ignoreCase&&u.toLowerCase()===w.toLowerCase()},removeEmpty:function(u){for(var w=[],m=0;m<u.length;m++)u[m]&&w.push(u[m]);return w},castInput:function(u){return u},tokenize:function(u){return Array.from(u)},join:function(u){return u.join("")},postProcess:function(u){return u}};function Ju(f,u,w,m,k){for(var _=[],A;u;)_.push(u),A=u.previousComponent,delete u.previousComponent,u=A;_.reverse();for(var d=0,y=_.length,F=0,D=0;d<y;d++){var B=_[d];if(B.removed)B.value=f.join(m.slice(D,D+B.count)),D+=B.count;else{if(!B.added&&k){var z=w.slice(F,F+B.count);z=z.map(function(j,V){var we=m[D+V];return we.length>j.length?we:j}),B.value=f.join(z)}else B.value=f.join(w.slice(F,F+B.count));F+=B.count,B.added||(D+=B.count)}}return _}function Qu(f,u){var w;for(w=0;w<f.length&&w<u.length;w++)if(f[w]!=u[w])return f.slice(0,w);return f.slice(0,w)}function el(f,u){var w;if(!f||!u||f[f.length-1]!=u[u.length-1])return"";for(w=0;w<f.length&&w<u.length;w++)if(f[f.length-(w+1)]!=u[u.length-(w+1)])return f.slice(-w);return f.slice(-w)}function _s(f,u,w){if(f.slice(0,u.length)!=u)throw Error("string ".concat(JSON.stringify(f)," doesn't start with prefix ").concat(JSON.stringify(u),"; this is a bug"));return w+f.slice(u.length)}function xs(f,u,w){if(!u)return f+w;if(f.slice(-u.length)!=u)throw Error("string ".concat(JSON.stringify(f)," doesn't end with suffix ").concat(JSON.stringify(u),"; this is a bug"));return f.slice(0,-u.length)+w}function Ni(f,u){return _s(f,u,"")}function fa(f,u){return xs(f,u,"")}function tl(f,u){return u.slice(0,id(f,u))}function id(f,u){var w=0;f.length>u.length&&(w=f.length-u.length);var m=u.length;f.length<u.length&&(m=f.length);var k=Array(m),_=0;k[0]=0;for(var A=1;A<m;A++){for(u[A]==u[_]?k[A]=k[_]:k[A]=_;_>0&&u[A]!=u[_];)_=k[_];u[A]==u[_]&&_++}_=0;for(var d=w;d<f.length;d++){for(;_>0&&f[d]!=u[_];)_=k[_];f[d]==u[_]&&_++}return _}var ha="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",ad=new RegExp("[".concat(ha,"]+|\\s+|[^").concat(ha,"]"),"ug"),da=new cn;da.equals=function(f,u,w){return w.ignoreCase&&(f=f.toLowerCase(),u=u.toLowerCase()),f.trim()===u.trim()},da.tokenize=function(f){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w;if(u.intlSegmenter){if(u.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');w=Array.from(u.intlSegmenter.segment(f),function(_){return _.segment})}else w=f.match(ad)||[];var m=[],k=null;return w.forEach(function(_){/\s/.test(_)?k==null?m.push(_):m.push(m.pop()+_):/\s/.test(k)?m[m.length-1]==k?m.push(m.pop()+_):m.push(k+_):m.push(_),k=_}),m},da.join=function(f){return f.map(function(u,w){return w==0?u:u.replace(/^\s+/,"")}).join("")},da.postProcess=function(f,u){if(!f||u.oneChangePerToken)return f;var w=null,m=null,k=null;return f.forEach(function(_){_.added?m=_:_.removed?k=_:((m||k)&&rl(w,k,m,_),w=_,m=null,k=null)}),(m||k)&&rl(w,k,m,null),f};function rl(f,u,w,m){if(u&&w){var k=u.value.match(/^\s*/)[0],_=u.value.match(/\s*$/)[0],A=w.value.match(/^\s*/)[0],d=w.value.match(/\s*$/)[0];if(f){var y=Qu(k,A);f.value=xs(f.value,A,y),u.value=Ni(u.value,y),w.value=Ni(w.value,y)}if(m){var F=el(_,d);m.value=_s(m.value,d,F),u.value=fa(u.value,F),w.value=fa(w.value,F)}}else if(w)f&&(w.value=w.value.replace(/^\s*/,"")),m&&(m.value=m.value.replace(/^\s*/,""));else if(f&&m){var D=m.value.match(/^\s*/)[0],B=u.value.match(/^\s*/)[0],z=u.value.match(/\s*$/)[0],j=Qu(D,B);u.value=Ni(u.value,j);var V=el(Ni(D,j),z);u.value=fa(u.value,V),m.value=_s(m.value,D,V),f.value=xs(f.value,D,D.slice(0,D.length-V.length))}else if(m){var we=m.value.match(/^\s*/)[0],ie=u.value.match(/\s*$/)[0],K=tl(ie,we);u.value=fa(u.value,K)}else if(f){var te=f.value.match(/\s*$/)[0],Q=u.value.match(/^\s*/)[0],ge=tl(te,Q);u.value=Ni(u.value,ge)}}var od=new cn;od.tokenize=function(f){var u=new RegExp("(\\r?\\n)|[".concat(ha,"]+|[^\\S\\n\\r]+|[^").concat(ha,"]"),"ug");return f.match(u)||[]};var pa=new cn;pa.tokenize=function(f,u){u.stripTrailingCr&&(f=f.replace(/\r\n/g,`
`));var w=[],m=f.split(/(\n|\r\n)/);m[m.length-1]||m.pop();for(var k=0;k<m.length;k++){var _=m[k];k%2&&!u.newlineIsToken?w[w.length-1]+=_:w.push(_)}return w},pa.equals=function(f,u,w){return w.ignoreWhitespace?((!w.newlineIsToken||!f.includes(`
`))&&(f=f.trim()),(!w.newlineIsToken||!u.includes(`
`))&&(u=u.trim())):w.ignoreNewlineAtEof&&!w.newlineIsToken&&(f.endsWith(`
`)&&(f=f.slice(0,-1)),u.endsWith(`
`)&&(u=u.slice(0,-1))),cn.prototype.equals.call(this,f,u,w)};function nl(f,u,w){return pa.diff(f,u,w)}var sd=new cn;sd.tokenize=function(f){return f.split(/(\S.+?[.!?])(?=\s+|$)/)};var cd=new cn;cd.tokenize=function(f){return f.split(/([{}:;,]|\s+)/)};function il(f,u){var w=Object.keys(f);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(f);u&&(m=m.filter(function(k){return Object.getOwnPropertyDescriptor(f,k).enumerable})),w.push.apply(w,m)}return w}function ma(f){for(var u=1;u<arguments.length;u++){var w=arguments[u]!=null?arguments[u]:{};u%2?il(Object(w),!0).forEach(function(m){fd(f,m,w[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(w)):il(Object(w)).forEach(function(m){Object.defineProperty(f,m,Object.getOwnPropertyDescriptor(w,m))})}return f}function ud(f,u){if(typeof f!="object"||!f)return f;var w=f[Symbol.toPrimitive];if(w!==void 0){var m=w.call(f,u);if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(f)}function ld(f){var u=ud(f,"string");return typeof u=="symbol"?u:u+""}function Es(f){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},Es(f)}function fd(f,u,w){return u=ld(u),u in f?Object.defineProperty(f,u,{value:w,enumerable:!0,configurable:!0,writable:!0}):f[u]=w,f}function As(f){return hd(f)||dd(f)||pd(f)||md()}function hd(f){if(Array.isArray(f))return ks(f)}function dd(f){if(typeof Symbol<"u"&&f[Symbol.iterator]!=null||f["@@iterator"]!=null)return Array.from(f)}function pd(f,u){if(f){if(typeof f=="string")return ks(f,u);var w=Object.prototype.toString.call(f).slice(8,-1);if(w==="Object"&&f.constructor&&(w=f.constructor.name),w==="Map"||w==="Set")return Array.from(f);if(w==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(w))return ks(f,u)}}function ks(f,u){(u==null||u>f.length)&&(u=f.length);for(var w=0,m=new Array(u);w<u;w++)m[w]=f[w];return m}function md(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ji=new cn;ji.useLongestToken=!0,ji.tokenize=pa.tokenize,ji.castInput=function(f,u){var w=u.undefinedReplacement,m=u.stringifyReplacer,k=m===void 0?function(_,A){return typeof A>"u"?w:A}:m;return typeof f=="string"?f:JSON.stringify(Ss(f,null,null,k),k,"  ")},ji.equals=function(f,u,w){return cn.prototype.equals.call(ji,f.replace(/,([\r\n])/g,"$1"),u.replace(/,([\r\n])/g,"$1"),w)};function Ss(f,u,w,m,k){u=u||[],w=w||[],m&&(f=m(k,f));var _;for(_=0;_<u.length;_+=1)if(u[_]===f)return w[_];var A;if(Object.prototype.toString.call(f)==="[object Array]"){for(u.push(f),A=new Array(f.length),w.push(A),_=0;_<f.length;_+=1)A[_]=Ss(f[_],u,w,m,k);return u.pop(),w.pop(),A}if(f&&f.toJSON&&(f=f.toJSON()),Es(f)==="object"&&f!==null){u.push(f),A={},w.push(A);var d=[],y;for(y in f)Object.prototype.hasOwnProperty.call(f,y)&&d.push(y);for(d.sort(),_=0;_<d.length;_+=1)y=d[_],A[y]=Ss(f[y],u,w,m,y);u.pop(),w.pop()}else A=f;return A}var Rs=new cn;Rs.tokenize=function(f){return f.slice()},Rs.join=Rs.removeEmpty=function(f){return f};function al(f,u,w,m,k,_,A){if(A||(A={}),typeof A=="function"&&(A={callback:A}),typeof A.context>"u"&&(A.context=4),A.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(A.callback){var d=A,y=d.callback;nl(w,m,ma(ma({},A),{},{callback:function(B){var z=F(B);y(z)}}))}else return F(nl(w,m,A));function F(D){if(!D)return;D.push({value:"",lines:[]});function B(fe){return fe.map(function(Ae){return" "+Ae})}for(var z=[],j=0,V=0,we=[],ie=1,K=1,te=function(){var Ae=D[Q],pe=Ae.lines||wd(Ae.value);if(Ae.lines=pe,Ae.added||Ae.removed){var Be;if(!j){var Ce=D[Q-1];j=ie,V=K,Ce&&(we=A.context>0?B(Ce.lines.slice(-A.context)):[],j-=we.length,V-=we.length)}(Be=we).push.apply(Be,As(pe.map(function(Re){return(Ae.added?"+":"-")+Re}))),Ae.added?K+=pe.length:ie+=pe.length}else{if(j)if(pe.length<=A.context*2&&Q<D.length-2){var Se;(Se=we).push.apply(Se,As(B(pe)))}else{var Le,ft=Math.min(pe.length,A.context);(Le=we).push.apply(Le,As(B(pe.slice(0,ft))));var Ne={oldStart:j,oldLines:ie-j+ft,newStart:V,newLines:K-V+ft,lines:we};z.push(Ne),j=0,V=0,we=[]}ie+=pe.length,K+=pe.length}},Q=0;Q<D.length;Q++)te();for(var ge=0,Te=z;ge<Te.length;ge++)for(var le=Te[ge],H=0;H<le.lines.length;H++)le.lines[H].endsWith(`
`)?le.lines[H]=le.lines[H].slice(0,-1):(le.lines.splice(H+1,0,"\\ No newline at end of file"),H++);return{oldFileName:f,newFileName:u,oldHeader:k,newHeader:_,hunks:z}}}function Is(f){if(Array.isArray(f))return f.map(Is).join(`
`);var u=[];f.oldFileName==f.newFileName&&u.push("Index: "+f.oldFileName),u.push("==================================================================="),u.push("--- "+f.oldFileName+(typeof f.oldHeader>"u"?"":"	"+f.oldHeader)),u.push("+++ "+f.newFileName+(typeof f.newHeader>"u"?"":"	"+f.newHeader));for(var w=0;w<f.hunks.length;w++){var m=f.hunks[w];m.oldLines===0&&(m.oldStart-=1),m.newLines===0&&(m.newStart-=1),u.push("@@ -"+m.oldStart+","+m.oldLines+" +"+m.newStart+","+m.newLines+" @@"),u.push.apply(u,m.lines)}return u.join(`
`)+`
`}function ol(f,u,w,m,k,_,A){var d;if((d=A)!==null&&d!==void 0&&d.callback){var F=A,D=F.callback;al(f,u,w,m,k,_,ma(ma({},A),{},{callback:function(z){z?D(Is(z)):D()}}))}else{var y=al(f,u,w,m,k,_,A);return y?Is(y):void 0}}function wd(f){var u=f.endsWith(`
`),w=f.split(`
`).map(function(m){return m+`
`});return u?w.pop():w.push(w.pop().slice(0,-1)),w}const jt="/",wa={name:"ContextGit",email:"user@contextgit"},sl=".contextgit.yaml";class gd{async createRepo(u){const w=crypto.randomUUID().replace(/-/g,"").slice(0,8),m=Ir(w);await Yt.init({fs:m,dir:jt,defaultBranch:"main"});const k=`name: ${u}
created: ${new Date().toISOString()}
`;return await m.promises.writeFile(`${jt}${sl}`,k,"utf8"),await Yt.add({fs:m,dir:jt,filepath:sl}),await Yt.commit({fs:m,dir:jt,message:"Initial commit: create context repo",author:wa}),await er.repos.add({id:w,name:u,created:new Date().toISOString()}),{id:w,name:u,current_branch:"main",branches:["main"]}}async listRepos(){const u=await er.repos.toArray(),w=[];for(const m of u)try{const k=await this.getRepoInfo(m.id);w.push(k)}catch{}return w}async getRepoInfo(u){const w=Ir(u),m=await er.repos.get(u),k=(m==null?void 0:m.name)??u,_=await Yt.listBranches({fs:w,dir:jt}),A=await Yt.currentBranch({fs:w,dir:jt})??"main";return{id:u,name:k,current_branch:A,branches:_}}async deleteRepo(u){nd(u),await er.repos.delete(u)}async listBranches(u){const w=Ir(u);return Yt.listBranches({fs:w,dir:jt})}async createBranch(u,w){const m=Ir(u);return await Yt.branch({fs:m,dir:jt,ref:w}),Yt.listBranches({fs:m,dir:jt})}async checkout(u,w){const m=Ir(u);return await Yt.checkout({fs:m,dir:jt,ref:w}),w}async commit(u,w){const m=Ir(u),k=await m.promises.readdir(jt);for(const d of k)d!==".git"&&await Yt.add({fs:m,dir:jt,filepath:d});const _=await Yt.commit({fs:m,dir:jt,message:w,author:wa}),[A]=await Yt.log({fs:m,dir:jt,depth:1});return{hash:_.slice(0,7),message:A.commit.message,author:A.commit.author.name,date:new Date(A.commit.author.timestamp*1e3).toISOString()}}async getLog(u,w=50){const m=Ir(u);return(await Yt.log({fs:m,dir:jt,depth:w})).map(_=>({hash:_.oid.slice(0,7),message:_.commit.message,author:_.commit.author.name,date:new Date(_.commit.author.timestamp*1e3).toISOString()}))}async getDiff(u,w="HEAD~1",m="HEAD"){const k=Ir(u);try{const _=await this.readFileAtRef(k,w,"context.yaml"),A=await this.readFileAtRef(k,m,"context.yaml");return ol("context.yaml","context.yaml",_,A)}catch{return""}}async readFile(u,w){const m=Ir(u);try{return await m.promises.readFile(`${jt}${w}`,"utf8")}catch{return null}}async writeFile(u,w,m){await Ir(u).promises.writeFile(`${jt}${w}`,m,"utf8")}async ensureDir(u,w){const m=Ir(u),k=w.split("/").filter(Boolean);let _=jt;for(const A of k){_=_==="/"?`/${A}`:`${_}/${A}`;try{await m.promises.stat(_)}catch{await m.promises.mkdir(_)}}}async commitAll(u,w){const m=Ir(u);await this.stageAll(m,jt,"");const k=await Yt.commit({fs:m,dir:jt,message:w,author:wa}),[_]=await Yt.log({fs:m,dir:jt,depth:1});return{hash:k.slice(0,7),message:_.commit.message,author:_.commit.author.name,date:new Date(_.commit.author.timestamp*1e3).toISOString()}}async stageAll(u,w,m){const k=await u.promises.readdir(m?`${w}${m}`:w);for(const _ of k){if(_===".git")continue;const A=m?`${m}/${_}`:_,d=`${w}${A}`;try{(await u.promises.stat(d)).isDirectory()?await this.stageAll(u,w,A):await Yt.add({fs:u,dir:w,filepath:A})}catch{}}}async merge(u,w,m="main"){const k=Ir(u);await Yt.checkout({fs:k,dir:jt,ref:m}),await Yt.merge({fs:k,dir:jt,ours:m,theirs:w,author:wa})}async getBranchDiff(u,w,m){const k=Ir(u);try{const _=await Yt.log({fs:k,dir:jt,ref:m,depth:1});if(_.length===0)return"";const{tree:A}=await Yt.readTree({fs:k,dir:jt,oid:_[0].oid}),d=await Yt.log({fs:k,dir:jt,ref:w,depth:1}),y=[];for(const F of A){if(F.type!=="blob")continue;const D=await this.readBlobContent(k,F.oid);let B="";d.length>0&&(B=await this.readFileAtRef(k,w,F.path)),D!==B&&y.push(ol(`a/${F.path}`,`b/${F.path}`,B,D))}return y.join(`
`)}catch{return""}}async readFileAtBranch(u,w,m){const k=Ir(u);try{return this.readFileAtRef(k,w,m)||null}catch{return null}}async readBlobContent(u,w){const{blob:m}=await Yt.readBlob({fs:u,dir:jt,oid:w});return new TextDecoder().decode(m)}async readFileAtRef(u,w,m){let k;if(w.endsWith("~1")){const y=w.replace("~1",""),F=await Yt.log({fs:u,dir:jt,ref:y,depth:2});if(F.length<2)return"";k=F[1].oid}else{const y=await Yt.log({fs:u,dir:jt,ref:w,depth:1});if(y.length===0)return"";k=y[0].oid}const{tree:_}=await Yt.readTree({fs:u,dir:jt,oid:k}),A=_.find(y=>y.path===m);if(!A)return"";const{blob:d}=await Yt.readBlob({fs:u,dir:jt,oid:A.oid});return new TextDecoder().decode(d)}}const $n=new gd;class yd{async createIssue(u,w,m,k,_,A=[],d=[]){const y={id:Gs(),repoId:u,title:w,description:m,assignedPlatform:k,reviewerPlatform:_,status:"open",dependsOn:A,labels:d,createdAt:new Date().toISOString()};return await er.issues.add(y),y}async getIssue(u){return er.issues.get(u)}async listIssues(u,w){const k=await er.issues.where("repoId").equals(u).toArray();return w?k.filter(_=>_.status===w):k}async updateStatus(u,w){const m={status:w};w==="closed"&&(m.closedAt=new Date().toISOString()),await er.issues.update(u,m)}async startIssue(u,w=!1){const m=await er.issues.get(u);if(!m)throw new Error(`Issue ${u} not found`);if(!m.assignedPlatform)throw new Error(`Issue ${u} has no assigned platform`);const k=`issue/${m.id}-${m.assignedPlatform}`;await $n.createBranch(m.repoId,k),await $n.checkout(m.repoId,k),await er.issues.update(u,{status:"in_progress",branchName:k});let _=!1;const A=Cr.getByPlatform(m.assignedPlatform);if(A)try{await chrome.tabs.sendMessage(A.tabId,{type:"BG_INJECT_PROMPT",prompt:m.description,autoSend:w}),Cr.updateStatus(A.tabId,"busy"),_=!0}catch{_=!1}return{branchName:k,sent:_}}async commitResponse(u,w){const m=await er.issues.get(u);if(!m)throw new Error(`Issue ${u} not found`);m.branchName&&await $n.checkout(m.repoId,m.branchName);const k=`outputs/${w.platform}`;await $n.ensureDir(m.repoId,k),await $n.writeFile(m.repoId,`${k}/${m.id}.md`,w.content),await $n.commitAll(m.repoId,`[${w.platform}] ${m.title}`)}async areDependenciesResolved(u){const w=await er.issues.get(u);if(!w)return!1;if(w.dependsOn.length===0)return!0;for(const m of w.dependsOn){const k=await er.issues.get(m);if(!k||k.status!=="closed")return!1}return!0}}const un=new yd;class vd{async createPR(u){const w=await er.issues.get(u);if(!w)throw new Error(`Issue ${u} not found`);if(!w.branchName)throw new Error(`Issue ${u} has no branch`);const m={id:Gs(),repoId:w.repoId,issueId:u,sourceBranch:w.branchName,targetBranch:"main",title:w.title,status:"open",reviewerPlatform:w.reviewerPlatform,createdAt:new Date().toISOString()};return await er.pullRequests.add(m),await un.updateStatus(u,"review"),m}async getPR(u){return er.pullRequests.get(u)}async listPRs(u,w){const m=await er.pullRequests.where("repoId").equals(u).toArray();return w?m.filter(k=>k.status===w):m}async getDiff(u){const w=await er.pullRequests.get(u);if(!w)throw new Error(`PR ${u} not found`);return $n.getBranchDiff(w.repoId,w.targetBranch,w.sourceBranch)}async requestReview(u,w){const m=await er.pullRequests.get(u);if(!m)throw new Error(`PR ${u} not found`);const k=await this.getDiff(u),_=await er.issues.get(m.issueId),A=["Please review the following work output.","",`## Task: ${m.title}`,_?`## Original Request: ${_.description}`:"","","## Output:","```",k,"```","","Please evaluate:","1. Does the output address the original request?","2. Is the information accurate?","3. What improvements would you suggest?","","Respond with APPROVE or REJECT followed by your reasoning."].filter(Boolean).join(`
`),d=Cr.getByPlatform(w);if(!d)return!1;try{return await chrome.tabs.sendMessage(d.tabId,{type:"BG_INJECT_PROMPT",prompt:A,autoSend:!1}),await er.pullRequests.update(u,{status:"reviewing",reviewerPlatform:w}),!0}catch{return!1}}async submitReview(u,w,m){const k=w==="approve"?"approved":"rejected";await er.pullRequests.update(u,{status:k,reviewComment:m})}async mergePR(u){const w=await er.pullRequests.get(u);if(!w)throw new Error(`PR ${u} not found`);await $n.merge(w.repoId,w.sourceBranch,w.targetBranch),await er.pullRequests.update(u,{status:"merged",mergedAt:new Date().toISOString()}),await un.updateStatus(w.issueId,"closed")}}const _n=new vd;class bd{constructor(){Oi(this,"state",null)}getState(){return this.state}async start(u,w,m){const k=[];for(const _ of w){const A=await un.createIssue(u,_.title,_.description,_.assignedPlatform,_.reviewerPlatform,_.dependsOn,_.labels);k.push(A.id)}return this.state={status:"running",repoId:u,sendMode:m,issueIds:k,completedIds:new Set},await this.startReadyIssues(),k}async handleResponse(u,w){if(!this.state||this.state.status!=="running")return;const m=Cr.getPlatformForTab(u);if(!m)return;const k=await this.findActiveIssueForPlatform(m);if(!k)return;await un.commitResponse(k.id,w),Cr.updateStatus(u,"connected");const _=await _n.createPR(k.id);k.reviewerPlatform?await _n.requestReview(_.id,k.reviewerPlatform):(await _n.submitReview(_.id,"approve","Auto-approved (no reviewer)"),await _n.mergePR(_.id),this.state.completedIds.add(k.id),this.state.completedIds.size===this.state.issueIds.length?this.state.status="completed":await this.startReadyIssues())}async handleReviewComplete(u,w,m){if(this.state&&(await _n.submitReview(u,w,m),w==="approve")){const k=await _n.getPR(u);if(!k)return;await _n.mergePR(u),this.state.completedIds.add(k.issueId),this.state.completedIds.size===this.state.issueIds.length?this.state.status="completed":await this.startReadyIssues()}}async startReadyIssues(){if(this.state)for(const u of this.state.issueIds){if(this.state.completedIds.has(u))continue;const w=await un.getIssue(u);if(!w||w.status!=="open"||!await un.areDependenciesResolved(u))continue;const k=this.state.sendMode==="power";try{await un.startIssue(u,k)}catch(_){console.error(`[ContextGit] Failed to start issue ${u}:`,_)}}}async findActiveIssueForPlatform(u){return this.state?(await un.listIssues(this.state.repoId,"in_progress")).find(m=>m.assignedPlatform===u):void 0}}const ga=new bd,_d=Zn(()=>{chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}),chrome.tabs.onRemoved.addListener(f=>{Cr.unregister(f)}),chrome.runtime.onMessage.addListener((f,u,w)=>{var k,_,A;const m=(k=u.tab)==null?void 0:k.id;switch(f.type){case"OPEN_SIDEPANEL":{m&&chrome.sidePanel.open({tabId:m}),w({success:!0});break}case"CS_READY":{m&&Cr.register(m,f.platform,((_=u.tab)==null?void 0:_.url)||""),w({success:!0});break}case"CS_RESPONSE_COMPLETE":{m&&(Cr.updateStatus(m,"connected"),ga.handleResponse(m,f.response).catch(d=>console.error("[ContextGit] handleResponse error:",d))),w({success:!0});break}case"API_CREATE_ISSUE":{const d=f.issue;return un.createIssue(d.repoId,d.title,d.description,d.assignedPlatform,d.reviewerPlatform,d.dependsOn,d.labels).then(y=>w({success:!0,issue:y})).catch(y=>w({success:!1,error:String(y)})),!0}case"API_START_ISSUE":return un.startIssue(f.issueId).then(d=>w({success:!0,...d})).catch(d=>w({success:!1,error:String(d)})),!0;case"API_CREATE_PR":return _n.createPR(f.issueId).then(d=>w({success:!0,pr:d})).catch(d=>w({success:!1,error:String(d)})),!0;case"API_REVIEW_PR":return ga.handleReviewComplete(f.prId,f.action,f.comment).then(()=>w({success:!0})).catch(d=>w({success:!1,error:String(d)})),!0;case"API_MERGE_PR":return _n.mergePR(f.prId).then(()=>w({success:!0})).catch(d=>w({success:!1,error:String(d)})),!0;case"API_GET_STATE":{const d=ga.getState(),y=Cr.listConnected();w({success:!0,workflow:d?{...d,completedIds:Array.from(d.completedIds)}:null,connectedTabs:y});break}case"API_START_WORKFLOW":return ga.start(((A=f.issues[0])==null?void 0:A.repoId)||"",f.issues,f.sendMode).then(d=>w({success:!0,issueIds:d})).catch(d=>w({success:!1,error:String(d)})),!0}return!0})});function gp(){}var ya={exports:{}},xd=ya.exports,cl;function Ed(){return cl||(cl=1,(function(f,u){(function(w,m){m(f)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:xd,function(w){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)w.exports=globalThis.browser;else{const m="The message port closed before a response was received.",k=_=>{const A={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(A).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class d extends WeakMap{constructor(H,fe=void 0){super(fe),this.createItem=H}get(H){return this.has(H)||this.set(H,this.createItem(H)),super.get(H)}}const y=le=>le&&typeof le=="object"&&typeof le.then=="function",F=(le,H)=>(...fe)=>{_.runtime.lastError?le.reject(new Error(_.runtime.lastError.message)):H.singleCallbackArg||fe.length<=1&&H.singleCallbackArg!==!1?le.resolve(fe[0]):le.resolve(fe)},D=le=>le==1?"argument":"arguments",B=(le,H)=>function(Ae,...pe){if(pe.length<H.minArgs)throw new Error(`Expected at least ${H.minArgs} ${D(H.minArgs)} for ${le}(), got ${pe.length}`);if(pe.length>H.maxArgs)throw new Error(`Expected at most ${H.maxArgs} ${D(H.maxArgs)} for ${le}(), got ${pe.length}`);return new Promise((Be,Ce)=>{if(H.fallbackToNoCallback)try{Ae[le](...pe,F({resolve:Be,reject:Ce},H))}catch(Se){console.warn(`${le} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,Se),Ae[le](...pe),H.fallbackToNoCallback=!1,H.noCallback=!0,Be()}else H.noCallback?(Ae[le](...pe),Be()):Ae[le](...pe,F({resolve:Be,reject:Ce},H))})},z=(le,H,fe)=>new Proxy(H,{apply(Ae,pe,Be){return fe.call(pe,le,...Be)}});let j=Function.call.bind(Object.prototype.hasOwnProperty);const V=(le,H={},fe={})=>{let Ae=Object.create(null),pe={has(Ce,Se){return Se in le||Se in Ae},get(Ce,Se,Le){if(Se in Ae)return Ae[Se];if(!(Se in le))return;let ft=le[Se];if(typeof ft=="function")if(typeof H[Se]=="function")ft=z(le,le[Se],H[Se]);else if(j(fe,Se)){let Ne=B(Se,fe[Se]);ft=z(le,le[Se],Ne)}else ft=ft.bind(le);else if(typeof ft=="object"&&ft!==null&&(j(H,Se)||j(fe,Se)))ft=V(ft,H[Se],fe[Se]);else if(j(fe,"*"))ft=V(ft,H[Se],fe["*"]);else return Object.defineProperty(Ae,Se,{configurable:!0,enumerable:!0,get(){return le[Se]},set(Ne){le[Se]=Ne}}),ft;return Ae[Se]=ft,ft},set(Ce,Se,Le,ft){return Se in Ae?Ae[Se]=Le:le[Se]=Le,!0},defineProperty(Ce,Se,Le){return Reflect.defineProperty(Ae,Se,Le)},deleteProperty(Ce,Se){return Reflect.deleteProperty(Ae,Se)}},Be=Object.create(le);return new Proxy(Be,pe)},we=le=>({addListener(H,fe,...Ae){H.addListener(le.get(fe),...Ae)},hasListener(H,fe){return H.hasListener(le.get(fe))},removeListener(H,fe){H.removeListener(le.get(fe))}}),ie=new d(le=>typeof le!="function"?le:function(fe){const Ae=V(fe,{},{getContent:{minArgs:0,maxArgs:0}});le(Ae)}),K=new d(le=>typeof le!="function"?le:function(fe,Ae,pe){let Be=!1,Ce,Se=new Promise(Re=>{Ce=function(Fe){Be=!0,Re(Fe)}}),Le;try{Le=le(fe,Ae,Ce)}catch(Re){Le=Promise.reject(Re)}const ft=Le!==!0&&y(Le);if(Le!==!0&&!ft&&!Be)return!1;const Ne=Re=>{Re.then(Fe=>{pe(Fe)},Fe=>{let Ue;Fe&&(Fe instanceof Error||typeof Fe.message=="string")?Ue=Fe.message:Ue="An unexpected error occurred",pe({__mozWebExtensionPolyfillReject__:!0,message:Ue})}).catch(Fe=>{console.error("Failed to send onMessage rejected reply",Fe)})};return Ne(ft?Le:Se),!0}),te=({reject:le,resolve:H},fe)=>{_.runtime.lastError?_.runtime.lastError.message===m?H():le(new Error(_.runtime.lastError.message)):fe&&fe.__mozWebExtensionPolyfillReject__?le(new Error(fe.message)):H(fe)},Q=(le,H,fe,...Ae)=>{if(Ae.length<H.minArgs)throw new Error(`Expected at least ${H.minArgs} ${D(H.minArgs)} for ${le}(), got ${Ae.length}`);if(Ae.length>H.maxArgs)throw new Error(`Expected at most ${H.maxArgs} ${D(H.maxArgs)} for ${le}(), got ${Ae.length}`);return new Promise((pe,Be)=>{const Ce=te.bind(null,{resolve:pe,reject:Be});Ae.push(Ce),fe.sendMessage(...Ae)})},ge={devtools:{network:{onRequestFinished:we(ie)}},runtime:{onMessage:we(K),onMessageExternal:we(K),sendMessage:Q.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:Q.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},Te={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return A.privacy={network:{"*":Te},services:{"*":Te},websites:{"*":Te}},V(_,ge,A)};w.exports=k(chrome)}})})(ya)),ya.exports}Ed();function va(f,...u){}const Ad={debug:(...f)=>va(console.debug,...f),log:(...f)=>va(console.log,...f),warn:(...f)=>va(console.warn,...f),error:(...f)=>va(console.error,...f)};let Ts;try{Ts=_d.main(),Ts instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(f){throw Ad.error("The background crashed on startup!"),f}return Ts})();
background;
